import{r as u,p as y,j as r,L as z}from"./mainweb-DJFZVjrd.js";import{u as A}from"./index.esm-Bk3Kib0V.js";import{RenderComponents as G}from"./renderComponents-BBZFKyE8.js";import H from"./modalForm-CNs_LiK3.js";import{F as I}from"./XCircleIcon-CT5FIbjo.js";import{F as T}from"./CheckCircleIcon-BWTTeQci.js";import"./dialog-mayodhtH.js";import"./keyboard-CyOZPEat.js";import"./XMarkIcon-B9GgAvzT.js";const ee=({row:s,fields:j,viewMode:d,noModal:S,onSave:v,onCancel:p,title:C,description:O})=>{const[n,g]=u.useState(s||{});for(let e in n)if(e.indexOf("JsonSettings")>-1&&e.indexOf(".")==-1)try{let t=y(n[e]);if(t)for(let o in t)n[e+"Object."+o]=t[o]}catch(t){console.error("Error parsing JSON:",t)}let[m,h]=u.useState(!1);const[F,N]=u.useState("");let x=j;const{handleSubmit:P,register:E,unregister:J,control:L,clearErrors:V,reset:R,watch:w,getValues:D,setValue:a,trigger:$,formState:{errors:K}}=A({defaultValues:{...s}});u.useEffect(()=>{s&&(Object.keys(s).forEach(e=>{J(e),a(e,s[e])}),g({...s}))},[s]);const M=async e=>{h(!0),window.scrollTo({top:0,behavior:"smooth"});let t=o=>{N(o)};try{await v(e,!1,!0,t)}catch(o){console.error("Error saving user:",o)}h(!1)},b=(e,t)=>{if(console.log("handlePropertiesChange",e,t),a(e,t),s&&(s[e]=t),e.indexOf("JsonSettingsObject")>-1){let c=e.split("Object.")[1],l=e.split("Object.")[0];var o=s[l],i=y(o);let k={[c]:t};i={...i,...k},s[l]=JSON.stringify(i),a(l,JSON.stringify(i))}g({...s})};let f=[...x];return n&&x?.length>0&&(f=f.filter(e=>{let t=e.conditions?.filter(o=>o.key);return t?.length>0?!!t.find(i=>{if(i.key){let c=i.key.charAt(0).toLowerCase()+i.key.slice(1),l=n[i.key]||n[c];if(l&&l?.toString()==i.value)return!0}}):!0})),console.log({filteredComponents:f}),r.jsx(H,{isPlainView:S,title:C,description:O,open:!0,center:!1,outerClass:"max-w-xl",setOpen:p,children:r.jsxs("div",{className:"flex-auto relative",children:[m&&r.jsx(z,{info:F}),r.jsxs("form",{onSubmit:P(M),children:[r.jsx(G,{handlePropertiesChange:b,handlePropertiesPanelChange:()=>{console.log("handlePropertiesPanelChange")},viewMode:d,formData:n,isPlayGround:!1,onChangeValue:b,drop:null,isSubmitted:m,isOver:!1,eventDetails:{},components:f,selectedComponent:{},handleSelect:()=>{console.log("handleSelect")},register:E,getValues:D,errors:K,control:L,setValue:a,clearErrors:V,reset:R,watch:w,removeComponent:()=>{console.log("removeComponent")}}),!m&&!d&&r.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:p,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(I,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(T,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})};export{ee as default};
