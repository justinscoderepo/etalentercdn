import{r as s,j as e,q as te,h as F,L as V,R as B,_,d as D,k as T}from"./main-CNwsE70q.js";import{B as ae}from"./box-CfSvlUat.js";import{u as le}from"./useConfirmation-LswXyWAU.js";import{F as se}from"./ShareIcon-DdJNBuTl.js";import{F as re}from"./PencilIcon-CIdZDNDg.js";import{F as oe}from"./TrashIcon-35Nqj25C.js";import{F as ne}from"./PlusIcon-CDgLbrzv.js";import{F as ie}from"./TrashIcon-3Aiu4OUV.js";import"./dialog-CgbJ1UKe.js";import"./keyboard-9WK94Kur.js";import"./description-pQlnE8nZ.js";import"./open-closed-cCj8iGKy.js";import"./index-C2b8_KXo.js";import"./CheckIcon-ClcWA9OA.js";function de({title:r,titleId:a,...m},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":a},m),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const me=s.forwardRef(de);function ce({title:r,titleId:a,...m},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":a},m),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"}))}const ue=s.forwardRef(ce);function pe({title:r,titleId:a,...m},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":a},m),r?s.createElement("title",{id:a},r):null,s.createElement("path",{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75Zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const xe=s.forwardRef(pe);function he({title:r,titleId:a,...m},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":a},m),r?s.createElement("title",{id:a},r):null,s.createElement("path",{fillRule:"evenodd",d:"M3.74 3.749a.75.75 0 0 1 .75.75V15h13.938l-2.47-2.47a.75.75 0 0 1 1.061-1.06l3.75 3.75a.75.75 0 0 1 0 1.06l-3.75 3.75a.75.75 0 0 1-1.06-1.06l2.47-2.47H3.738a.75.75 0 0 1-.75-.75V4.5a.75.75 0 0 1 .75-.751Z",clipRule:"evenodd"}))}const fe=s.forwardRef(he);function we({title:r,titleId:a,...m},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":a},m),r?s.createElement("title",{id:a},r):null,s.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06l-3.22-3.22V16.5a.75.75 0 0 1-1.5 0V4.81L8.03 8.03a.75.75 0 0 1-1.06-1.06l4.5-4.5ZM3 15.75a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const ge=s.forwardRef(we),be=B.lazy(()=>_(()=>import("./formEditor-BMtRR2ml.js"),[])),ye=B.lazy(()=>_(()=>import("./pagination-k5Jto1DL.js"),[])),J=({status:r,formTitle:a,defaultFormValues:m,formDescription:d,rows:x=[],formFields:j=[],pageDetails:f={},fields:y=[],topActions:S=[],actions:A=[],deleteProps:w,setOffsetAndLimit:I=()=>{},searchFields:N=[],update:C=()=>{alert("Not Implemented")},delete:E=()=>{alert("Not Implemented")},onImportEach:g=k=>{alert("Not Implemented")}})=>{const[k,o]=le(),[i,u]=s.useState(()=>{const t={};return N?.forEach(p=>{t[p.columnName]=""}),t}),[v,n]=s.useState(!1),[h,c]=s.useState(!1),[U,M]=s.useState(null),[O,L]=s.useState(!1),[Re,q]=s.useState([]),[z,je]=s.useState([]),P=(t,p)=>{u(l=>({...l,[t]:p}))},H=()=>{},Z=async t=>{w.fromKey&&w.postKey&&(t[w.postKey]=t[w.fromKey]),n(!0),await E(t),n(!1)},K=t=>{M(t),c(!0),n(!0)},G=async t=>{await C(t),n(!1),c(!1),M(null)},Y=()=>{n(!1),c(!1),M(null)},W=()=>{L(!0)},Q=async t=>{if(t.length===0){alert("No rows to import");return}for(const p of t)await g(p);L(!1),q([])},X=()=>e.jsx("div",{className:"min-h-5 w-full relative",children:e.jsx("div",{className:"relative right-0 md:-top-10",children:S.length>0&&e.jsx("div",{className:"flex justify-end items-end gap-x-2 gap-y-2",children:S.map((t,p)=>e.jsx("div",{className:"bg-white rounded-full shadow-sm p-2",children:e.jsxs("button",{className:F("font-medium text-sm py-2 px-2 rounded-3xl flex items-center justify-center shadow-sm",t.label?"px-3":"h-8 w-8",t.type==="new"?"bg-indigo-600 text-white":t.type==="export"?"bg-green-700 text-white":t.type==="import"?"bg-blue-700 text-white":t.type==="custom"?"bg-gray-700 text-white":""),onClick:()=>{t.type==="new"?c(!0):t.type==="export"||(t.type==="import"?W():t.type==="custom"&&t.callback&&t.callback())},children:[t.type==="new"&&e.jsx(ne,{className:"h-5 w-5 text-white"}),t.type==="export"&&e.jsx(ge,{className:"h-5 w-5 text-white"}),t.type==="import"&&e.jsx(xe,{className:"h-5 w-5 text-white"}),t.type==="custom"&&e.jsxs(e.Fragment,{children:[t.icon,e.jsx("span",{className:"ml-2",children:t.label})]})]})},p))})})});return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Delete Item",description:"Are you sure you want to delete this item?",confirmButtonLabel:"Delete",confirmButtonClick:async t=>Z(t),className:"w-96 print:hidden"}),e.jsxs("div",{className:"",children:[N?.length>0&&e.jsxs("div",{className:"mb-0 flex flex-row justify-end gap-x-2 gap-y-2",children:[N?.map((t,p)=>e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"absolute -top-2 left-2 inline-block rounded-lg bg-white px-1 text-xs font-medium text-gray-900",children:["Search By ",t.label]}),t.type==="text"&&e.jsx("input",{type:"text",placeholder:"Enter "+(t.placeholder||t.label),value:i[t.columnName],onChange:l=>P(t.columnName,l.target.value),className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900   placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 border-gray-300 focus:outline-gray-50 sm:text-sm/6"}),t.type==="select"&&e.jsx("select",{value:i[t.columnName],onChange:l=>P(t.columnName,l.target.value),className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900  placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-darkprimary sm:text-sm/6",children:t.options.map((l,b)=>e.jsx("option",{value:l.value,children:l.label},b))})]},p)),e.jsx("button",{type:"button",onClick:H,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-darkprimary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-darkprimary",children:"Search"})]}),e.jsx("div",{className:"relative mt-12",children:e.jsxs("table",{className:"min-w-full md:divide-y md:divide-gray-300 flex flex-col md:table ",children:[y?.length>0&&e.jsx("thead",{className:"flex flex-grow md:table-header-group ",children:e.jsxs("tr",{className:"md:bg-gray-200 flex md:table-row flex-grow justify-end",children:[y.map((t,p)=>e.jsx("th",{className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-3 hidden md:table-cell",children:t.label},p)),e.jsx("th",{children:e.jsx(X,{})})]})}),x?.length>0&&e.jsx("tbody",{className:"md:divide-y md:divide-gray-200 flex flex-grow md:table-row-group flex-col gap-y-3",children:x.map((t,p)=>{for(let l in t)if(l.indexOf("JsonSettings")>-1&&l.indexOf(".")==-1)try{let b=te(t[l]);if(b)for(let $ in b)t[l+"Object."+$]=b[$]}catch(b){console.error("Error parsing JSON:",b)}return e.jsxs("tr",{className:"flex md:table-row flex-col py-4 md:py-0 px-4 md:px-0 shadow-md md:shadow-none",children:[y?.map((l,b)=>e.jsxs("td",{className:"whitespace-nowrap md:px-3 py-2 md:py-4 text-sm text-gray-500 flex flex-row justify-between md:table-cell",children:[e.jsx("span",{className:"md:hidden font-semibold text-gray-900",children:l.label}),l.asOptionList?e.jsx("ul",{className:"list-disc mr-2 ml-3",children:Array.isArray(t[l.column])&&t[l.column].length>0?t[l.column].map(($,ee)=>e.jsx("li",{className:"text-gray-700 font-normal text-xs",children:$.label},ee)):e.jsx("span",{className:"text-gray-900 font-semibold",children:"-"})}):e.jsx("span",{className:"",children:t[l.column]})]},b)),A.length>0&&e.jsx("td",{className:"whitespace-nowrap text-sm font-medium mt-3 md:mt-0",children:e.jsx("div",{className:"flex justify-end gap-x-2 gap-y-2",children:A.map((l,b)=>e.jsxs("button",{title:l.label,className:F("h-8 w-8 font-semibold py-2 px-2 rounded-3xl flex items-center justify-center",l.type==="whatsapp"?"bg-green-700 text-white":l.type==="edit"?"bg-primary text-white":l.type==="delete"?"bg-red-800 text-white":""),onClick:()=>{l.type==="whatsapp"?l.callback&&l.callback(t):l.type==="edit"?K(t):l.type==="delete"&&o(t)},children:[l.type==="whatsapp"&&e.jsx(se,{className:"h-5 w-5 text-white"}),l.type==="edit"&&e.jsx(re,{className:"h-4 w-4 text-white"}),l.type==="delete"&&e.jsx(oe,{className:"h-5 w-5 text-white"})]},b))})})]},p)})}),x?.length===0&&r!="finished"&&e.jsx("tbody",{className:"bg-white flex justify-center",children:e.jsx("tr",{className:"flex justify-center",children:e.jsx(V,{})})})]})}),f&&e.jsx(ye,{rowsFrom:f?.rowsFrom,rowsTo:f?.rowsTo,totalRowCount:f?.totalRowCount,setOffsetAndLimit:I}),h&&e.jsx(be,{description:d,title:a,row:U||m,fields:j,onSave:G,onCancel:Y}),O&&e.jsx(ve,{show:O,onCancel:()=>L(!1),onSubmit:Q,rows:z,fields:y,formFields:j})]})]})},ve=({show:r,onCancel:a,onSubmit:m,rows:d,fields:x,formFields:j})=>{const[f,y]=s.useState([]),S=s.useRef(null),A=()=>{y([]);const w=S.current;if(!w)return;const I=w.querySelector("table");if(!I)return;const N=I.querySelectorAll("tbody tr"),C=[];N.forEach((E,g)=>{const k=E.querySelectorAll("td"),o={};let i=!0;k.forEach((u,v)=>{let n=j[v];if(n&&n.name){const h=j[v]?.name;if(!h){console.error(`Row ${g+1}, Column ${v+1} has no key defined.`),i=!1;return}if(n.validate&&n.validate.required&&!u.innerText.trim()){console.error(`Row ${g+1}, Column ${v+1} is required with field ${h}.`),i=!1;return}if(n.validate&&n.validate.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.innerText.trim())){console.error(`Row ${g+1}, Column ${v+1} is not a valid email with field ${h}.`),i=!1;return}if(n.type==="select"&&n.options){const c=n.options.find(U=>U.text.trim().toLowerCase()===u.innerText.trim().toLowerCase()||U.text.replace(" "+n.name,"").trim().toLowerCase()===u.innerText.trim().toLowerCase());if(!c){console.error(`Row ${g+1}, Column ${v+1} has an invalid option value: ${u.innerText.trim()} with field ${h}.`),i=!1;return}i&&(o[h]=c?c.value:u.innerText.trim(),o[h+"Name"]=c?c.text:u.innerText.trim(),o[h+"Text"]=c?c.text:u.innerText.trim())}else n.type==="text"&&i&&(o[h]=u.innerText.trim())}}),i&&C.push(o)}),y(C)};return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-3xl w-full",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirm Import"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Paste Excel Table Here:"}),e.jsx("div",{ref:S,className:"pasteexcel border rounded p-2 bg-gray-50 mb-2",contentEditable:!0,style:{outline:"none",maxHeight:"50vh",overflowY:"auto",minHeight:"80px"},suppressContentEditableWarning:!0}),e.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white rounded",onClick:A,type:"button",children:"Import Excel to List"})]}),f.length>0&&e.jsx("div",{className:"max-h-96 overflow-auto mb-4",children:e.jsx(J,{formTitle:"Import Preview",formDescription:"You can review the imported data before submitting.",rows:f.length>0?f:[],fields:x,formFields:j,actions:[]})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:a,children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>m(f.length>0?f:[]),children:"Submit Import"})]})]})}):null};let R={SuperAdmin:{RoleId:1,Role:"SuperAdmin"},Candidate:{RoleId:2,Role:"Candidate"},Organizer:{RoleId:3,Role:"Organizer"},Manager:{RoleId:4,Role:"Manager"},Coordinator:{RoleId:5,Role:"Coordinator",allowSections:!0},Judge:{RoleId:6,Role:"Judge"},Guest:{RoleId:7,Role:"Guest"},SubCoordinator:{RoleId:8,Role:"SubCoordinator",allowOrganizationLevels:!0,allowAccessMode:!0},Projector:{RoleId:9,Role:"Projector"},SubAdmin:{RoleId:10,Role:"SubAdmin"},ContentAdmin:{RoleId:11,Role:"ContentAdmin"},User:{RoleId:12,Role:"User"},DrawMaster:{RoleId:13,Role:"DrawMaster"},ScoreMaster:{RoleId:14,Role:"ScoreMaster"},Guardian:{RoleId:15,Role:"Guardian"}};function Fe({user:r,operation:a,eventCategory:m,eventId:d,eventLevel:x}){const[j,f]=s.useState(!1),y=D("/UsersRolesPlusUsersJson/Get",{filter:{Event:d,Role:R[a].RoleId,CreatedBy:r.UId,Status:"1"},updateUrl:"/SetupJson/SaveUser",deleteUrl:"/SetupJson/RemoveCoordinator",limit:10,sort:{sortOrder:"DESC",sortColumn:"UserRoleId"},select:"Event,Role,SixDigitPassword,Status,User,UserEmail,UserEmailCode,UserName,UserNameCode,UserRoleId,JsonSettings"});let{rows:S,update:A}=y,w=[];if(a==="SubCoordinator"&&x){const{rows:o}=D("/OrganizationJson/Get",{select:"Id,Name,Status",filter:{CompetitionLevelLevelName:x},mandatoryParams:["CompetitionLevelLevelName"]});w=o}const I=({UserName:o,UserEmail:i,SixDigitPassword:u})=>{let v=window.location.origin,n=btoa(o),h=btoa(i),c=btoa(d),U=encodeURIComponent(i);const M=`https://api.whatsapp.com/send?text=Hi%20${o},%0AYour%20login%20details%20are:%0A%0AUserName%3A%20${U}%0A🔑Password%3A%20${u}%0APlease%20follow%20the%20following%20link%20to%20login:%0A${v}%2FAccount%2FLogin%3FeventId%3D${c}%26name%3D${n}%26Email%3D${h}`;window.open(M,"_blank"),T.success("Login details shared via WhatsApp!")};var N=[{type:"new",title:"Add New User"},{type:"import",title:"Import Users"}];let C={Event:d,Role:R[a].RoleId,RoleRole:R[a].Role,Status:"1",CreatedBy:r.UId};S?.filter(o=>o.UserEmail===r.Email)?.length||N.push({type:"custom",callback:()=>A({...C,UserName:r.Name,UserEmail:r.Email}),icon:e.jsx(fe,{className:"-mr-0.5 h-5 w-5"}),label:`Add Yourself as ${a}`,onClick:()=>handleAddUser({UserName:r.Name,UserEmail:r.Email})});let E=[{label:"Full Name",column:"UserName"},{label:"Email Address",column:"UserEmail"}];R[a].allowSections&&E.push({label:"Accessible Sections",column:"JsonSettingsObject.AccessibleSections",asOptionList:!0}),R[a].allowOrganizationLevels&&E.push({label:x+" Name",column:x+"Name"}),R[a].allowAccessMode&&E.push({label:"Access Mode",column:"JsonSettingsObject.AccessMode"});let g=[{name:"UserName",label:"Full Name",type:"text",placeholder:"Enter user's full name",validate:{required:!0,minLength:3,maxLength:50}},{name:"UserEmail",label:"Email Address",type:"text",placeholder:"Enter user's email address",validate:{required:!0,email:!0}}];R[a].allowSections&&g.push({name:"JsonSettingsObject.AccessibleSections",label:"Accessible Sections",type:"select",multiple:!0,options:[{text:"All Sections",value:"All"},{text:"Event SetUp",value:"EventSetup"},{text:"Candidate Edit & Approve",value:"CandidateEditApprove"},{text:"Advanced Event Configurations",value:"AdvancedEventSetup"},{text:"Bulk Participants Management",value:"BulkParticipants"},{text:"Users Roles Management",value:"UsersRoles"},{text:"Print and Download",value:"PrintAndDownload"},{text:"Score Management",value:"ScoreManagement"},{text:"Draw Management",value:"DrawManagement"},{text:"Time Management",value:"TimeManagement"},{text:"Result Printing",value:"ResultPrinting"},{text:"Result Individual Printing Only",value:"ResultIndividualPrinting"},{text:"Publish Results",value:"PublishResults"},{text:"Publish to Social Media",value:"PublishToSocialMedia"},{text:"Certificate Printing",value:"CertificatePrinting"},{text:"Unit Management",value:"UnitManagement"}],validate:{required:!0}}),R[a].allowOrganizationLevels&&g.push({name:x,label:`${x} Name`,type:"select",multiple:!1,options:w?.length?w.map(o=>({text:o.Name,value:o.Id})):[],validate:{required:!0}}),R[a].allowAccessMode&&g.push({name:"JsonSettingsObject.AccessMode",label:"Access Mode",type:"select",multiple:!1,options:[{text:"Editable",value:"Editable"},{text:"Readable",value:"Readable"}],validate:{required:!0}});const k=async o=>{let i={...C,...o,UserName:o.UserName||o.Name,UserEmail:o.UserEmail||o.Email};i.UserName&&i.UserEmail?(await A(i),T.success("User imported successfully!")):T.error("User Name and Email are required to create a new user")};return e.jsx(ae,{heading:`Manage User Roles - ${a}`,childrenClasses:"px-0 py-2",headingClasses:"px-3",outerClasses:"max-w-full mx-auto ml-5 bg-gray-50 print:hidden shadow-sm",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-primary text-sm mb-4",children:"Assign and manage user roles for this event. You can add, import, or share login details with users."}),j&&e.jsx("div",{className:"flex justify-center items-center mb-4",children:e.jsx(V,{})}),e.jsx(J,{...y,defaultFormValues:C,onImportEach:k,formTitle:`Manage User Roles - ${a}`,formDescription:`Create or update ${a} users by entering their name and email address.`,topActions:N,fields:E,searchFields:[{label:"Search by Name",type:"text",column:"UserName",placeholder:"Type a name to search..."}],deleteProps:{fromKey:"UserRoleId",postKey:"UserUId"},formFields:g,actions:[{type:"edit",icon:e.jsx(me,{className:"-mr-0.5 h-5 w-5 text-primary"})},{type:"whatsapp",icon:e.jsx(ue,{className:"-mr-0.5 h-5 w-5 text-green-600"}),callback:o=>I(o)},{type:"delete",icon:e.jsx(ie,{className:"-mr-0.5 h-5 w-5 text-red-500"})}],buttonContainerClass:"flex justify-end gap-2 mt-4"})]})})}export{Fe as default};
