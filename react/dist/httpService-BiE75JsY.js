import{a as C}from"./index-t--hEgTQ.js";import{u as O,_ as p,p as b}from"./mainweb-5Gv3_6R1.js";let m=new Date,y=1;function S(...a){if((new Date().getTime()-m.getTime())/1e3>10&&(console.info(`%c===========================================

                Session ${y}

===========================================`,"color: white; font-style: italic; font-weight:bold; font-size:14px"),y++,m=new Date),a.length>0)try{if(localStorage.getItem("development")){console.info("%c"+a[0],"color: orange; font-style: italic; font-weight:bold; font-size:14px");let n=a.reduce(function(o,s,l){return l!=0?typeof s=="object"?Object.assign(o,s):Object.assign(o,{[l-1]:s}):o},{});console.info(n)}}catch{}}let c=window.location.origin,k=localStorage.getItem("siteConfig")?b(localStorage.getItem("siteConfig")):{apiUrl:"https://etalenterapi.azurewebsites.net"};window.location.href.indexOf("localhost")==-1?c=k.apiUrl:c="http://localhost:8888";const d={headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest"}};console.log("apiRoot"+c);const f=C.create({baseURL:c}),I=a=>{if(a.headers.Platform="Web",localStorage.user&&a.url.indexOf("login")==-1){let{token:e,refreshToken:t}=O();e&&(a.headers.Authorization=`Bearer ${e}`),t&&(a.headers.RefreshToken=t)}return a},D=a=>{if(S("responseFailed",a),a&&a.response&&a.response.data&&a.response.data.statusCode===401){var e=window.location.search.replace("?","").split("&"),t=e.filter(o=>o.toLowerCase().indexOf("dataset=")!=-1);if(t&&t.length>0){var n=t[0].split("=")[1];n&&(localStorage.clear(),window.location.href=""+window.location.href)}if(localStorage.userData){let{roleId:o}=JSON.parse(localStorage.userData).user;o==5&&(localStorage.clear(),window.location.href=""+window.location.href)}return localStorage.clear(),window.location.href="#logout",Promise.reject({...a})}return a.request&&a.request.status&&(a.request.status==="400"||a.request.status==="404")?Promise.reject({...a}):Promise.reject({...a})},P=a=>{if(localStorage.userData){let e=JSON.parse(localStorage.userData),{accesstoken:t,refreshtoken:n}=a.headers;t!=null&&n!==null&&t!==e.accessToken&&n!==e.refreshToken&&(e.accessToken=t,e.refreshToken=n,localStorage.removeItem("userData"),localStorage.setItem("userData",JSON.stringify(e)))}return a};function w(a){if(S("errorHandler",a),a){let{response:e}=a,{data:t}=e||{};if(a&&a.isAxiosError&&!e)p.error("Network Issue or Server Down",{autoClose:3e3,toastId:"network"});else if(e&&e.status==401&&t.message&&typeof t.message=="string")p.error(t.message,{autoClose:3e3,toastId:"network"});else if(e&&e.status==401)p.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"});else if(t&&e.status&&e.status==400&&t.SecurityValidations&&t.SecurityValidations.length>0){let n=t.SecurityValidations[0];p.error(n,{autoClose:3e3,toastId:"network"})}else t&&t.statusCode&&t.statusCode==400&&t.message&&typeof t.message=="string"?p.error(t.message,{autoClose:3e3,toastId:"network"}):t&&t.statusCode&&t.statusCode==400&&t.message?p.error(t.message,{autoClose:3e3,toastId:"network"}):p.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"})}}function v(a,e,t){if(e){a+="?";let n=[],o=["query","createUrl","filter"];for(const l in e)if(Object.hasOwnProperty.call(e,l)){let r=e[l];o.indexOf(l.toString())===-1&&r!=null&&n.push(`${l}=${r.toString()}`)}let s=[];for(const l in t)if(Object.hasOwnProperty.call(t,l)){let r=t[l];typeof r=="string"?s.push(`${l}=${r}`):s.push(`${l}=${r}`)}return s.length&&n.push(`${s.join("&")}`),a+=n.join("&"),a}return a}class u{constructor(){f.interceptors.request.handlers.length===0&&(f.interceptors.request.use(e=>I(e)),f.interceptors.response.use(e=>P(e),e=>D(e)))}getWithHeader(e,t){if(e)return f.get(c+e,t,d)}async get(e,t,n,o,s,l){let r={};return r.select=t??["id"],o!=null&&o.sortOrder&&(o!=null&&o.sortField)&&(r.sortField=o.sortField,r.sortOrder=o.sortOrder),r.filter=n,r.page=s+1,r.take=l??10,e=v(e,r,n),new Promise((h,g)=>{if(e)try{f.get(c+e,d).then(i=>{h(i)}).catch(i=>{w(i),g(i)})}catch(i){g(i)}})}async postAsGet(e,t,n,o,s,l){let r={};return r.select=t??["id"],o!=null&&o.sortOrder&&(o!=null&&o.sortColumn)&&(r.sortColumn=o.sortColumn,r.sortOrder=o.sortOrder),r.PageNumber=s+1,r.pageSize=l??10,r={...r,...n},new Promise((h,g)=>{if(e)try{f.post(c+e,r,d).then(i=>{h(i)}).catch(i=>{w(i),i.response?g({message:"Request failed for "+e,status:i.response.status,data:i.response.data}):i.request?g({message:"No response from server for "+e,error:i.message}):g({message:"Request setup error for "+e,error:i.message})})}catch(i){g(i)}})}async blob(e,t){return new Promise((n,o)=>{if(e)try{f.get(c+e,t,{...d,responseType:"blob"}).then(s=>{n(s)}).catch(s=>{w(s),o(s)})}catch(s){o(s)}})}post(e,t){return new Promise((n,o)=>{if(e)try{return f.post(c+e,t,{...d}).then(s=>{n(s)}).catch(s=>{w(s),o(s)})}catch(s){o(s)}})}upload(e,t){return new Promise((n,o)=>{if(e)try{return f.post(c+e,t,{...d,headers:{...d.headers,"Content-Type":"multipart/form-data"}}).then(s=>{n(s)}).catch(s=>{w(s),o(s)})}catch(s){o(s)}})}put(e,t){return new Promise((n,o)=>{if(e)try{return f.put(c+e,t,d).then(s=>{n(s)}).catch(s=>{w(s),o(s)})}catch(s){o(s)}})}remove(e,t){return new Promise((n,o)=>{if(e)try{return f.delete(c+e,{...d,data:t}).then(s=>{n(s)}).catch(s=>{w(s),o(s)})}catch(s){o(s)}})}}new u;const{getWithHeader:q}=new u,{get:R}=new u,{blob:$}=new u,{getAsync:N}=new u,{post:H}=new u,{postAsGet:J}=new u,{upload:z}=new u,{put:A}=new u,{remove:F}=new u,U=c;export{U as a,J as b,H as p,F as r,S as t,z as u};
