import{p as u}from"./mainweb-DNeqJxgm.js";function $(g,y,e){if(e?.JsonSettings){let s=u(e?.UserJsonSettings),n=u(e?.JsonSettings);e={...e,...s,...n}}let h={};Object.keys(e).forEach(s=>{let n=s[0]?.toLowerCase()+s.slice(1);h[n]||(h[n]=e[s])}),e={...e,...h},e?.RegistrationId&&!e?.registrationId&&(e.registrationId=e.RegistrationId);const C=e?Object.keys(e).filter(s=>s.includes("extra_payment_")):[],I=g?.AdditionalSettings,c=g?.components?.User?.find(s=>s.type==="RegistrationIdBox"),J=I?.EligibleRegistrationNumbers;let t=[];if(e?.teamMembers?.length>0&&g?.AdditionalSettings?.AllowTeamDiscountIfCaptainIsEligible==="Yes"){const s=e?.teamMembers?.find(l=>l.Designation===4),n=u(s?.UserJsonSettings),i=u(s?.JsonSettings);e={...e,...n,...i,...s},e.registrationId=s?.RegistrationId}const x=J?.find(s=>s.RegistrationNumber===(e?.registrationId??"-"));let A=c?.conditions?c.conditions.every(s=>{const n=e[`${s.key.charAt(0).toLowerCase()}${s.key.slice(1)}`],i=e[s.key];return n?.toString()===s.value?.toString()||i?.toString()===s.value?.toString()}):!0;if(x&&A&&c?.discountPercentage){const s=parseFloat(c.discountPercentage);t.push({Title:c.discountTitle,DiscountPercent:s})}const b=y.reduce((s,n)=>s+parseFloat(n.Fees),0),p=y.map(s=>({name:`${s.Title} - ${s.CompetitionCategoryName}`,total:s.Fees})),a=C.flatMap(s=>{const n=u(e[s]);return Object.entries(n).filter(([i,l])=>l.checked).map(([i,l])=>({name:i,total:l.fees}))}),r=a.reduce((s,n)=>s+parseFloat(n.total),0);let o=0;if(t.length>0){const s=t[0],n=parseFloat(s.DiscountPercent);o=b*n/100}const S=b+r,P=S-o,T=g?.AdditionalSettings?.FeesCurrency??"USD",d=[];return p.length>0&&d.push({heading:"Competitions Fees",total:p.reduce((s,n)=>s+parseFloat(n.total),0),products:p}),a.length>0&&d.push({heading:"Extra Fees",total:r,products:a}),t.length>0&&d.push({heading:"Discount",total:`-${o}`,products:t.map(s=>({name:s.Title,total:`-${o}`}))}),{products:p,subTotal:S,discountPrice:o,extraPayments:a,total:P,feesCurrency:T,discounts:t,orders:d}}export{$ as c};
