import{r as a,b as H,l as q,d as B,z as p,j as e,L as o,i as n,_ as c}from"./main-CalEMNEI.js";import{L as K}from"./layoutOuter-QY3rFcnm.js";import{P as Q}from"./pageHeader-rUTK8gWi.js";const X=n.lazy(()=>c(()=>import("./excelImportComponent-ComgpFvN.js"),[])),Z=n.lazy(()=>c(()=>import("./groupFilterTab-BJ5htmJh.js"),[])),$=n.lazy(()=>c(()=>import("./organizationLevelManager-DTtrRlF5.js"),[])),ee=n.lazy(()=>c(()=>import("./participantFilterTab-CCpYo33q.js"),[])),te=n.lazy(()=>c(()=>import("./participantFilters-CpfNfQ38.js"),[])),oe=({user:P})=>{const[I,ae]=a.useState(Date.now),[m,f]=a.useState(""),[g,C]=a.useState(""),[L,h]=a.useState(""),[l,k]=a.useState([]),[A,N]=a.useState(1e5),[O,s]=a.useState(1);let{user:T}=H()||{};const b=P||T,{eventLevels:z,topLevels:F,groups:r,eventCacheLoaded:j}=q(),{advancedSettings:G}=B(),d=G||{};let u=null;if(r&&Array.isArray(r)&&r.length>0){let t=r.find(i=>i.GroupName.toLowerCase()==="common");t||(t=r.find(i=>(i.JsonSettings?JSON.parse(i.JsonSettings):{}).IsCommon==="Yes")),u=t?t.EventGroupId:null}console.log("eventConfig:",d);const[v,x]=a.useState({candidateName:"",candidateIdentityNumber:"",isIncludeStatusTitle:"Yes",isIncludeCommon:"",commonGroup:u,isListWithoutSelectedGroup:""});a.useEffect(()=>{x(t=>({...t,isIncludeCommon:d.DefaultValueForMixingCommonWithOtherAgeGroups=="Yes"?"true":d.DefaultValueForMixingCommonWithOtherAgeGroups==="No"?"false":""}))},[d.DefaultValueForMixingCommonWithOtherAgeGroups]);const w=a.useCallback(t=>{if(Array.isArray(t)){k(t);const i=t.slice().reverse().find(Y=>{const E=Object.values(Y)[0];return E&&E!==""}),y=i?Object.values(i)[0]:"";h(y),s(1)}else h(t),s(1)},[]),S=a.useCallback(t=>{x(t)},[]);a.useCallback(t=>{N(t),s(1)},[]);const D=a.useCallback(t=>{s(t)},[]),V=a.useCallback(t=>{f(t),s(1)},[]),M=a.useCallback(t=>{C(t),s(1)},[]),_=a.useCallback(t=>{p.success("Edit functionality will be handled by ExcelImportComponent")},[]),R=a.useCallback(t=>{p.success("Delete functionality will be handled by ExcelImportComponent")},[]),W=a.useCallback(t=>{p.success("Team management will be handled by ExcelImportComponent")},[]),U=a.useCallback(()=>{},[]),J=a.useCallback(()=>{x({candidateName:"",candidateIdentityNumber:"",teamIdentityNumber:"",registrationId:"",isIncludeStatusTitle:"",isIncludeCommon:"",commonGroup:u,isListWithoutSelectedGroup:""}),h(""),f(""),C(""),s(1),p.success("Filters cleared")},[u]);if(!j||l===null){let t=[];return j||t.push("event data"),l===null&&t.push("organization data"),e.jsx(o,{info:"Loading participants data..."+t.join(", ")})}return e.jsx(K,{children:e.jsxs("div",{className:"flex flex-col grow",children:[e.jsx(Q,{heading:"Excel Import - Bulk Participant Management",subHeading:"Paste participant data directly from Excel or Google Sheets for quick bulk registration"}),e.jsx("div",{className:"bg-surfaceCard border-b border-border",children:e.jsxs("div",{className:"flex flex-row flex-wrap gap-2 w-full",children:[e.jsx("div",{className:"flex-1 min-w-[300px] px-2 py-1",children:e.jsx(n.Suspense,{fallback:e.jsx(o,{info:"Loading organization manager..."}),children:e.jsx($,{user:b,eventLevels:z,topLevels:F,selectedOrganizations:l,onOrganizationChange:w})})}),e.jsx("div",{className:"flex-1 min-w-[300px]",children:e.jsx(n.Suspense,{fallback:e.jsx(o,{info:"Loading filters..."}),children:e.jsx(te,{filterCriterias:v,onFilterChange:S,onApply:S,showAdvancedFilters:!1,onToggleAdvancedFilters:()=>{}})})})]})}),e.jsx("div",{className:"bg-surfaceCard border-b border-border",children:e.jsx("div",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-row gap-x-2 justify-between",children:[e.jsx("div",{className:"",children:e.jsx(n.Suspense,{fallback:e.jsx(o,{info:"Loading participant tabs..."}),children:e.jsx(ee,{selectedParticipantType:m,onParticipantTypeChange:V,selectedGroupFilter:g})})}),e.jsx("div",{className:"",children:e.jsx(n.Suspense,{fallback:e.jsx(o,{info:"Loading group tabs..."}),children:e.jsx(Z,{allowAll:!0,selectedGroupFilter:g,onGroupFilterChange:M,selectedParticipantType:m})})})]})})}),e.jsx("div",{className:"bg-surface relative",children:l.length>0&&e.jsx(n.Suspense,{fallback:e.jsx(o,{info:"Loading Excel import..."}),children:e.jsx(X,{onEdit:_,onView:_,onDelete:R,onTeamManage:W,selectedGroupFilter:g,selectedParticipantType:m,selectedOrganization:L,pageSize:A,currentPage:O,filterCriterias:v,currentUser:b,onAssignmentChange:U,onPageChange:D,selectedOrganizations:l,onClearFilters:J},I)})})]})})};export{oe as default};
