import{b as ce,r as m,u as H,q as S,n as fe,j as e,L as $,k as Q,_ as W,g as ge,p as he,z as xe}from"./main-D6fL8wl5.js";import{B as X}from"./box-C3wUERs5.js";import{r as Se,e as ve,g as be,d as je,u as we,U as Ne,f as ye,S as Ce}from"./publicRegistrationHelper-BneCENw3.js";import{R as Re}from"./renderRegistrationForm-C-uaqNCS.js";import{F as Te}from"./PencilIcon-C2YXw-Pi.js";import{F as Ue}from"./PrinterIcon-BL0__BDm.js";import"./useConfirmation-EFq2LVbL.js";import"./dialog-B0FPhjVi.js";import"./keyboard-B66pbDPr.js";import"./description-DAT-36ca.js";import"./use-is-mounted-QNgqEsQy.js";import"./navigationUtils-iQi8X97Q.js";import"./CheckIcon-Df_DGzMi.js";import"./TrashIcon-BCKCcSC1.js";import"./eventDetailedView-Bwlk0krM.js";import"./UserPlusIcon-C3xwUzft.js";import"./UserGroupIcon-CpDHqpaS.js";import"./ChevronRightIcon-EX5qra_x.js";import"./TrashIcon-C1piEVVk.js";const Je=Q.lazy(()=>W(()=>import("./formSubmission-C5M9xaSP.js"),[])),Ee=Q.lazy(()=>W(()=>import("./modalForm-0TI4OFKg.js"),[]));function Ae({view:n,setActiveTab:y,getEvets:u,isCoordinatorView:b,setParticipantTypeInt:p,getParticipants:s,participantTypeInt:i,candidateId:r,closeModel:C,customComponents:v,allowEdit:R}){let{user:c}=ce()||{};c?.RoleTitle,c?.Email?.indexOf("justnshalom")!=-1;let[l,I]=m.useState(null),[A,P]=m.useState({}),[j,t]=m.useState(null),[f,g]=m.useState(!1),[L,T]=m.useState(null),[h,U]=m.useState([]),[w,Ge]=m.useState(i==1?"Individual":i==2?"Team":""),[Y,Be]=m.useState([...Se]);const{row:V,status:Z}=H(u||"/CandidateJson/GetEvents",{select:"AllowDisplayCompetitionOrder,Description,EVId,EndDateString,EventCategory,EventCategoryTitle,EventLogo,EventName,IdentityBackgroundImage,OrganizationLogo,OrganizationName,OrganizationShortName,StartDateString,Venue,JsonSettings",doCache:!0});let ee="finished",te="finished",se="finished",{row:G,status:ne}=H(s||"/CandidateJson/GetParticipants",{deleteUrl:"/CandidateJson/RemoveUser",mandatoryParams:["participantType"],select:"participantList,userList,UserEmail,UserName,UserDobString,UserImage,UserMobile,UserPhone,Email,Group,Candidate,CandidateUser,JsonSettings,Gender,GroupName,Fees,TeamTeamName,Team,TeamStrength,TeamMembersList,TeamMembers,TeamStrength,CandidateIdentityNumber,TeamIdentityNumber,CompetitionOrder,CreatedBy,CreatedByUserName,ParticipationId,UserJsonSettings,TeamJsonSettings,Remarks,LevelSettings,RegistrationId",updateUrl:"/CandidateJson/UpdateParticipant",doCache:!0,filter:r?{Candidate:r,...i==1?{participantType:"1"}:i==2?{participantType:"2"}:{}}:{}}),ie=ve(G,r,l?.UId,j?.Team),{userRole:z,users:M,userData:B,teamData:O}=ie;if(l=l||B,j=j||O,M?.length||S(localStorage.user)?.user,w=="Team"){let a=S(localStorage.user)?.user;a&&a?.Email?.indexOf("justnshalom")==-1}f=fe(Z,ee,te,se,ne)||f;let q=S(z?.JsonSettings),ae=S(B?.JsonSettings),re=S(O?.TeamJsonSettings);const _=V?.JsonSettings,J=(_!=null&&_!=""?S(_):{components:{}}).components,oe=Object.keys(J??{});let le=S(A?.JsonSettings),k=oe?.includes("Agreement")&&J?.Agreement?.filter(a=>a?.validate?.required&&!q[a.name]&&!le[a.name])?.length==0;k&&localStorage.setItem("isAgreementStepFilled","true"),localStorage.getItem("isAgreementStepFilled")=="true"&&(k=!0);let o=be(J,Y,k,w,M,{},n),E={},me=!0,ue=()=>{C&&C()};if(r&&!G)return e.jsx($,{});let d=[];if(w=="Individual"){let a=[];a.push(o[0]),d.push(a);let x=[];o.length>1&&x.push(o[1]),d.push(x),x=[],o.length>2&&x.push(o[2]),d.push(x);let N=[];o.length>3&&N.push(o[3]),d.push(N)}else{let a=[];o.length>2&&a.push(o[2]),d.push(a),a=[],o.length>3&&a.push(o[3]),d.push(a);let x=[];o.length>4&&x.push(o[4]),d.push(x);let N=[];o.length>5&&N.push(o[5]),d.push(N)}return console.log({splitBy2:d}),e.jsx("div",{children:e.jsx(Ee,{title:"Registration Form",description:"Please fill the form to register for the event",open:!0,customHeading:v||null,setOpen:()=>{ue()},children:e.jsx(X,{heading:"",outerClasses:"relative w-full",headingClasses:"px-1 lg:px-4 print:hidden w-full",children:e.jsx("div",{className:"w-full mt-5 min-h-[600px] print:mt-0 flex flex-col",id:"registrationBox",children:d.map((a,x)=>e.jsx("div",{className:"flex w-full flex-1 gap-x-8",children:a.map((N,de)=>{E=N,h=je(J,E);let pe=E?we(E.name,{},()=>{},()=>{},E,z,q,B,ae,w,O,G,J,l,j,re,!1,A):{};return e.jsx("div",{className:"flex-1",children:e.jsx(Je,{isPrint:!0,isCoordinatorView:b,participantType:w,isGuardianRegistration:!1,handleNext:()=>{},isSubmitted:me,eventDetails:V,isPlayGround:!1,onChange:()=>{},data:pe,isLastStep:!1,existingComponents:h,selectedComponent:L,setSelectedComponent:()=>{},components:h,setComponents:()=>{}},de)})})}))})})})})}var D={exports:{}};var K;function Fe(){return K||(K=1,(function(n){(function(){var y={}.hasOwnProperty;function u(){for(var s="",i=0;i<arguments.length;i++){var r=arguments[i];r&&(s=p(s,b(r)))}return s}function b(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return u.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var i="";for(var r in s)y.call(s,r)&&s[r]&&(i=p(i,r));return i}function p(s,i){return i?s?s+" "+i:s+i:s}n.exports?(u.default=u,n.exports=u):window.classNames=u})()})(D)),D.exports}var Ie=Fe();const F=ge(Ie);let Le=({selectedParticipantDetails:n,participantType:y,setAllowEdit:u,setOpen:b,setFilter:p,setPrint:s,eventDetails:i})=>{let r=localStorage.getItem("siteConfig")?JSON.parse(localStorage.getItem("siteConfig")):{};const[C,v]=m.useState(!1),[R,c]=m.useState(""),[l,I]=m.useState("Pending"),A=(t,f)=>{let g="";if(f==="Approved"){g="Thank you for your registration, "+t?.UserName+`
`,g+="Based on your date of birth ("+t?.UserDobString+"), you have been assigned to the "+t?.GroupName+` age group and successfully registered for the following competitions:
`;let L=t?.participatingCompetitions,T={};L?.forEach(h=>{let U=h?.GroupName;T[U]||(T[U]=[]),T[U].push(h)});for(const h in T)g+=`
`+h+` Group
`,T[h].forEach((U,w)=>{g+=w+1+" - "+U?.Title+`
`});g+=`
Please login with the credentials sent in your email to see candidate details and participation informations under the Participation tab. 
`,g+="Login: "+r?.emailConfigSiteUrl+`
`}c(g),I(f),v(!0)},P=()=>{if(I(l),R.trim()){c(""),v(!1);let t=S(n?.user?.JsonSettings);t||(t={}),t.ApprovalStatus=l,t.ReviewComments||(t.ReviewComments=[]),t.ReviewComments.push({Comment:R,Status:l,Date:new Date().toISOString()}),l==="Reviewed"&&(t.FinishedSteps=!1),l==="Approved"&&(t.FinishedSteps=!0);let f={ParticipantType:y,UserRoleId:n.user.Candidate,TeamId:n.user.Team,JsonSettings:JSON.stringify(t)};he("/UsersRolesJson/Approve",f).then(g=>{xe.success("Review submitted successfully and emailed to the user."),u(!1),b(!1),p(!0)})}else alert("Please add a comment before submitting.")};let j=[];if(n?.user?.JsonSettings){let t=S(n?.user?.JsonSettings);t?.ReviewComments&&(j=t?.ReviewComments)}return e.jsxs("div",{className:"border-b border-gray-200 pb-5 bg-white flex flex-1 flex-col pr-10 print:pr-0",children:[e.jsxs("div",{className:"sm:flex flex-row sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1 gap-x-10",children:[n?.user?.UserName&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[n?.user?.CandidateIdentityNumber," - ",n?.user?.UserName]}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.Email}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.UserMobile}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.UserDobString})]}),n?.user?.TeamTeamName&&e.jsx(e.Fragment,{children:e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[n?.user?.TeamIdentityNumber," -",n?.user?.TeamTeamName]})}),e.jsxs("button",{className:"inline-flex items-center print:hidden gap-x-1.5 px-10 rounded-md bg-blue-600 mt-5  py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",onClick:()=>u(!0),children:[e.jsx(Te,{className:"h-5 w-5 inline-block -mt-0.5 mr-0 "}),"Edit"]}),e.jsx("button",{onClick:()=>{s(!0)},className:"bg-darkprimary text-white px-10  ml-2 py-1.5 rounded-md print:hidden",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"hidden print:flex  max-h-90  flex-col justify-items-end flex-wrap",children:[e.jsx("div",{className:"text-primary text-right",children:i?.EventName}),e.jsx("div",{className:"justify-end flex",children:e.jsx("img",{src:i?.EventLogo,alt:"logo",className:"max-h-16 w-auto"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col space-y-4 print:hidden",children:[e.jsx(Ne,{person:n?.user}),e.jsx(ye,{onClick:A,person:n?.user})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{children:j.map((t,f)=>e.jsx("div",{className:"mt-2 flex flex-col relative",children:e.jsx("div",{className:F("border-l-4 p-4",t?.Status==="Reviewed"?"border-yellow-400 bg-yellow-50":t?.Status==="Approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"),children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:F("text-lg font-bold",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Status}),e.jsx("p",{className:F("text-sm whitespace-pre-line",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Comment??t}),e.jsx("p",{className:F("font-medium text-right ",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Date})]})})})},f))}),C&&e.jsx("div",{className:"mt-2 flex flex-col relative print:hidden",children:e.jsxs(X,{heading:"Please enter the reason for change status to "+l,childrenClasses:"flex flex-col mt-4 relative",children:[e.jsxs("div",{className:"rounded-lg bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment..."}),e.jsx("textarea",{id:"comment",name:"comment",rows:6,placeholder:"Add your comment..., The comment will be sent to the user via email.",className:"block w-full rounded-lg resize-none bg-transparent px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",value:R,onChange:t=>c(t.target.value)})]}),e.jsxs("div",{className:" inset-x-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:[e.jsx("div",{className:"flex items-center space-x-5"}),e.jsx("div",{className:"shrink-0",children:e.jsx(Ce,{onClick:P,currentReviewStatus:l})})]})]})})]})]})};function it({participantType:n,candidateId:y,eventDetails:u,setFilter:b,selectedParticipantDetails:p,setOpen:s}){let[i,r]=m.useState(!1),[C,v]=m.useState(!1),[R,c]=m.useState(!1),l=C?Ae:Re;return e.jsx(l,{isCoordinatorView:!0,view:"participationDetails",getEvets:"/EventJson/Get",allowEdit:i,getUserRoles:"/UsersRolesPlusUsersJson/Get",getTeams:"/CompetitionParticipantsTeamsJson/Get",getUsers:"/UsersRolesPlusUsersJson/Get",customComponents:e.jsxs(e.Fragment,{children:[R&&e.jsx($,{}),e.jsx(Le,{setPrint:()=>{window.parent.document.title="Candiidate Details - "+p.user.UserName+" - "+p.user.UserDobString,v(!0),c(!0),window.onafterprint=()=>{v(!1)},setTimeout(()=>{c(!1)},2e3),setTimeout(()=>{window.print()},3e3)},participantType:n,eventDetails:u,selectedParticipantDetails:p,setFilter:b,setOpen:s,setAllowEdit:r})]}),getParticipants:"/CoordinatorJson/GetParticipants",closeModel:()=>{s(!1)},participantTypeInt:n,candidateId:y,setActiveTab:()=>{}})}export{it as default};
