import{r as o,u as j,k as U,j as s}from"./main-DBQ-0816.js";import{F as w}from"./MagnifyingGlassIcon-7NdcZ1Ts.js";import{F as y}from"./XMarkIcon-Dji_-LIx.js";import{F as S}from"./UserIcon-C3XZw-sQ.js";import{F as v}from"./CheckCircleIcon-CyK7fEoM.js";const R=({onChangeValue:h,formData:a,component:P})=>{const[r,m]=o.useState(""),[b,c]=o.useState(!1),[d,u]=o.useState(null);o.useEffect(()=>{const e=a?.Name||a?.name||"";e&&e.length>=2&&e!==r&&(m(e),c(!0))},[a?.Name,a?.name]);const{rows:l=[],isLoading:g}=j("/UsersRolesPlusUsersJson/Get",{select:"UserId,UserName,Email,UserMobile,UserPhone,UserDobString,UserImage,UserJsonSettings,Group,Organization",filter:{UserName:r,status:1},skip:!r||r.length<2,doCache:!1}),n=U.useMemo(()=>{if(!l||l.length===0)return[];const e=new Set;return l.filter(t=>{const i=`${t.UserName}_${t.UserDobString}_${t.Email}`;return e.has(i)?!1:(e.add(i),!0)})},[l]),f=e=>{const t={Name:e.UserName,Email:e.Email,Mobile:e.UserMobile,Phone:e.UserPhone,DobString:e.UserDobString,ProfilePicture:e.UserImage,Gender:e.UserJsonSettings?.Gender};Object.entries(t).forEach(([i,x])=>{x&&h(i,x)}),u(e),c(!1)},N=()=>{m(""),c(!1),u(null)};return!r||r.length<2||n.length===0||!b?null:s.jsxs("div",{className:"mb-4 rounded-lg border border-blue-200 bg-blue-50 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(w,{className:"h-5 w-5 text-blue-600"}),s.jsxs("h3",{className:"text-sm font-semibold text-blue-900",children:["Found ",n.length," matching profile",n.length!==1?"s":""]})]}),s.jsx("button",{type:"button",onClick:N,className:"text-blue-600 hover:text-blue-800","aria-label":"Close",children:s.jsx(y,{className:"h-5 w-5"})})]}),s.jsx("p",{className:"text-xs text-blue-700 mb-3",children:"Click on a profile below to auto-fill your information"}),g?s.jsx("div",{className:"flex items-center justify-center py-4",children:s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:n.map((e,t)=>s.jsxs("button",{type:"button",onClick:()=>f(e),className:"w-full flex items-center gap-3 p-3 rounded-lg border transition-all "+(d?.UserId===e.UserId?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-300 hover:bg-blue-50"),children:[e.UserImage?s.jsx("img",{src:e.UserImage,alt:e.UserName,className:"h-12 w-12 rounded-full object-cover flex-shrink-0"}):s.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0",children:s.jsx(S,{className:"h-6 w-6 text-gray-500"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:e.UserName}),d?.UserId===e.UserId&&s.jsx(v,{className:"h-5 w-5 text-green-600"})]}),s.jsx("p",{className:"text-xs text-gray-600",children:e.Email}),e.UserDobString&&s.jsxs("p",{className:"text-xs text-gray-500",children:["DOB: ",e.UserDobString]})]})]},`${e.UserId}_${t}`))}),d&&s.jsx("div",{className:"mt-3 p-2 bg-green-100 border border-green-300 rounded text-xs text-green-800",children:"âœ“ Profile auto-filled successfully. You can edit the fields if needed."})]})};export{R as default};
