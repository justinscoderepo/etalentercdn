import{b as xe,r as m,B as W,u as $,o as S,m as Se,j as e,L as V,i as X,_ as Y,g as ve,p as be,z as je}from"./main-D8b2PQfU.js";import{B as Z}from"./box-COWF73Hs.js";import{r as we,e as Ne,g as ye,b as Ce,u as Re,U as Te,c as Ue,S as Ae}from"./publicRegistrationHelper-299tnkZO.js";import{RenderRegistrationForm as Je}from"./renderRegistrationForm-iQvXHTmb.js";import{F as Ee}from"./PencilIcon-ZMl0feKD.js";import{F as Fe}from"./PrinterIcon-D-tCITS4.js";import"./alert-BB_1A6He.js";const Le=X.lazy(()=>Y(()=>import("./formSubmission-BX8UVmMC.js"),[])),Be=X.lazy(()=>Y(()=>import("./modalForm-CHv5A1qo.js"),[]));function Ie({view:n,setActiveTab:y,getEvets:r,isCoordinatorView:v,setParticipantTypeInt:d,getParticipants:s,participantTypeInt:a,candidateId:o,closeModel:C,customComponents:b,allowEdit:R}){let{user:c}=xe()||{};c?.RoleTitle,c?.Email?.indexOf("justnshalom")!=-1;let[u,T]=m.useState(null),[J,L]=m.useState({}),[j,t]=m.useState(null),[p,f]=m.useState(!1),[I,U]=m.useState(null),[g,A]=m.useState([]),[w,Ge]=m.useState(a==1?"Individual":a==2?"Team":""),[ee,_e]=m.useState([...we]);const z=W(),{row:te,status:se}=$(r||"",{select:"AllowDisplayCompetitionOrder,Description,EVId,EndDateString,EventCategory,EventCategoryTitle,EventLogo,EventName,IdentityBackgroundImage,OrganizationLogo,OrganizationName,OrganizationShortName,StartDateString,Venue,JsonSettings",doCache:!0,noGet:!r}),M=r?te:z.eventDetails,ne=r?se:z.eventStatus;let ae="finished",ie="finished",re="finished",{row:O,status:oe}=$(s||"/CandidateJson/GetParticipants",{deleteUrl:"/CandidateJson/RemoveUser",mandatoryParams:["participantType"],select:"participantList,userList,UserEmail,UserName,UserDobString,UserImage,UserMobile,UserPhone,Email,Group,Candidate,CandidateUser,JsonSettings,Gender,GroupName,Fees,TeamTeamName,Team,TeamStrength,TeamMembersList,TeamMembers,TeamStrength,CandidateIdentityNumber,TeamIdentityNumber,CompetitionOrder,CreatedBy,CreatedByUserName,ParticipationId,UserJsonSettings,TeamJsonSettings,Remarks,LevelSettings,RegistrationId",updateUrl:"/CandidateJson/UpdateParticipant",doCache:!0,filter:o?{Candidate:o,...a==1?{participantType:"1"}:a==2?{participantType:"2"}:{}}:{}}),le=Ne(O,o,u?.UId,j?.Team),{userRole:q,users:H,userData:k,teamData:D}=le;if(u=u||k,j=j||D,H?.length||S(localStorage.user)?.user,w=="Team"){let i=S(localStorage.user)?.user;i&&i?.Email?.indexOf("justnshalom")==-1}p=Se(ne,ae,ie,re,oe)||p;let K=S(q?.JsonSettings),ue=S(k?.JsonSettings),me=S(D?.TeamJsonSettings);const G=M?.JsonSettings,E=(G!=null&&G!=""?S(G):{components:{}}).components,de=Object.keys(E??{});let ce=S(J?.JsonSettings),_=de?.includes("Agreement")&&E?.Agreement?.filter(i=>i?.validate?.required&&!K[i.name]&&!ce[i.name])?.length==0;_&&localStorage.setItem("isAgreementStepFilled","true"),localStorage.getItem("isAgreementStepFilled")=="true"&&(_=!0);let l=ye(E,ee,_,w,H,{},n),F={},pe=!0,fe=()=>{C&&C()};if(o&&!O)return e.jsx(V,{});let h=[];if(w=="Individual"){let i=[];i.push(l[0]),h.push(i);let x=[];l.length>1&&x.push(l[1]),h.push(x),x=[],l.length>2&&x.push(l[2]),h.push(x);let N=[];l.length>3&&N.push(l[3]),h.push(N)}else{let i=[];l.length>2&&i.push(l[2]),h.push(i),i=[],l.length>3&&i.push(l[3]),h.push(i);let x=[];l.length>4&&x.push(l[4]),h.push(x);let N=[];l.length>5&&N.push(l[5]),h.push(N)}return e.jsx("div",{children:e.jsx(Be,{title:"Registration Form",description:"Please fill the form to register for the event",open:!0,customHeading:b||null,setOpen:()=>{fe()},children:e.jsx(Z,{heading:"",outerClasses:"relative w-full",headingClasses:"px-1 lg:px-4 print:hidden w-full",children:e.jsx("div",{className:"w-full mt-5 min-h-[600px] print:mt-0 flex flex-col",id:"registrationBox",children:h.map((i,x)=>e.jsx("div",{className:"flex w-full flex-1 gap-x-8",children:i.map((N,ge)=>{F=N,g=Ce(E,F);let he=F?Re(F.name,{},()=>{},()=>{},F,q,K,k,ue,w,D,O,E,u,j,me,!1):{};return e.jsx("div",{className:"flex-1",children:e.jsx(Le,{isPrint:!0,isCoordinatorView:v,participantType:w,isGuardianRegistration:!1,handleNext:()=>{},isSubmitted:pe,eventDetails:M,isPlayGround:!1,onChange:()=>{},data:he,isLastStep:!1,existingComponents:g,selectedComponent:I,setSelectedComponent:()=>{},components:g,setComponents:()=>{}},ge)})})}))})})})})}var P={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Q;function Oe(){return Q||(Q=1,(function(n){(function(){var y={}.hasOwnProperty;function r(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=d(s,v(o)))}return s}function v(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return r.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)y.call(s,o)&&s[o]&&(a=d(a,o));return a}function d(s,a){return a?s?s+" "+a:s+a:s}n.exports?(r.default=r,n.exports=r):window.classNames=r})()})(P)),P.exports}var ke=Oe();const B=ve(ke);let De=({selectedParticipantDetails:n,participantType:y,setAllowEdit:r,setOpen:v,setFilter:d,setPrint:s,eventDetails:a})=>{let o=localStorage.getItem("siteConfig")?JSON.parse(localStorage.getItem("siteConfig")):{};const[C,b]=m.useState(!1),[R,c]=m.useState(""),[u,T]=m.useState("Pending"),J=(t,p)=>{let f="";if(p==="Approved"){f="Thank you for your registration, "+t?.UserName+`
`,f+="Based on your date of birth ("+t?.UserDobString+"), you have been assigned to the "+t?.GroupName+` age group and successfully registered for the following competitions:
`;let I=t?.participatingCompetitions,U={};I?.forEach(g=>{let A=g?.GroupName;U[A]||(U[A]=[]),U[A].push(g)});for(const g in U)f+=`
`+g+` Group
`,U[g].forEach((A,w)=>{f+=w+1+" - "+A?.Title+`
`});f+=`
Please login with the credentials sent in your email to see candidate details and participation informations under the Participation tab. 
`,f+="Login: "+o?.emailConfigSiteUrl+`
`}c(f),T(p),b(!0)},L=()=>{if(T(u),R.trim()){c(""),b(!1);let t=S(n?.user?.JsonSettings);t||(t={}),t.ApprovalStatus=u,t.ReviewComments||(t.ReviewComments=[]),t.ReviewComments.push({Comment:R,Status:u,Date:new Date().toISOString()}),u==="Reviewed"&&(t.FinishedSteps=!1),u==="Approved"&&(t.FinishedSteps=!0);let p={ParticipantType:y,UserRoleId:n.user.Candidate,TeamId:n.user.Team,JsonSettings:JSON.stringify(t)};be("/UsersRolesJson/Approve",p).then(f=>{je.success("Review submitted successfully and emailed to the user."),r(!1),v(!1),d(!0)})}else alert("Please add a comment before submitting.")};let j=[];if(n?.user?.JsonSettings){let t=S(n?.user?.JsonSettings);t?.ReviewComments&&(j=t?.ReviewComments)}return e.jsxs("div",{className:"border-b border-gray-200 pb-5 bg-white flex flex-1 flex-col pr-10 print:pr-0",children:[e.jsxs("div",{className:"sm:flex flex-row sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1 gap-x-10",children:[n?.user?.UserName&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[n?.user?.CandidateIdentityNumber," - ",n?.user?.UserName]}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.Email}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.UserMobile}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:n?.user?.UserDobString})]}),n?.user?.TeamTeamName&&e.jsx(e.Fragment,{children:e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[n?.user?.TeamIdentityNumber," -",n?.user?.TeamTeamName]})}),e.jsxs("button",{className:"inline-flex items-center print:hidden gap-x-1.5 px-10 rounded-md bg-blue-600 mt-5  py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",onClick:()=>r(!0),children:[e.jsx(Ee,{className:"h-5 w-5 inline-block -mt-0.5 mr-0 "}),"Edit"]}),e.jsx("button",{onClick:()=>{s(!0)},className:"bg-darkprimary text-white px-10  ml-2 py-1.5 rounded-md print:hidden",children:e.jsx(Fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"hidden print:flex  max-h-90  flex-col justify-items-end flex-wrap",children:[e.jsx("div",{className:"text-primary text-right",children:a?.EventName}),e.jsx("div",{className:"justify-end flex",children:e.jsx("img",{src:a?.EventLogo,alt:"logo",className:"max-h-16 w-auto"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col space-y-4 print:hidden",children:[e.jsx(Te,{person:n?.user}),e.jsx(Ue,{onClick:J,person:n?.user})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{children:j.map((t,p)=>e.jsx("div",{className:"mt-2 flex flex-col relative",children:e.jsx("div",{className:B("border-l-4 p-4",t?.Status==="Reviewed"?"border-yellow-400 bg-yellow-50":t?.Status==="Approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"),children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:B("text-lg font-bold",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Status}),e.jsx("p",{className:B("text-sm whitespace-pre-line",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Comment??t}),e.jsx("p",{className:B("font-medium text-right ",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Date})]})})})},p))}),C&&e.jsx("div",{className:"mt-2 flex flex-col relative print:hidden",children:e.jsxs(Z,{heading:"Please enter the reason for change status to "+u,childrenClasses:"flex flex-col mt-4 relative",children:[e.jsxs("div",{className:"rounded-lg bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment..."}),e.jsx("textarea",{id:"comment",name:"comment",rows:6,placeholder:"Add your comment..., The comment will be sent to the user via email.",className:"block w-full rounded-lg resize-none bg-transparent px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",value:R,onChange:t=>c(t.target.value)})]}),e.jsxs("div",{className:" inset-x-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:[e.jsx("div",{className:"flex items-center space-x-5"}),e.jsx("div",{className:"shrink-0",children:e.jsx(Ae,{onClick:L,currentReviewStatus:u})})]})]})})]})]})};function We({participantType:n,candidateId:y,eventDetails:r,setFilter:v,selectedParticipantDetails:d,setOpen:s,idEdit:a=!1,isDirectOpen:o=!1}){let[C,b]=m.useState(!!a),[R,c]=m.useState(!1),[u,T]=m.useState(!1),J=R?Ie:Je;const{isReady:L}=W();return L?e.jsx(J,{isDirectOpen:o,isCoordinatorView:!0,view:"participationDetails",getEventsLink:"/EventJson/Get",allowEdit:C,customComponents:e.jsxs(e.Fragment,{children:[u&&e.jsx(V,{}),e.jsx(De,{setPrint:()=>{window.parent.document.title="Candiidate Details - "+d.user.UserName+" - "+d.user.UserDobString,c(!0),T(!0),window.onafterprint=()=>{c(!1)},setTimeout(()=>{T(!1)},2e3),setTimeout(()=>{window.print()},3e3)},participantType:n,eventDetails:r,selectedParticipantDetails:d,setFilter:v,setOpen:s,setAllowEdit:b})]}),getParticipantsLink:"/CoordinatorJson/GetParticipants",closeModel:()=>{s(!1)},participantTypeInt:n,candidateId:y,setActiveTab:()=>{}}):e.jsx(V,{})}export{We as default};
