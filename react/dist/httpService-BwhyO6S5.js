import{a as C}from"./index-t--hEgTQ.js";import{u as O,_ as p,p as b}from"./mainweb-DpVLNjpv.js";let m=new Date,y=1;function S(...o){if((new Date().getTime()-m.getTime())/1e3>10&&(console.info(`%c===========================================

                Session ${y}

===========================================`,"color: white; font-style: italic; font-weight:bold; font-size:14px"),y++,m=new Date),o.length>0)try{if(localStorage.getItem("development")){console.info("%c"+o[0],"color: orange; font-style: italic; font-weight:bold; font-size:14px");let n=o.reduce(function(a,s,l){return l!=0?typeof s=="object"?Object.assign(a,s):Object.assign(a,{[l-1]:s}):a},{});console.info(n)}}catch{}}let c=window.location.origin,k=localStorage.getItem("siteConfig")?b(localStorage.getItem("siteConfig")):{apiUrl:"https://etalenterapi.azurewebsites.net"};window.location.href.indexOf("localhost")==-1?c=k.apiUrl:c="http://localhost:8888";const d={headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest"}};console.log("apiRoot"+c);const f=C.create({baseURL:c}),I=o=>{if(o.headers.Platform="Web",localStorage.user&&o.url.indexOf("login")==-1){let{token:e,refreshToken:t}=O();e&&(o.headers.Authorization=`Bearer ${e}`),t&&(o.headers.RefreshToken=t)}return o},D=o=>{if(S("responseFailed",o),o&&o.response&&o.response.data&&o.response.data.statusCode===401){var e=window.location.search.replace("?","").split("&"),t=e.filter(a=>a.toLowerCase().indexOf("dataset=")!=-1);if(t&&t.length>0){var n=t[0].split("=")[1];n&&(localStorage.clear(),window.location.href=""+window.location.href)}if(localStorage.userData){let{roleId:a}=JSON.parse(localStorage.userData).user;a==5&&(localStorage.clear(),window.location.href=""+window.location.href)}return localStorage.clear(),window.location.href="#logout",Promise.reject({...o})}return o.request&&o.request.status&&(o.request.status==="400"||o.request.status==="404")?Promise.reject({...o}):Promise.reject({...o})},P=o=>{if(localStorage.userData){let e=JSON.parse(localStorage.userData),{accesstoken:t,refreshtoken:n}=o.headers;t!=null&&n!==null&&t!==e.accessToken&&n!==e.refreshToken&&(e.accessToken=t,e.refreshToken=n,localStorage.removeItem("userData"),localStorage.setItem("userData",JSON.stringify(e)))}return o};function w(o){if(S("errorHandler",o),o){let{response:e}=o,{data:t}=e||{};if(o&&o.isAxiosError&&!e)p.error("Network Issue or Server Down",{autoClose:3e3,toastId:"network"});else if(e&&e.status==401&&t.message&&typeof t.message=="string")p.error(t.message,{autoClose:3e3,toastId:"network"});else if(e&&e.status==401)p.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"});else if(t&&e.status&&e.status==400&&t.SecurityValidations&&t.SecurityValidations.length>0){let n=t.SecurityValidations[0];p.error(n,{autoClose:3e3,toastId:"network"})}else t&&t.statusCode&&t.statusCode==400&&t.message&&typeof t.message=="string"?p.error(t.message,{autoClose:3e3,toastId:"network"}):t&&t.statusCode&&t.statusCode==400&&t.message?p.error(t.message,{autoClose:3e3,toastId:"network"}):p.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"})}}function v(o,e,t){if(e){o+="?";let n=[],a=["query","createUrl","filter"];for(const l in e)if(Object.hasOwnProperty.call(e,l)){let r=e[l];a.indexOf(l.toString())===-1&&r!=null&&n.push(`${l}=${r.toString()}`)}let s=[];for(const l in t)if(Object.hasOwnProperty.call(t,l)){let r=t[l];typeof r=="string"?s.push(`${l}=${r}`):s.push(`${l}=${r}`)}return s.length&&n.push(`${s.join("&")}`),o+=n.join("&"),o}return o}class u{constructor(){f.interceptors.request.handlers.length===0&&(f.interceptors.request.use(e=>I(e)),f.interceptors.response.use(e=>P(e),e=>D(e)))}getWithHeader(e,t){if(e)return f.get(c+e,t,d)}async get(e,t,n,a,s,l){let r={};return r.select=t??["id"],a?.sortOrder&&a?.sortField&&(r.sortField=a.sortField,r.sortOrder=a.sortOrder),r.filter=n,r.page=s+1,r.take=l??10,e=v(e,r,n),new Promise((h,g)=>{if(e)try{f.get(c+e,d).then(i=>{h(i)}).catch(i=>{w(i),g(i)})}catch(i){g(i)}})}async postAsGet(e,t,n,a,s,l){let r={};return r.select=t??["id"],a?.sortOrder&&a?.sortColumn&&(r.sortColumn=a.sortColumn,r.sortOrder=a.sortOrder),r.PageNumber=s+1,r.pageSize=l??10,r={...r,...n},new Promise((h,g)=>{if(e)try{f.post(c+e,r,d).then(i=>{h(i)}).catch(i=>{w(i),i.response?g({message:"Request failed for "+e,status:i.response.status,data:i.response.data}):i.request?g({message:"No response from server for "+e,error:i.message}):g({message:"Request setup error for "+e,error:i.message})})}catch(i){g(i)}})}async blob(e,t){return new Promise((n,a)=>{if(e)try{f.get(c+e,t,{...d,responseType:"blob"}).then(s=>{n(s)}).catch(s=>{w(s),a(s)})}catch(s){a(s)}})}post(e,t){return new Promise((n,a)=>{if(e)try{return f.post(c+e,t,{...d}).then(s=>{n(s)}).catch(s=>{w(s),a(s)})}catch(s){a(s)}})}upload(e,t){return new Promise((n,a)=>{if(e)try{return f.post(c+e,t,{...d,headers:{...d.headers,"Content-Type":"multipart/form-data"}}).then(s=>{n(s)}).catch(s=>{w(s),a(s)})}catch(s){a(s)}})}put(e,t){return new Promise((n,a)=>{if(e)try{return f.put(c+e,t,d).then(s=>{n(s)}).catch(s=>{w(s),a(s)})}catch(s){a(s)}})}remove(e,t){return new Promise((n,a)=>{if(e)try{return f.delete(c+e,{...d,data:t}).then(s=>{n(s)}).catch(s=>{w(s),a(s)})}catch(s){a(s)}})}}new u;const{getWithHeader:q}=new u,{get:R}=new u,{blob:$}=new u,{getAsync:N}=new u,{post:H}=new u,{postAsGet:J}=new u,{upload:z}=new u,{put:A}=new u,{remove:F}=new u,U=c;export{U as a,J as b,H as p,F as r,S as t,z as u};
