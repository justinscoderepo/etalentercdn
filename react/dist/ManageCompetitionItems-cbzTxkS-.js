import{r as s,m as P,B as b,z as n,p as C,j as e,L as w,i as V}from"./main-DCc2ikXz.js";import{B as A}from"./box-DDyjqKnX.js";import{F as D}from"./XMarkIcon-DJpQkd19.js";import{F as $}from"./PlusIcon-Dc1sfajn.js";import{F as B}from"./TableCellsIcon-DbO2pUXA.js";import{F as j}from"./TrophyIcon-Dcb_O_1j.js";import{F as z}from"./StarIcon-By-TKSNW.js";import{F as J}from"./PencilSquareIcon-BXLkxWBm.js";import{F as G}from"./TrashIcon-CNBjNUBY.js";function H({title:a,titleId:c,...o},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":c},o),a?s.createElement("title",{id:c},a):null,s.createElement("path",{d:"M9.375 3a1.875 1.875 0 0 0 0 3.75h1.875v4.5H3.375A1.875 1.875 0 0 1 1.5 9.375v-.75c0-1.036.84-1.875 1.875-1.875h3.193A3.375 3.375 0 0 1 12 2.753a3.375 3.375 0 0 1 5.432 3.997h3.943c1.035 0 1.875.84 1.875 1.875v.75c0 1.036-.84 1.875-1.875 1.875H12.75v-4.5h1.875a1.875 1.875 0 1 0-1.875-1.875V6.75h-1.5V4.875C11.25 3.839 10.41 3 9.375 3ZM11.25 12.75H3v6.75a2.25 2.25 0 0 0 2.25 2.25h6v-9ZM12.75 12.75v9h6.75a2.25 2.25 0 0 0 2.25-2.25v-6.75h-9Z"}))}const O=s.forwardRef(H);function ee(){const{eventDetails:a}=P(),[c,o]=s.useState(!1),[d,y]=s.useState([]),[N,S]=s.useState([]),[F,k]=s.useState([]),[x,f]=s.useState(!1),[u,v]=s.useState(null),[i,p]=s.useState({Title:"",Category:"",ScoreLabel:""});s.useEffect(()=>{m(),E(),I()},[a]);const m=s.useCallback(async()=>{if(a?.EventCategory){o(!0);try{const t=await b("/CompetitionItemsJson/Get",{EventCategory:a.EventCategory,PageSize:1e3});t&&t.Results&&(y(t.Results),t.Results.length===0&&f(!0))}catch(t){console.error("Error loading competitions:",t),n.error("Failed to load competitions")}finally{o(!1)}}},[a]),E=s.useCallback(async()=>{try{const t=await b("/CompetitionCategoriesJson/Get",{PageSize:1e3});t&&t.Results&&S(t.Results)}catch(t){console.error("Error loading categories:",t)}},[]),I=s.useCallback(async()=>{try{const t=await b("/ScoreLabelJson/Get",{PageSize:1e3});t&&t.Results&&k(t.Results)}catch(t){console.error("Error loading scoring methods:",t)}},[]),h=s.useCallback(()=>{p({Title:"",Category:"",ScoreLabel:""}),v(null),f(!1)},[]),g=s.useCallback((t,r)=>{p(l=>({...l,[t]:r}))},[]),R=s.useCallback(async()=>{if(!i.Title.trim()){n.error("Competition Title is required");return}if(!i.Category){n.error("Competition Type is required");return}if(!i.ScoreLabel){n.error("Scoring Method is required");return}o(!0);try{const t={...i,CompetitionId:u,EventCategory:a?.EventCategory},r=await C("/CompetitionItemsJson/Save",t);if(r&&r.success!==!1)n.success(u?"Competition updated successfully":"Competition saved successfully"),h(),await m();else throw new Error(r?.message||"Failed to save competition")}catch(t){console.error("Error saving competition:",t),n.error(t.message||"Failed to save competition")}finally{o(!1)}},[i,u,a,h,m]),L=s.useCallback(t=>{p({Title:t.Title||"",Category:t.Category||"",ScoreLabel:t.ScoreLabel||""}),v(t.CompetitionId),f(!0)},[]),T=s.useCallback(async t=>{if(window.confirm("Are you sure you want to delete this competition?")){o(!0);try{const r=await C("/CompetitionItemsJson/Remove",{CompetitionId:t});if(r&&r.success!==!1)n.success("Competition deleted successfully"),await m();else throw new Error(r?.message||"Failed to delete competition")}catch(r){console.error("Error deleting competition:",r),n.error(r.message||"Failed to delete competition")}finally{o(!1)}}},[m]),M=s.useCallback(async t=>{const r=t.Status===2?1:2;o(!0);try{const l=await C("/CompetitionItemsJson/Save",{...t,Status:r});if(l&&l.success!==!1)n.success(`Competition ${r===2?"activated":"deactivated"} successfully`),await m();else throw new Error(l?.message||"Failed to update competition status")}catch(l){console.error("Error updating competition status:",l),n.error(l.message||"Failed to update competition status")}finally{o(!1)}},[m]);return c&&d.length===0?e.jsx(w,{}):e.jsx(A,{heading:"Competition Categories Setup",description:"Define competition items like Dance, Music, Speech, etc. with appropriate scoring methods",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx("button",{onClick:()=>f(!x),className:V("inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-200",x?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Hide Form"]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"New Competition"]})})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("a",{href:`/CompetitionItems/Manage/${a?.EventCategory||""}/null`,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-amber-600 hover:bg-amber-700 rounded-lg transition-colors duration-200",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Table View"]})})]}),x&&e.jsxs("div",{className:"bg-surfaceCard rounded-lg p-6 border-2 border-dashed border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-onSurface mb-4 flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2 text-blue-600"}),u?"Edit Competition Item":"Add New Competition Item"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Competition Title *"}),e.jsx("input",{type:"text",value:i.Title,onChange:t=>g("Title",t.target.value),placeholder:"e.g., Song, Dance, Speech",className:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Competition Type *"}),e.jsxs("select",{value:i.Category,onChange:t=>g("Category",t.target.value),className:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Please Select"}),N.map(t=>e.jsx("option",{value:t.ProgramCategoryId,children:t.CategoryName},t.ProgramCategoryId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Scoring Method *"}),e.jsxs("select",{value:i.ScoreLabel,onChange:t=>g("ScoreLabel",t.target.value),className:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Please Select"}),F.map(t=>e.jsx("option",{value:t.LabelId,children:t.Label},t.LabelId))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-onSurfaceVariant bg-surfaceVariant hover:bg-surfaceCard rounded-lg transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:c,className:"px-6 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors duration-200 disabled:opacity-50",children:c?"Saving...":u?"Update Competition":"Save Competition"})]})]}),e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsxs("div",{className:"text-center py-8 bg-surfaceCard rounded-lg border-2 border-dashed border-border",children:[e.jsx(j,{className:"w-12 h-12 text-onSurfaceVariant mx-auto mb-4"}),e.jsx("p",{className:"text-onSurfaceVariant mb-2",children:"No competition items found"}),e.jsx("p",{className:"text-sm text-onSurfaceVariant",children:"Please add new competition items to get started"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(t=>e.jsxs("div",{className:"bg-contentBgOuter border border-border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 flex items-center mb-1",children:[e.jsx(O,{className:"w-5 h-5 mr-2 text-blue-600"}),t.Title]})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.Status===2,onChange:()=>M(t),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-surfaceVariant peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-contentBgOuter after:border-border after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(j,{className:"w-4 h-4 mr-2 text-sky-500"}),e.jsx("span",{className:"text-onSurfaceVariant",children:"Type:"}),e.jsx("span",{className:"ml-1 font-medium text-onSurface",children:t.CategoryCategoryName||"Not specified"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(z,{className:"w-4 h-4 mr-2 text-yellow-500"}),e.jsx("span",{className:"text-onSurfaceVariant",children:"Scoring:"}),e.jsx("span",{className:"ml-1 font-medium text-onSurface",children:t.ScoreLabelLabel||"Not specified"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs("button",{onClick:()=>L(t),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-green-700 bg-green-100 hover:bg-green-200 rounded transition-colors duration-200",children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsxs("button",{onClick:()=>T(t.CompetitionId),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-red-700 bg-red-100 hover:bg-red-200 rounded transition-colors duration-200",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},t.CompetitionId))})}),d.length>0&&e.jsxs("div",{className:"bg-surface border border-primary/20 rounded-lg p-4",children:[e.jsx("h4",{className:"text-blue-900 font-medium mb-2",children:"What's next?"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("li",{children:["•"," ",e.jsx("a",{href:"/CompetitionStructure/Tab",className:"underline hover:text-blue-600",children:"Assign Competition Items to Age Groups?"})]}),e.jsxs("li",{children:["•"," ",e.jsx("a",{href:"/SetUp/ScoreSettings",className:"underline hover:text-blue-600",children:"Configure Scoring Criteria & Points?"})]}),e.jsxs("li",{children:["•"," ",e.jsx("a",{href:"/Coordinator/ManageBulkParticipants",className:"underline hover:text-blue-600",children:"Add Participants to Competitions?"})]})]})]}),c&&d.length>0&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-contentBgOuter rounded-lg p-6 shadow-lg",children:e.jsx(w,{})})})]})})}export{ee as default};
