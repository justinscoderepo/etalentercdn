import{r as s,p as B,j as e,L as $}from"./mainweb-DhuO4ZrS.js";import{B as Z}from"./box-VQywxxQq.js";import{u as G}from"./useConfirmation-DiTaq2gh.js";import{c as T}from"./utilities-CN4lTu6a.js";import{u as H}from"./index.esm-DgiYVniw.js";import{R as K,F as q}from"./renderComponents-CYT1iE1x.js";import{M as z}from"./modalForm-p3C-8UN7.js";import{F as Y}from"./XCircleIcon-CexlA4GU.js";import{P as _}from"./pagination-DLyB9Whr.js";import{F as Q}from"./ShareIcon-B21C50sR.js";import{F as W}from"./TrashIcon-CpDW2K7G.js";import{u as X}from"./useBackend-Bxgw_fm2.js";import"./dialog-DYKZCgVZ.js";import"./computeTotalAmount-CK2ylyvS.js";import"./validationMessage-CkO9UyJo.js";import"./clsx-B-dksMZM.js";import"./manageTeamParticipants-CwZtH28W.js";import"./httpService-COnKFhc_.js";import"./index-BtuGy7By.js";import"./XMarkIcon-CBGtbHnO.js";function ee({title:a,titleId:n,...p},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":n},p),a?s.createElement("title",{id:n},a):null,s.createElement("path",{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75Zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const te=s.forwardRef(ee);function le({title:a,titleId:n,...p},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":n},p),a?s.createElement("title",{id:n},a):null,s.createElement("path",{fillRule:"evenodd",d:"M3.74 3.749a.75.75 0 0 1 .75.75V15h13.938l-2.47-2.47a.75.75 0 0 1 1.061-1.06l3.75 3.75a.75.75 0 0 1 0 1.06l-3.75 3.75a.75.75 0 0 1-1.06-1.06l2.47-2.47H3.738a.75.75 0 0 1-.75-.75V4.5a.75.75 0 0 1 .75-.751Z",clipRule:"evenodd"}))}const ae=s.forwardRef(le);function se({title:a,titleId:n,...p},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":n},p),a?s.createElement("title",{id:n},a):null,s.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const ne=s.forwardRef(se);function re({title:a,titleId:n,...p},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":n},p),a?s.createElement("title",{id:n},a):null,s.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const oe=s.forwardRef(re),ie=({row:a,fields:n,onSave:p,onCancel:d,title:f,description:P})=>{const[r,c]=s.useState(a||{});for(let o in r)if(o.indexOf("JsonSettings")>-1&&o.indexOf(".")==-1)try{let i=B(r[o]);if(i)for(let x in i)r[o+"Object."+x]=i[x]}catch(i){console.error("Error parsing JSON:",i)}const[v,N]=s.useState(!1),[C,u]=s.useState("");let j=n;const{handleSubmit:A,register:E,unregister:b,control:R,clearErrors:O,reset:k,watch:y,getValues:I,setValue:h,trigger:M,formState:{errors:S}}=H({defaultValues:{...a}});s.useEffect(()=>{a&&(Object.keys(a).forEach(o=>{b(o),h(o,a[o])}),c({...a}))},[a]);const L=async o=>{N(!0),window.scrollTo({top:0,behavior:"smooth"});let i=x=>{u(x)};try{await p(o,!1,!0,i)}catch(x){console.error("Error saving user:",x)}N(!1)},J=(o,i)=>{if(console.log("handlePropertiesChange",o,i),h(o,i),a&&(a[o]=i),o.indexOf("JsonSettingsObject")>-1){let t=o.split("Object.")[1],m=o.split("Object.")[0];var x=a[m],w=B(x);let l={[t]:i};w={...w,...l},a[m]=JSON.stringify(w),h(m,JSON.stringify(w))}c({...a})};let U=[...j];return r&&(j==null?void 0:j.length)>0&&(U=U.filter(o=>{var x;let i=(x=o.conditions)==null?void 0:x.filter(w=>w.key);return(i==null?void 0:i.length)>0?!!i.find(t=>{if(t.key){let m=t.key.charAt(0).toLowerCase()+t.key.slice(1),l=r[t.key]||r[m];if(l&&(l==null?void 0:l.toString())==t.value)return!0}}):!0})),console.log({filteredComponents:U}),e.jsx(z,{title:f,description:P,open:!0,center:!1,outerClass:"max-w-xl",setOpen:d,children:e.jsxs("div",{className:"flex-auto p-2 relative",children:[v&&e.jsx($,{info:C}),e.jsxs("form",{onSubmit:A(L),children:[e.jsx(K,{handlePropertiesChange:J,handlePropertiesPanelChange:()=>{console.log("handlePropertiesPanelChange")},formData:r,isPlayGround:!1,onChangeValue:J,drop:null,isSubmitted:v,isOver:!1,eventDetails:{},components:U,selectedComponent:{},handleSelect:()=>{console.log("handleSelect")},register:E,getValues:I,errors:S,control:R,setValue:h,clearErrors:O,reset:k,watch:y,removeComponent:()=>{console.log("removeComponent")}}),!v&&e.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:d,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[e.jsx(Y,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[e.jsx(ne,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})},me=({status:a,formTitle:n,defaultFormValues:p,formDescription:d,rows:f=[],formFields:P=[],pageDetails:r={},fields:c=[],topActions:v=[],actions:N=[],setOffsetAndLimit:C=()=>{},searchFields:u=[],update:j=()=>{alert("Not Implemented")},delete:A=()=>{alert("Not Implemented")}})=>{console.log({rows:f});const[E,b]=G(),[R,O]=s.useState(()=>{const t={};return u==null||u.forEach(m=>{t[m.columnName]=""}),t}),[k,y]=s.useState(!1),[I,h]=s.useState(!1),[M,S]=s.useState(null),L=(t,m)=>{O(l=>({...l,[t]:m}))},J=()=>{console.log("Search Values:",R)},U=async t=>{y(!0),await A(t),y(!1)},o=t=>{S(t),h(!0),y(!0)},i=async t=>{await j(t),y(!1),h(!1),S(null)},x=()=>{y(!1),h(!1),S(null)},w=()=>e.jsx("div",{className:"min-h-5 w-full relative",children:e.jsx("div",{className:"relative right-0 md:-top-10",children:v.length>0&&e.jsx("div",{className:"flex justify-end items-end gap-x-2 gap-y-2",children:v.map((t,m)=>e.jsx("div",{className:"bg-white rounded-full shadow-sm p-2",children:e.jsxs("button",{className:T("font-medium text-sm py-2 px-2 rounded-3xl flex items-center justify-center shadow-sm",t.label?"px-3":"h-8 w-8",t.type==="new"?"bg-indigo-600 text-white":t.type==="export"?"bg-green-700 text-white":t.type==="custom"?"bg-gray-700 text-white":""),onClick:()=>{t.type==="new"?h(!0):t.type==="export"?console.log("Export"):t.type==="custom"&&(console.log("Custom Action"),t.callback&&t.callback())},children:[t.type==="new"&&e.jsx(q,{className:"h-5 w-5 text-white"}),t.type==="export"&&e.jsx(te,{className:"h-5 w-5 text-white"}),t.type==="custom"&&e.jsxs(e.Fragment,{children:[t.icon,e.jsx("span",{className:"ml-2",children:t.label})]})]},m)}))})})});return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Delete Item",description:"Are you sure you want to delete this item?",confirmButtonLabel:"Delete",confirmButtonClick:async t=>U(t),className:"w-96 print:hidden"}),e.jsxs("div",{className:"",children:[(u==null?void 0:u.length)>0&&e.jsxs("div",{className:"mb-0 flex flex-row justify-end gap-x-2 gap-y-2",children:[u==null?void 0:u.map((t,m)=>e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"absolute -top-2 left-2 inline-block rounded-lg bg-white px-1 text-xs font-medium text-gray-900",children:["Search By ",t.label]}),t.type==="text"&&e.jsx("input",{type:"text",placeholder:"Enter "+(t.placeholder||t.label),value:R[t.columnName],onChange:l=>L(t.columnName,l.target.value),className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900   placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 border-gray-300 focus:outline-gray-50 sm:text-sm/6"}),t.type==="select"&&e.jsx("select",{value:R[t.columnName],onChange:l=>L(t.columnName,l.target.value),className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900  placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-darkprimary sm:text-sm/6",children:t.options.map((l,g)=>e.jsx("option",{value:l.value,children:l.label},g))})]},m)),e.jsx("button",{type:"button",onClick:J,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-darkprimary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-darkprimary",children:"Search"})]}),e.jsx("div",{className:"relative mt-12",children:e.jsxs("table",{className:"min-w-full md:divide-y md:divide-gray-300 flex flex-col md:table ",children:[(c==null?void 0:c.length)>0&&e.jsx("thead",{className:"flex flex-grow md:table-header-group ",children:e.jsxs("tr",{className:"md:bg-gray-200 flex md:table-row flex-grow justify-end",children:[c.map((t,m)=>e.jsx("th",{className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-3 hidden md:table-cell",children:t.label},m)),e.jsx("th",{children:e.jsx(w,{})})]})}),(f==null?void 0:f.length)>0&&e.jsx("tbody",{className:"md:divide-y md:divide-gray-200 flex flex-grow md:table-row-group flex-col gap-y-3",children:f.map((t,m)=>{for(let l in t)if(l.indexOf("JsonSettings")>-1&&l.indexOf(".")==-1)try{let g=B(t[l]);if(g)for(let F in g)t[l+"Object."+F]=g[F],console.log({row:t})}catch(g){console.error("Error parsing JSON:",g)}return e.jsxs("tr",{className:"flex md:table-row flex-col py-4 md:py-0 px-4 md:px-0 shadow-md md:shadow-none",children:[c==null?void 0:c.map((l,g)=>e.jsxs("td",{className:"whitespace-nowrap md:px-3 py-2 md:py-4 text-sm text-gray-500 flex flex-row justify-between md:table-cell",children:[e.jsx("span",{className:"md:hidden font-semibold text-gray-900",children:l.label}),l.asOptionList?e.jsx("ul",{className:"list-disc mr-2 ml-3",children:t[l.column]&&t[l.column].length>0?t[l.column].map((F,D)=>e.jsx("li",{className:"text-gray-700 font-normal text-xs",children:F.label},D)):e.jsx("span",{className:"text-gray-900 font-semibold",children:"-"})}):e.jsx("span",{className:"",children:t[l.column]})]},g)),N.length>0&&e.jsx("td",{className:"whitespace-nowrap text-sm font-medium mt-3 md:mt-0",children:e.jsx("div",{className:"flex justify-end gap-x-2 gap-y-2",children:N.map((l,g)=>e.jsxs("button",{title:l.label,className:T("h-8 w-8 font-semibold py-2 px-2 rounded-3xl flex items-center justify-center",l.type==="whatsapp"?"bg-green-700 text-white":l.type==="edit"?"bg-primary text-white":l.type==="delete"?"bg-red-800 text-white":""),onClick:()=>{l.type==="whatsapp"?l.callback&&l.callback(t):l.type==="edit"?o(t):l.type==="delete"&&b(t)},children:[l.type==="whatsapp"&&e.jsx(Q,{className:"h-5 w-5 text-white"}),l.type==="edit"&&e.jsx(oe,{className:"h-4 w-4 text-white"}),l.type==="delete"&&e.jsx(W,{className:"h-5 w-5 text-white"})]},g))})})]},m)})}),(f==null?void 0:f.length)===0&&a!="finished"&&e.jsx("tbody",{className:"bg-white flex justify-center",children:e.jsx("tr",{className:"flex justify-center",children:e.jsx($,{})})})]})}),r&&e.jsx(_,{rowsFrom:r==null?void 0:r.rowsFrom,rowsTo:r==null?void 0:r.rowsTo,totalRowCount:r==null?void 0:r.totalRowCount,setOffsetAndLimit:C}),I&&e.jsx(ie,{description:d,title:n,row:M||p,fields:P,onSave:i,onCancel:x})]})]})};let V={SuperAdmin:{RoleId:1,Role:"SuperAdmin"},Candidate:{RoleId:2,Role:"Candidate"},Organizer:{RoleId:3,Role:"Organizer"},Manager:{RoleId:4,Role:"Manager"},Coordinator:{RoleId:5,Role:"Coordinator"},Judge:{RoleId:6,Role:"Judge"},Guest:{RoleId:7,Role:"Guest"},SubCoordinator:{RoleId:8,Role:"SubCoordinator"},Projector:{RoleId:9,Role:"Projector"},SubAdmin:{RoleId:10,Role:"SubAdmin"},ContentAdmin:{RoleId:11,Role:"ContentAdmin"},User:{RoleId:12,Role:"User"},DrawMaster:{RoleId:13,Role:"DrawMaster"},ScoreMaster:{RoleId:14,Role:"ScoreMaster"},Guardian:{RoleId:15,Role:"Guardian"}};function Oe({user:a,operation:n,eventCategory:p,eventId:d}){var E;const[f,P]=s.useState(!1),r=X("/UsersRolesPlusUsersJson/Get",{filter:{Event:d,Role:V[n].RoleId,CreatedBy:a.UId,Status:"1"},updateUrl:"/SetupJson/SaveUser",deleteUrl:"/SetupJson/RemoveCoordinator",limit:10,sort:{sortOrder:"DESC",sortColumn:"UserRoleId"},select:"Event,Role,SixDigitPassword,Status,User,UserEmail,UserEmailCode,UserName,UserNameCode,UserRoleId,JsonSettings"});let{rows:c,update:v}=r;const N=({UserName:b,UserEmail:R,SixDigitPassword:O})=>{let k=window.location.origin,y=btoa(b),I=btoa(R),h=btoa(d),M=encodeURIComponent(R);const S=`https://api.whatsapp.com/send?text=Hi%20${b},%0AYour%20login%20details%20are:%0A%0AUserName%3A%20${M}%0A🔑Password%3A%20${O}%0APlease%20follow%20the%20following%20link%20to%20login:%0A${k}%2FAccount%2FLogin%3FeventId%3D${h}%26name%3D${y}%26Email%3D${I}`;window.open(S,"_blank")};var C=[{type:"new",title:"New"}];let u={Event:d,Role:V[n].RoleId,RoleRole:V[n].Role,Status:"1",CreatedBy:a.UId};(E=c==null?void 0:c.filter(b=>b.UserEmail==a.Email))!=null&&E.length||C.push({type:"custom",callback:()=>v({...u,UserName:a.Name,UserEmail:a.Email}),icon:e.jsx(ae,{className:"h-5 w-5"}),label:"Create Yourself as "+n,onClick:()=>handleAddUser({UserName:a.Name,UserEmail:a.Email})});let j=[{label:"Name",column:"UserName"},{label:"Email",column:"UserEmail"},{label:"Accessible Sections",column:"JsonSettingsObject.AccessibleSections",asOptionList:!0}],A=[{name:"UserName",label:"Name",type:"text",validate:{required:!0,minLength:3,maxLength:50}},{name:"UserEmail",label:"Email",type:"text",validate:{required:!0,email:!0}},{name:"JsonSettingsObject.AccessibleSections",label:"Accessible Sections",type:"select",multiple:!0,options:[{text:"All",value:"All"},{text:"Event SetUp",value:"EventSetup"},{text:"Candidate Edit & Approve",value:"CandidateEditApprove"},{text:"Advanced Event Configurations",value:"AdvancedEventSetup"},{text:"Bulk Participants Management",value:"BulkParticipants"},{text:"Users Roles Management",value:"UsersRoles"},{text:"Print and Download",value:"PrintAndDownload"},{text:"Score Management",value:"ScoreManagement"},{text:"Draw Management",value:"DrawManagement"},{text:"Time Management",value:"TimeManagement"},{text:"Result Printing",value:"ResultPrinting"},{text:"Publish Results",value:"PublishResults"},{text:"Certificate Printing",value:"CertificatePrinting"},{text:"Unit Management",value:"UnitManagement"}],validate:{required:!0,email:!0}}];return e.jsx(Z,{heading:"Manage User Roles - "+n,childrenClasses:"px-0 py-2",headingClasses:"px-3",outerClasses:"max-w-full mx-auto ml-5 bg-gray-50 print:hidden ",children:e.jsxs("div",{className:"",children:[f&&e.jsx($,{}),e.jsx(me,{...r,defaultFormValues:u,formTitle:"Manage User Roles - "+n,formDescription:"You can create new "+n+" by enter name and email",topActions:C,fields:j,searchFields:[{label:"Name",type:"text",column:"UserName"}],formFields:A,actions:[{type:"whatsapp",icon:"fa-share",callback:b=>N(b)},{type:"delete",icon:"fa-trash"}]})]})})}export{Oe as default};
