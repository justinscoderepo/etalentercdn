import{a as O}from"./index-BtuGy7By.js";import{u as b,_ as w}from"./mainweb-zSUhtIwQ.js";let m=new Date,y=1;function S(...n){if((new Date().getTime()-m.getTime())/1e3>10&&(console.info(`%c===========================================

                Session ${y}

===========================================`,"color: white; font-style: italic; font-weight:bold; font-size:14px"),y++,m=new Date),n.length>0)try{if(localStorage.getItem("development")){console.info("%c"+n[0],"color: orange; font-style: italic; font-weight:bold; font-size:14px");let a=n.reduce(function(o,s,l){return l!=0?typeof s=="object"?Object.assign(o,s):Object.assign(o,{[l-1]:s}):o},{});console.info(a)}}catch{}}let c=window.location.origin;window.location.href.indexOf("localhost")==-1?c="https://etalenterapi.azurewebsites.net":c="http://localhost:8888";const d={headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest"}};console.log("apiRoot"+c);const f=O.create({baseURL:c}),k=n=>{if(n.headers.Platform="Web",localStorage.user&&n.url.indexOf("login")==-1){let{token:e,refreshToken:t}=b();e&&(n.headers.Authorization=`Bearer ${e}`),t&&(n.headers.RefreshToken=t)}return n},C=n=>{if(S("responseFailed",n),n&&n.response&&n.response.data&&n.response.data.statusCode===401){var e=window.location.search.replace("?","").split("&"),t=e.filter(o=>o.toLowerCase().indexOf("dataset=")!=-1);if(t&&t.length>0){var a=t[0].split("=")[1];a&&(localStorage.clear(),window.location.href=""+window.location.href)}if(localStorage.userData){let{roleId:o}=JSON.parse(localStorage.userData).user;o==5&&(localStorage.clear(),window.location.href=""+window.location.href)}return localStorage.clear(),window.location.href="#logout",Promise.reject({...n})}return n.request&&n.request.status&&(n.request.status==="400"||n.request.status==="404")?Promise.reject({...n}):Promise.reject({...n})},D=n=>{if(localStorage.userData){let e=JSON.parse(localStorage.userData),{accesstoken:t,refreshtoken:a}=n.headers;t!=null&&a!==null&&t!==e.accessToken&&a!==e.refreshToken&&(e.accessToken=t,e.refreshToken=a,localStorage.removeItem("userData"),localStorage.setItem("userData",JSON.stringify(e)))}return n};function h(n){if(S("errorHandler",n),n){let{response:e}=n,{data:t}=e||{};if(n&&n.isAxiosError&&!e)w.error("Network Issue or Server Down",{autoClose:3e3,toastId:"network"});else if(e&&e.status==401&&t.message&&typeof t.message=="string")w.error(t.message,{autoClose:3e3,toastId:"network"});else if(e&&e.status==401)w.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"});else if(t&&e.status&&e.status==400&&t.SecurityValidations&&t.SecurityValidations.length>0){let a=t.SecurityValidations[0];w.error(a,{autoClose:3e3,toastId:"network"})}else t&&t.statusCode&&t.statusCode==400&&t.message&&typeof t.message=="string"?w.error(t.message,{autoClose:3e3,toastId:"network"}):t&&t.statusCode&&t.statusCode==400&&t.message?w.error(t.message,{autoClose:3e3,toastId:"network"}):w.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"})}}function P(n,e,t){if(e){n+="?";let a=[],o=["query","createUrl","filter"];for(const l in e)if(Object.hasOwnProperty.call(e,l)){let r=e[l];o.indexOf(l.toString())===-1&&r!=null&&a.push(`${l}=${r.toString()}`)}let s=[];for(const l in t)if(Object.hasOwnProperty.call(t,l)){let r=t[l];typeof r=="string"?s.push(`${l}=${r}`):s.push(`${l}=${r}`)}return s.length&&a.push(`${s.join("&")}`),n+=a.join("&"),n}return n}class u{constructor(){f.interceptors.request.handlers.length===0&&(f.interceptors.request.use(e=>k(e)),f.interceptors.response.use(e=>D(e),e=>C(e)))}getWithHeader(e,t){if(e)return f.get(c+e,t,d)}async get(e,t,a,o,s,l){let r={};return r.select=t??["id"],o!=null&&o.sortOrder&&(o!=null&&o.sortField)&&(r.sortField=o.sortField,r.sortOrder=o.sortOrder),r.filter=a,r.page=s+1,r.take=l??10,e=P(e,r,a),new Promise((p,g)=>{if(e)try{f.get(c+e,d).then(i=>{p(i)}).catch(i=>{h(i),g(i)})}catch(i){g(i)}})}async postAsGet(e,t,a,o,s,l){let r={};return r.select=t??["id"],o!=null&&o.sortOrder&&(o!=null&&o.sortColumn)&&(r.sortColumn=o.sortColumn,r.sortOrder=o.sortOrder),r.PageNumber=s+1,r.pageSize=l??10,r={...r,...a},new Promise((p,g)=>{if(e)try{f.post(c+e,r,d).then(i=>{p(i)}).catch(i=>{h(i),i.response?g({message:"Request failed for "+e,status:i.response.status,data:i.response.data}):i.request?g({message:"No response from server for "+e,error:i.message}):g({message:"Request setup error for "+e,error:i.message})})}catch(i){g(i)}})}async blob(e,t){return new Promise((a,o)=>{if(e)try{f.get(c+e,t,{...d,responseType:"blob"}).then(s=>{a(s)}).catch(s=>{h(s),o(s)})}catch(s){o(s)}})}post(e,t){return new Promise((a,o)=>{if(e)try{return f.post(c+e,t,{...d}).then(s=>{a(s)}).catch(s=>{h(s),o(s)})}catch(s){o(s)}})}upload(e,t){return new Promise((a,o)=>{if(e)try{return f.post(c+e,t,{...d,headers:{...d.headers,"Content-Type":"multipart/form-data"}}).then(s=>{a(s)}).catch(s=>{h(s),o(s)})}catch(s){o(s)}})}put(e,t){return new Promise((a,o)=>{if(e)try{return f.put(c+e,t,d).then(s=>{a(s)}).catch(s=>{h(s),o(s)})}catch(s){o(s)}})}remove(e,t){return new Promise((a,o)=>{if(e)try{return f.delete(c+e,{...d,data:t}).then(s=>{a(s)}).catch(s=>{h(s),o(s)})}catch(s){o(s)}})}}new u;const{getWithHeader:T}=new u,{get:x}=new u,{blob:q}=new u,{getAsync:R}=new u,{post:$}=new u,{postAsGet:N}=new u,{upload:H}=new u,{put:z}=new u,{remove:A}=new u,F=c;export{N as a,F as b,$ as p,A as r,S as t,H as u};
