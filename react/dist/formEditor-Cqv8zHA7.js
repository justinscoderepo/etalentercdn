import{r as l,p as j,j as r,L as K}from"./mainweb-ClA2V5qH.js";import{u as k}from"./index.esm-Bn7PPwQM.js";import{RenderComponents as Z}from"./renderComponents-C8EXYi53.js";import z from"./modalForm-xMoCiyVZ.js";import{F as A}from"./XCircleIcon-BrdwqeCx.js";import"./dialog-CbB4C2LL.js";import"./XMarkIcon-C9IAwIz-.js";function B({title:s,titleId:f,...h},m){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":f},h),s?l.createElement("title",{id:f},s):null,l.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const G=l.forwardRef(B),X=({row:s,fields:f,onSave:h,onCancel:m,title:S,description:C})=>{const[i,b]=l.useState(s||{});for(let e in i)if(e.indexOf("JsonSettings")>-1&&e.indexOf(".")==-1)try{let t=j(i[e]);if(t)for(let o in t)i[e+"Object."+o]=t[o]}catch(t){console.error("Error parsing JSON:",t)}const[x,v]=l.useState(!1),[O,E]=l.useState("");let d=f;const{handleSubmit:w,register:N,unregister:F,control:P,clearErrors:L,reset:R,watch:J,getValues:V,setValue:p,trigger:H,formState:{errors:M}}=k({defaultValues:{...s}});l.useEffect(()=>{s&&(Object.keys(s).forEach(e=>{F(e),p(e,s[e])}),b({...s}))},[s]);const D=async e=>{v(!0),window.scrollTo({top:0,behavior:"smooth"});let t=o=>{E(o)};try{await h(e,!1,!0,t)}catch(o){console.error("Error saving user:",o)}v(!1)},y=(e,t)=>{if(console.log("handlePropertiesChange",e,t),p(e,t),s&&(s[e]=t),e.indexOf("JsonSettingsObject")>-1){let a=e.split("Object.")[1],c=e.split("Object.")[0];var o=s[c],n=j(o);let u={[a]:t};n={...n,...u},s[c]=JSON.stringify(n),p(c,JSON.stringify(n))}b({...s})};let g=[...d];return i&&(d==null?void 0:d.length)>0&&(g=g.filter(e=>{var o;let t=(o=e.conditions)==null?void 0:o.filter(n=>n.key);return(t==null?void 0:t.length)>0?!!t.find(a=>{if(a.key){let c=a.key.charAt(0).toLowerCase()+a.key.slice(1),u=i[a.key]||i[c];if(u&&(u==null?void 0:u.toString())==a.value)return!0}}):!0})),console.log({filteredComponents:g}),r.jsx(z,{title:S,description:C,open:!0,center:!1,outerClass:"max-w-xl",setOpen:m,children:r.jsxs("div",{className:"flex-auto p-2 relative",children:[x&&r.jsx(K,{info:O}),r.jsxs("form",{onSubmit:w(D),children:[r.jsx(Z,{handlePropertiesChange:y,handlePropertiesPanelChange:()=>{console.log("handlePropertiesPanelChange")},formData:i,isPlayGround:!1,onChangeValue:y,drop:null,isSubmitted:x,isOver:!1,eventDetails:{},components:g,selectedComponent:{},handleSelect:()=>{console.log("handleSelect")},register:N,getValues:V,errors:M,control:P,setValue:p,clearErrors:L,reset:R,watch:J,removeComponent:()=>{console.log("removeComponent")}}),!x&&r.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:m,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(A,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(G,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})};export{X as default};
