import{r as s,j as o,k as v,z as N,_ as C}from"./main-C93JHIOS.js";import{s as E,w as A,i as S,u as T,a as b,d as _,b as k,c as H}from"./useDragDropManager-BvIejz3s.js";import{i as D}from"./index-7Q1QPhit.js";import{v as F}from"./v4-BKT09osN.js";function P({title:r,titleId:e,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},t),r?s.createElement("title",{id:e},r):null,s.createElement("path",{fillRule:"evenodd",d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z",clipRule:"evenodd"}),s.createElement("path",{fillRule:"evenodd",d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375Zm9.586 4.594a.75.75 0 0 0-1.172-.938l-2.476 3.096-.908-.907a.75.75 0 0 0-1.06 1.06l1.5 1.5a.75.75 0 0 0 1.116-.062l3-3.75Z",clipRule:"evenodd"}))}const V=s.forwardRef(P);function Z({title:r,titleId:e,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},t),r?s.createElement("title",{id:e},r):null,s.createElement("path",{d:"M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"}),s.createElement("path",{d:"M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"}))}const z=s.forwardRef(Z);let x=!1;class B{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;D(!x,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return x=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{x=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}class L{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;if(this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!E(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=A({dropTarget:(t,a)=>{this.clearDropTarget(),this.dropTargetOptions=a,S(t)?this.dropTargetRef=t:this.dropTargetNode=t,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function J(r){return s.useMemo(()=>r.hooks.dropTarget(),[r])}function q(r){const e=T(),t=s.useMemo(()=>new L(e.getBackend()),[e]);return b(()=>(t.dropTargetOptions=r||null,t.reconnect(),()=>t.disconnectDropTarget()),[r]),t}function G(){const r=T();return s.useMemo(()=>new B(r),[r])}function U(r){const{accept:e}=r;return s.useMemo(()=>(D(r.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class Y{canDrop(){const e=this.spec,t=this.monitor;return e.canDrop?e.canDrop(t.getItem(),t):!0}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function $(r,e){const t=s.useMemo(()=>new Y(r,e),[e]);return s.useEffect(()=>{t.spec=r},[r]),t}function K(r,e,t){const a=T(),c=$(r,e),l=U(r);b(function(){const[m,f]=_(l,c,a);return e.receiveHandlerId(m),t.receiveHandlerId(m),f},[a,e,c,t,l.map(u=>u.toString()).join("|")])}function Q(r,e){const t=k(r),a=G(),c=q(t.options);return K(t,a,c),[H(t.collect,a,c),J(c)]}const W=v.lazy(()=>C(()=>import("./formSubmission-CGRAFice.js"),[])),X=v.lazy(()=>C(()=>import("./sidebar-C-rKew9V.js"),[])),oe=({existingComponents:r,eventDetails:e,onChange:t,firstComponentId:a,currentActiveStep:c})=>{const[l,u]=s.useState([]),[m,f]=s.useState(null);s.useEffect(()=>{r?.length?u(r):u([])},[a]);const[{isOver:I},O]=Q({accept:"FORM_ITEM",drop:n=>w(n),collect:n=>({isOver:!!n.isOver()})}),h=n=>{u(n),t(n)},w=n=>{let p=n.label+" "+l.length,d=n.label.toLowerCase().replace(/ /g,"_")+"_"+l.length;switch(n.label){case"Registration Id":{d="RegistrationId";break}case"Organization/Unit Selection":{d="Organizations";break}}const i={...n,id:F(),label:p,name:d,class:"",options:[],conditions:[],validate:{}};i.index=l.length+1;let g=[...l,i];h(g),f(i)},M=n=>{let p=l.filter(d=>d.id!==n);p.forEach((d,i)=>{d.index=i+1}),h(p)},y=n=>{let d=l.map(i=>i.id===n.id?n:i).sort((i,g)=>i.index-g.index);d.forEach((i,g)=>{i.index=g+1}),h(d)};let j=n=>{navigator.clipboard.writeText(n)},R=n=>{let p=JSON.parse(n);h(p)};return o.jsx("div",{className:"flex flex-col grow",children:o.jsx("div",{className:"bg-gray-1",children:o.jsx("div",{className:"mx-auto",children:o.jsxs("div",{className:"flex gap-4 ",children:[o.jsxs("div",{className:"relative lg:row-span-2",children:[o.jsx("div",{className:"absolute inset-px rounded-lg bg-white lg:rounded-l-[1rem]"}),o.jsx("div",{className:"relative flex h-full flex-col overflow-hidden rounded-[calc(theme(borderRadius.md)+1px)] lg:rounded-l-[calc(1rem+1px)]",children:o.jsx(X,{currentActiveStep:c})}),o.jsx("div",{className:"pointer-events-none absolute inset-px rounded-lg shadow lg:rounded-l-[1rem]"})]}),o.jsxs("div",{className:"relative grow flex-1 mr-[290px]",children:[o.jsx("div",{className:"absolute inset-px rounded-lg bg-white max-lg:rounded-t-[1rem]"}),o.jsxs("div",{className:"relative flex h-full flex-col  rounded-[calc(theme(borderRadius.md)+1px)] max-lg:rounded-t-[calc(1rem+1px)]",children:[o.jsx("div",{className:"flex flex-col md:flex-row bg-gray-50 rounded-md p-4",children:o.jsxs("div",{className:"flex-1 flex space-x-1 justify-end",children:[o.jsxs("button",{type:"button",className:"bg-violet-950 rounded-md hover:bg-darkprimary text-white text-xs font-medium justify-items-center items-center py-2 px-4 flex space-x-1",onClick:()=>{j(JSON.stringify(l)),N.success("Form copied to clipboard")},children:[o.jsx(z,{className:"h-5 w-5"})," Copy"]}),o.jsxs("button",{type:"button",className:"bg-blue-900 rounded-md hover:bg-darkprimary text-white text-xs font-medium justify-items-center items-center py-2 px-4 flex space-x-1",onClick:()=>{navigator.clipboard.readText().then(n=>{R(n)})},children:[o.jsx(V,{className:"h-5 w-5"})," Paste"]})]})}),o.jsx(W,{eventDetails:e,isPlayGround:!0,drop:O,isOver:I,components:l,removeComponent:M,handlePropertiesPanelChange:y,setComponents:h,selectedComponent:m,setSelectedComponent:f})]}),o.jsx("div",{className:"pointer-events-none absolute inset-px rounded-lg shadow max-lg:rounded-t-[1rem]"})]})]})})})})};export{oe as default};
