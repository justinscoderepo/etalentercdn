import{r as d,p as y,j as r,L as M}from"./mainweb-ChkdoDLB.js";import{u as k}from"./index.esm-Dlri1keI.js";import{RenderComponents as z}from"./renderComponents-Cx95ksE3.js";import A from"./modalForm-DENveGO6.js";import{F as G}from"./XCircleIcon-DMokhxit.js";import{F as H}from"./CheckCircleIcon-rVZreOX9.js";import"./dialog-DMRC6pLw.js";import"./keyboard-CqAUuiCL.js";import"./XMarkIcon-DFQoyLjO.js";const Z=({row:s,fields:j,onSave:v,onCancel:g,title:S,description:C})=>{const[i,h]=d.useState(s||{});for(let e in i)if(e.indexOf("JsonSettings")>-1&&e.indexOf(".")==-1)try{let t=y(i[e]);if(t)for(let o in t)i[e+"Object."+o]=t[o]}catch(t){console.error("Error parsing JSON:",t)}const[p,x]=d.useState(!1),[O,F]=d.useState("");let u=j;const{handleSubmit:N,register:E,unregister:P,control:J,clearErrors:L,reset:V,watch:R,getValues:w,setValue:m,trigger:I,formState:{errors:D}}=k({defaultValues:{...s}});d.useEffect(()=>{s&&(Object.keys(s).forEach(e=>{P(e),m(e,s[e])}),h({...s}))},[s]);const K=async e=>{x(!0),window.scrollTo({top:0,behavior:"smooth"});let t=o=>{F(o)};try{await v(e,!1,!0,t)}catch(o){console.error("Error saving user:",o)}x(!1)},b=(e,t)=>{if(console.log("handlePropertiesChange",e,t),m(e,t),s&&(s[e]=t),e.indexOf("JsonSettingsObject")>-1){let n=e.split("Object.")[1],f=e.split("Object.")[0];var o=s[f],l=y(o);let a={[n]:t};l={...l,...a},s[f]=JSON.stringify(l),m(f,JSON.stringify(l))}h({...s})};let c=[...u];return i&&(u==null?void 0:u.length)>0&&(c=c.filter(e=>{var o;let t=(o=e.conditions)==null?void 0:o.filter(l=>l.key);return(t==null?void 0:t.length)>0?!!t.find(n=>{if(n.key){let f=n.key.charAt(0).toLowerCase()+n.key.slice(1),a=i[n.key]||i[f];if(a&&(a==null?void 0:a.toString())==n.value)return!0}}):!0})),console.log({filteredComponents:c}),r.jsx(A,{title:S,description:C,open:!0,center:!1,outerClass:"max-w-xl",setOpen:g,children:r.jsxs("div",{className:"flex-auto p-2 relative",children:[p&&r.jsx(M,{info:O}),r.jsxs("form",{onSubmit:N(K),children:[r.jsx(z,{handlePropertiesChange:b,handlePropertiesPanelChange:()=>{console.log("handlePropertiesPanelChange")},formData:i,isPlayGround:!1,onChangeValue:b,drop:null,isSubmitted:p,isOver:!1,eventDetails:{},components:c,selectedComponent:{},handleSelect:()=>{console.log("handleSelect")},register:E,getValues:w,errors:D,control:J,setValue:m,clearErrors:L,reset:V,watch:R,removeComponent:()=>{console.log("removeComponent")}}),!p&&r.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(G,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(H,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})};export{Z as default};
