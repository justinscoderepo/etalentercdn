import{r as s,j as i,L as W,z as a,i as X,p as I,D as Y,l as Z}from"./main-nFqu6Iwq.js";import V from"./textBox-BuVdSKG4.js";import"./validationMessage-DUun8xcG.js";import"./EyeSlashIcon-29iaErp4.js";import"./EyeIcon-BGPqON-o.js";import"./ChatBubbleBottomCenterTextIcon-RS88wP73.js";const he=({fieldName:w,label:k,placeholder:D,errors:P,register:p,formData:O,optional:R,maxLength:j,onChange:d,type:C,pattern:L,minLength:F,autocomplete:N,step:_,disabled:ee,max:te,labelFont:ae,noLabel:se})=>{const[T,r]=s.useState(!1),[n,A]=s.useState(""),[f,G]=s.useState(!1),[m,v]=s.useState(!1),[re,E]=s.useState(!1),[x,o]=s.useState(!1),[le,B]=s.useState(!1),[ie,J]=s.useState(""),[h,u]=s.useState(!1),[b,c]=s.useState(!1),[ne,y]=s.useState(""),U="/PublicJson/GetUserCheck",$="/PublicJson/UsersActivation",z=Z+"/PublicJson/GetOTPCheck",S=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),g=e=>e.length===6&&/^\d{6}$/.test(e);s.useEffect(()=>{const e=setTimeout(()=>{J(n)},500);return()=>{clearTimeout(e)}},[n]);let q=()=>{const e={Email:n};return r(!0),I(U,e).then(t=>(r(!1),t.data===!0?(u(!0),a.error("This email ID is already registered. Please enter a different email ID."),!1):(u(!1),!0))).catch(t=>{r(!1),console.error("Error checking user:",t),u(!1),a.error("Error checking user, please try again.")})};const H=e=>{const t=e.target.value;t!==n&&(o(!1),u(!1),A(t),E(!1),G(S(t)),v(!1),c(!1)),d("email",e.target.value)},K=async()=>{let e=await q();if(e)if(S(n)&&e){o(!0),a.success("OTP button will activate in 30 seconds."),setTimeout(()=>{o(!1)},3e4);const t={Email:n};r(!0),I($,t).then(l=>{l.data.Results!=="Send mail success"?(u(!0),a.error(l.data.Results),o(!1)):(a.success("OTP sent successfully. Please check your email inbox. If you don't see the email, please check your spam folder."),v(!0),E(!0)),r(!1)}).catch(l=>{r(!1),console.error("Error sending OTP:",l),a.error("Failed to send OTP, please try again."),o(!1)})}else a.error("Please enter a valid email address.")},M=e=>{e&&(g(e)?(r(!0),Y.post(z,{Email:n,OTP:e},{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{r(!1),t.data===!0?(c(!0),d("otp",e),a.success("OTP is valid.")):(d("otp",""),a.error("OTP is not valid."),y(""),c(!1))}).catch(t=>{r(!1),console.error("Error validating OTP:",t),a.error("Invalid OTP. Please try again."),c(!1)})):a.error("Please enter a valid 6-digit OTP."))},Q=e=>{if(!g(e.target.value))return;const l=e.target.value;y(l),B(g(l)),M(l)};return i.jsxs(i.Fragment,{children:[T&&i.jsx(W,{isLoading:T}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx(V,{fieldName:w,label:k,placeholder:D,errors:P,register:p,formData:O,optional:R,maxLength:j,onChange:H,type:C,validate:e=>m?h?(a.error("This email ID is already registered. Please enter a different email ID or login with this email ID."),!1):f?!0:(a.error("Please enter a valid email address."),!1):(a.error("Please click on Get OTP via Email button to get OTP."),!1),pattern:L,minLength:F,autocomplete:N,readOnly:!1}),!b&&i.jsx("button",{disabled:!f||h||x,onClick:K,type:"button",className:X(f&&!h&&!x?"w-full my-2 py-2 px-4 bg-green-600 text-white rounded-md shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500":"w-full my-2 py-2 px-4 bg-gray-400 text-white rounded-md shadow-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500"),children:m?"Resend OTP via Email":"Get OTP via Email"}),m&&i.jsx("div",{className:"pt-4",children:i.jsx(V,{fieldName:"otp",label:"Enter the OTP",placeholder:"Enter OTP sent to your email",errors:P,register:p,formData:O,optional:!1,maxLength:6,validate:()=>b?!0:(a.error("Please enter a valid OTP."),!1),minLength:6,onChange:Q,type:"text",pattern:/^\d{6}$/,autocomplete:"off"})})]})]})};export{he as default};
