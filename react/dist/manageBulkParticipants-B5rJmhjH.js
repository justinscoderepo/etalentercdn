import{r as a,b as re,m as le,e as ce,z as de,j as t,L as r,k as n,_ as l}from"./main-C93JHIOS.js";import{L as ue}from"./layoutOuter-l6BzHFR0.js";import{P as pe}from"./pageHeader-BW5xwF8Q.js";import{F as me}from"./PlusIcon-DtW01xJ6.js";const ge=n.lazy(()=>l(()=>import("./groupFilterTab-BzZ5_70F.js"),[])),fe=n.lazy(()=>l(()=>import("./organizationLevelManager-X-dh7cwJ.js"),[])),he=n.lazy(()=>l(()=>import("./participantFilterTab-B5l6wKB5.js"),[])),xe=n.lazy(()=>l(()=>import("./participantFilters-B945Bqhf.js"),[])),Ce=n.lazy(()=>l(()=>import("./participantManagementLayout-BQf1ZEmS.js"),[])),be=n.lazy(()=>l(()=>import("./renderRegistrationForm-C4E5a5wb.js").then(h=>h.r),[])),Pe=({user:h})=>{const[j,k]=a.useState(Date.now()),[s,S]=a.useState(""),[u,y]=a.useState(""),[F,p]=a.useState(""),[c,z]=a.useState([]),[I,O]=a.useState(10),[E,i]=a.useState(1),[D,G]=a.useState([]),[R,M]=a.useState(!1),[V,ve]=a.useState(!1);let{user:U}=re()||{};const x=h||U,{eventDetails:W,eventLevels:J,topLevels:B,groups:d,eventCacheLoaded:w}=le(),{advancedSettings:H}=ce(),C=H||{};let m=null;if(d&&Array.isArray(d)&&d.length>0){let e=d.find(o=>o.GroupName.toLowerCase()==="common");e||(e=d.find(o=>(o.JsonSettings?JSON.parse(o.JsonSettings):{}).IsCommon==="Yes")),m=e?e.EventGroupId:null}const[b,v]=a.useState({candidateName:"",candidateIdentityNumber:"",isIncludeStatusTitle:"Yes",isIncludeCommon:"",commonGroup:m,isListWithoutSelectedGroup:""});a.useEffect(()=>{v(e=>({...e,isIncludeCommon:C.DefaultValueForMixingCommonWithOtherAgeGroups=="Yes"?"true":C.DefaultValueForMixingCommonWithOtherAgeGroups==="No"?"false":""}))},[C.DefaultValueForMixingCommonWithOtherAgeGroups]);const Q=a.useCallback(e=>{if(Array.isArray(e)){z(e);const o=e.slice().reverse().find(oe=>{const N=Object.values(oe)[0];return N&&N!==""}),L=o?Object.values(o)[0]:"";p(L),i(1)}else p(e),i(1)},[]),P=a.useCallback(e=>{v(e)},[]),Y=a.useCallback(e=>{O(e),i(1)},[]),$=a.useCallback(e=>{i(e)},[]),q=a.useCallback(e=>{S(e),i(1)},[]),K=a.useCallback(e=>{y(e),i(1)},[]),X=a.useCallback(e=>{G(e)},[]),Z=a.useCallback(()=>{M(e=>!e)},[]),_=a.useCallback(e=>{if(e.TeamTeamName){A(e.Team);return}g(e?.Candidate||e?.Team||null),f(!0)},[x]),ee=a.useCallback(async e=>{window.confirm(`Are you sure you want to delete ${e.UserName||e.TeamTeamName}?`)},[]),te=a.useCallback(e=>{A(e.Team)},[]),[T,g]=a.useState(null),[ae,f]=a.useState(!1),ne=a.useCallback(()=>{},[]),se=a.useCallback(()=>{v({candidateName:"",candidateIdentityNumber:"",teamIdentityNumber:"",registrationId:"",isIncludeStatusTitle:"",isIncludeCommon:"",commonGroup:m,isListWithoutSelectedGroup:""}),p(""),S(""),y(""),p(""),i(1),de.success("Filters cleared")},[m]);a.useEffect(()=>{typeof window<"u"&&window.jQuery&&(typeof window.resizeBox=="function"&&window.resizeBox(window.jQuery),window.jQuery(document).trigger("ready"))},[]);const ie=(e=null)=>{g(e),f(!0)},A=e=>{g(e),f(!0)};if(!w||c===null){let e=[];return w||e.push("event data"),c===null&&e.push("organization data"),t.jsx(r,{info:"Loading participants data..."+e.join(", ")})}return t.jsx(ue,{children:t.jsxs("div",{className:"flex flex-col grow",children:[t.jsx(pe,{heading:"Manage Participants",subHeading:"Add, edit, and manage individual and team participants with bulk operations and filtering",rightChildren:t.jsxs("button",{type:"button",onClick:()=>ie(null),className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[t.jsx(me,{className:"h-4 w-4"}),"Add Participant"]})}),ae&&t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading participant details..."}),children:t.jsx(be,{isDirectOpen:!0,isCoordinatorView:!0,view:"participationDetails",eventDetails:W,allowEdit:!0,getParticipantsLink:"/CoordinatorJson/GetParticipants",closeModel:()=>{f(!1),j&&k(Date.now()),g(null)},participantTypeInt:s==="2"?2:s==="1"?1:s,candidateId:T,setActiveTab:()=>{}},T+s)}),t.jsx("div",{className:"bg-surfaceCard border-b border-border",children:t.jsxs("div",{className:"flex flex-row flex-wrap gap-2 w-full",children:[t.jsx("div",{className:"flex-1 min-w-[300px] px-2 py-1",children:t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading organization manager..."}),children:t.jsx(fe,{user:x,eventLevels:J,topLevels:B,selectedOrganizations:c,onOrganizationChange:Q})})}),t.jsx("div",{className:"flex-1 min-w-[300px]",children:t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading filters..."}),children:t.jsx(xe,{filterCriterias:b,onFilterChange:P,onApply:P,showAdvancedFilters:R,onToggleAdvancedFilters:Z})})})]})}),t.jsx("div",{className:"bg-surfaceCard border-b border-border",children:t.jsx("div",{className:"px-3 py-2",children:t.jsxs("div",{className:"flex flex-row gap-x-2 justify-between",children:[t.jsx("div",{className:"",children:t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading participant tabs..."}),children:t.jsx(he,{selectedParticipantType:s,onParticipantTypeChange:q,selectedGroupFilter:u})})}),t.jsx("div",{className:"",children:t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading group tabs..."}),children:t.jsx(ge,{allowAll:!1,selectedGroupFilter:u,onGroupFilterChange:K,selectedParticipantType:s})})})]})})}),t.jsx("div",{className:"bg-surface relative",children:c.length>0&&s>0&&u>0&&t.jsx(n.Suspense,{fallback:t.jsx(r,{info:"Loading participants layout..."}),children:t.jsx(Ce,{selectedOrganizations:c,selectedGroupFilter:u,selectedParticipantType:s,selectedOrganization:F,searchTerm:b.candidateName,filterCriterias:b,pageSize:I,currentPage:E,onEdit:_,onView:e=>_(e),onDelete:ee,onTeamManage:te,loading:V,selectedParticipants:D,onSelectionChange:X,currentUser:x,onAssignmentChange:ne,onPageChange:$,onPageSizeChange:Y,onClearFilters:se},j)})})]})})};export{Pe as default};
