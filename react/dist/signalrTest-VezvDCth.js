import{r,z as n,j as e}from"./main-Dy5yWvzN.js";import{s as a}from"./signalrService-CtkxcRT2.js";function N({user:t}){const[d,g]=r.useState("Disconnected"),[l,o]=r.useState(""),[m,h]=r.useState([]);r.useEffect(()=>{a.connect(t);const s=setInterval(()=>{const i=a.getConnectionState();g(i.isConnected?"Connected âœ…":"Disconnected âŒ")},1e3),c=a.on("eventMessage",i=>{h(u=>[...u,i]),n.success(`Message received from ${i.FromUserName}`)});return()=>{clearInterval(s),c()}},[t]);const x=async()=>{try{await a.sendEventMessage(l),n.success("Message sent!"),o("")}catch(s){n.error("Failed to send: "+s.message)}},b=()=>{a.trackPageView(t.UId,"/test-page"),n.success("Page view tracked!")},p=()=>{a.trackFormSubmission(t.UId,"Test Form","Test details"),n.success("Form submission tracked!")};return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6 text-gray-900",children:"SignalR Test Page"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Connection Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${d.includes("âœ…")?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"font-medium",children:d})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["User: ",t.Name," | Role: ",t.RoleName||t.Role," | Event: ",t.Event]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Test Activity Tracking"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primaryHover text-sm font-semibold",children:"Track Page View"}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm font-semibold",children:"Track Form Submit"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"These will appear in the coordinator's live dashboard"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Test Chat (Event Message)"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:l,onChange:s=>o(s.target.value),onKeyPress:s=>s.key==="Enter"&&x(),placeholder:"Type a test message...",className:"flex-1 px-3 py-2 border rounded-md text-sm"}),e.jsx("button",{onClick:x,disabled:!l.trim(),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primaryHover disabled:bg-gray-300 text-sm font-semibold",children:"Send"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Received Messages:"}),m.length===0?e.jsx("p",{className:"text-xs text-gray-500",children:"No messages yet"}):m.map((s,c)=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-sm",children:[e.jsxs("span",{className:"font-medium",children:[s.FromUserName,":"]})," ",s.Message,e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:new Date(s.Timestamp).toLocaleTimeString()})]},c))]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-blue-900",children:"Test Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-blue-800",children:[e.jsx("li",{children:"Open this page in multiple browser windows"}),e.jsx("li",{children:"Send messages from one window"}),e.jsx("li",{children:"See them appear in other windows (real-time!)"}),e.jsx("li",{children:"Open coordinator dashboard to see activity tracking"}),e.jsx("li",{children:"Test form tracking and page views"})]}),e.jsx("p",{className:"mt-3 text-xs text-blue-600",children:"ðŸ’¡ If coordinator role: Open LiveActivityDashboard to see all tracked activities"})]})]})}export{N as default};
