import{r as o,d as P,j as e}from"./mainweb-BTnueSEP.js";import{Q as I,B as h}from"./ReactToastify-ZRAwwGI5.js";import{A as O}from"./authContext-CDfa1dC_.js";import{p}from"./httpService-C8TQb376.js";import"./clsx-B-dksMZM.js";import"./index-t--hEgTQ.js";const J=()=>{const[c,b]=o.useState(""),[d,f]=o.useState(""),[n,v]=o.useState(!1),m=P(),[u,w]=o.useState(""),{setAccessToken:N,setUser:j}=o.useContext(O),y="Account/LoginUser",E="UsersRolesPlusUsersJson/GetRoles",S=async s=>{var g,x;s.preventDefault();const U={email:c,password:d,IsCrossRequest:!0},l=new FormData,C=["*","ApprovalStatus","CompetitionLevel","CreatedByIn","CreatedDateString","Event","EventCategory","EventEventName","Group","GroupCompetitions","GroupGroupName","IdentityNumber","IsPasswordSet","JsonSettings","Message","ModifiedDateString","Order","Organization","OrganizationName","ParticipantType","Participations","RegistrationId","Role","RowFrom","RowTo","SearchTerm","SixDigitPassword","Status","TotalRowCount","User","UserComments","UserDobString","UserEmail","UserEmailCode","UserJsonSettings","UserMobile","UserName","UserNameCode","UserNameTitle","UserPhone","UserProfilePicture","UserRoleId","UserTitleNameTitle"];l.append("isCaching","true"),l.append("select",C);try{const r=await p(y,U,!0),{user:t,token:a}=r.data;if(!a||!t)throw new Error("Token or user data is missing.");localStorage.setItem("accessToken",a),localStorage.setItem("userInfo",JSON.stringify(t)),N(a),j(t);const R={token:a,user:{Name:t.Name,EventName:t.EventName,EventCategory:t.EventCategory,Event:t.Event,Email:t.Email,Role:t.Role,RoleTitle:t.RoleTitle,UserRoleId:t.UserRoleId,UId:t.UId,Organization:t.Organization,OrganizationLevel:t.OrganizationLevel,OrganizationLogo:t.OrganizationLogo,EventLogo:t.EventLogo}};localStorage.setItem("USER",JSON.stringify(R));try{const i=await p(E,l);localStorage.setItem("roles",JSON.stringify(i.data))}catch(i){console.error("Roles fetch error:",i),h.error("Failed to fetch roles.")}m("/JudgeScoreCard")}catch(r){console.error("Error:",r),w(r.message||"An unexpected error occurred."),h.error(((x=(g=r.response)==null?void 0:g.data)==null?void 0:x.message)||"Login failed. Please try again.")}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-center mb-6 text-blue-800",children:"LOGIN"}),e.jsxs("blockquote",{className:"text-sm text-gray-600 mb-6",children:["Welcome to the login portal, where you can access different roles:",e.jsxs("ul",{className:"list-disc pl-5 mt-2 text-left",children:[e.jsx("li",{children:"Event Manager"}),e.jsx("li",{children:"Coordinator"}),e.jsx("li",{children:"Sub-Coordinator"}),e.jsx("li",{children:"Projector Operator"}),e.jsx("li",{children:"Competition Judge"}),e.jsx("li",{children:"Content/Print Administrator"})]})]}),e.jsx("blockquote",{className:"text-sm text-gray-600 mb-6",children:e.jsx("div",{className:"warning",children:e.jsxs("p",{children:["Note: If you are a ",e.jsx("b",{children:"candidate"}),"/",e.jsx("b",{children:"guardian"}),", please login from the ",e.jsx("b",{children:"email link"})," you have received."]})})}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:c,onChange:s=>b(s.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3",placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{type:n?"text":"password",id:"password",value:d,onChange:s=>f(s.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3",placeholder:"Enter your password",required:!0}),e.jsxs("button",{type:"button",onClick:()=>v(!n),className:"absolute inset-y-0 right-3 flex items-center text-gray-500 hover:text-gray-700",children:[n?"Hide":"Show"," "]})]})]}),u&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:u}),e.jsx("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Log In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{onClick:()=>m("/ForgotPasswordPage"),className:"text-blue-600 hover:underline text-sm cursor-pointer",children:"Forgot Password? Reset here"})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("a",{href:"/register",className:"text-blue-600 hover:underline text-sm",children:"New User? Register as an Event Manager"})}),e.jsx(I,{})]})};export{J as default};
