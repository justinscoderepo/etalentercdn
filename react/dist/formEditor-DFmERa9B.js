import{r as f,p as y,j as r,L as z}from"./main-CLPz_RRt.js";import{u as A}from"./index.esm-DvmoQ8Xi.js";import{RenderComponents as G}from"./renderComponents-BimYw7Xj.js";import H from"./modalForm-BoWUXHNC.js";import{F as I}from"./XCircleIcon-j5L9R3HW.js";import{F as T}from"./CheckCircleIcon-s7iKtVGr.js";import"./utilities-CN4lTu6a.js";import"./validationMessage-BaQ3odrt.js";import"./CheckCircleIcon-B13RkULU.js";import"./dialog-BgioBn70.js";import"./keyboard-BK8cHSJ3.js";import"./description-CR0nUw_a.js";import"./open-closed-BEZDRX9-.js";import"./XMarkIcon-DISae1-Y.js";const ie=({row:s,fields:j,viewMode:p,noModal:S,onSave:v,onCancel:d,title:C,description:O})=>{const[n,g]=f.useState(s||{});for(let e in n)if(e.indexOf("JsonSettings")>-1&&e.indexOf(".")==-1)try{let t=y(n[e]);if(t)for(let o in t)n[e+"Object."+o]=t[o]}catch(t){console.error("Error parsing JSON:",t)}let[u,h]=f.useState(!1);const[F,N]=f.useState("");let x=j;const{handleSubmit:P,register:E,unregister:J,control:L,clearErrors:V,reset:R,watch:w,getValues:D,setValue:a,trigger:$,formState:{errors:K}}=A({defaultValues:{...s}});f.useEffect(()=>{s&&(Object.keys(s).forEach(e=>{J(e),a(e,s[e])}),g({...s}))},[s]);const M=async e=>{h(!0),window.scrollTo({top:0,behavior:"smooth"});let t=o=>{N(o)};try{await v(e,!1,!0,t)}catch(o){console.error("Error saving user:",o)}h(!1)},b=(e,t)=>{if(console.log("handlePropertiesChange",e,t),a(e,t),s&&(s[e]=t),e.indexOf("JsonSettingsObject")>-1){let c=e.split("Object.")[1],l=e.split("Object.")[0];var o=s[l],i=y(o);let k={[c]:t};i={...i,...k},s[l]=JSON.stringify(i),a(l,JSON.stringify(i))}g({...s})};let m=[...x];return n&&x?.length>0&&(m=m.filter(e=>{let t=e.conditions?.filter(o=>o.key);return t?.length>0?!!t.find(i=>{if(i.key){let c=i.key.charAt(0).toLowerCase()+i.key.slice(1),l=n[i.key]||n[c];if(l&&l?.toString()==i.value)return!0}}):!0})),console.log({filteredComponents:m}),r.jsx(H,{isPlainView:S,title:C,description:O,open:!0,center:!1,outerClass:"max-w-xl",setOpen:d,children:r.jsxs("div",{className:"flex-auto relative",children:[u&&r.jsx(z,{info:F}),r.jsxs("form",{onSubmit:P(M),children:[r.jsx(G,{handlePropertiesChange:b,handlePropertiesPanelChange:()=>{console.log("handlePropertiesPanelChange")},viewMode:p,formData:n,isPlayGround:!1,onChangeValue:b,drop:null,isSubmitted:u,isOver:!1,eventDetails:{},components:m,selectedComponent:{},handleSelect:()=>{console.log("handleSelect")},register:E,getValues:D,errors:K,control:L,setValue:a,clearErrors:V,reset:R,watch:w,removeComponent:()=>{console.log("removeComponent")}}),!u&&!p&&r.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:d,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(I,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(T,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})};export{ie as default};
