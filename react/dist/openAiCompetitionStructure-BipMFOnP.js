import{r as ae,j as u,L as Ps,n as Ot}from"./mainweb-CAGpoPTC.js";import{C as xi,u as vi}from"./index.esm-4VmtONJR.js";import{u as wi,p as ki}from"./httpService-CCjEIOGC.js";import{c as ur}from"./utilities-CN4lTu6a.js";import{V as Si}from"./validationMessage-kH8q8XEy.js";import{F as Ai}from"./XMarkIcon-CfQGh_Mn.js";import{v as Xn}from"./v4-BKT09osN.js";import"./index-t--hEgTQ.js";function Ci({title:s,titleId:e,...t},n){return ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),s?ae.createElement("title",{id:e},s):null,ae.createElement("path",{fillRule:"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z",clipRule:"evenodd"}))}const Pi=ae.forwardRef(Ci);function Ri({optional:s,control:e,fieldName:t,label:n,errors:r,enableCrop:a,onChangeValidation:i,viewOnly:o,aspect:c,disableRequiredsymbol:l,validVideoExtensions:d,validImageExtensions:f,validExtensions:p,rules:g,labelFont:N,fileUploadUrl:v,isImageOptimize:B}){let U=r?.[t],[k,J]=ae.useState(U);const[D,_]=ae.useState(!1);let[C,L]=ae.useState([]);ae.useEffect(()=>{J(r?.[t])},[r?.[t]]);function q(M,j){const ie=M.split(","),Pe=ie[0].match(/:(.*?);/)[1],ze=atob(ie[1]);let Re=ze.length;const je=new Uint8Array(Re);for(;Re--;)je[Re]=ze.charCodeAt(Re);return new File([je],j,{type:Pe})}const W=async M=>{try{_(!0);let j=await wi(`${v}`,M);j?.data?.Results&&(j.data?(C.push({filePath:j.data.Results,webUrl:`${j.data.Results}`}),L(C),i(C)):(Ot.error("Failed to upload"),i([{filePath:"",webUrl:""}])),_(!1))}catch(j){Ot.error(j?.response?.data?.message),i([{filePath:"",webUrl:""}])}_(!1)};return u.jsx("div",{className:"overflow-hidden min-h-64",children:D?u.jsx(Ps,{}):u.jsx("div",{className:"",children:u.jsx("div",{children:u.jsx("div",{className:"",children:!o&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"my-5",children:[u.jsx("label",{htmlFor:t,className:ur(N||" text-sm text-center block font-medium text-gray-700 mb-1",k?"text-danger":"text-gray-400"),children:n||t}),g&&g.required&&!l?u.jsx("sup",{}):"",u.jsx(xi,{name:t,control:e,rules:{required:!s},render:({field:M})=>u.jsxs("div",{className:ur("flex flex-col p-10 w-full border-0 pt-4 border-b border-transparent bg-gray-100 focus:border-darkprimary focus:ring-0 sm:text-sm",k?"border-danger":"text-gray-200 border-purple-400"),children:[M?.value?.length?u.jsx(u.Fragment,{children:u.jsx("div",{className:"flex flex-1 w-full relative h-full  space-x-8  grow flex-row items-center rounded-lg tracking-wide overflow-x-scroll",children:M.value.map((j,ie)=>u.jsxs("div",{className:"relative flex flex-shrink-0",children:[u.jsx("img",{src:j.webUrl,alt:`Image ${ie}`,className:"max-h-100 flex w-96 mb-3 mr-3 nonselectable",draggable:!1}),u.jsx("div",{className:"absolute top-0 right-0  pt-2 pr-2 block",children:u.jsxs("button",{type:"button",className:"rounded-md bg-transparent text-shadow text-white hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 bg-lightcharcoal p-2 bg-opacity-90",onClick:()=>{setTimeout(()=>{C=C.filter((Pe,ze)=>ze!==ie),L(C),i(C)},100)},children:[u.jsx("span",{className:"sr-only",children:"Close"}),u.jsx(Ai,{className:"h-8 w-8 text-[#c5c5c5]","aria-hidden":"true"})]})})]},ie))})}):u.jsx(u.Fragment,{}),u.jsxs("label",{className:"w-100 relative h-full flex flex-col items-center rounded-lg tracking-wide cursor-pointer ",children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-8 h-8 mt-8 text-primary",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z",className:"text-lightcharcoal"}),u.jsx("path",{className:"text-lightcharcoal",strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),u.jsx("span",{className:"mt-2 font-medium leading-normal text-primary mb-8",children:"Upload"}),u.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:async j=>{_(!0);const ie=Array.from(j.target.files);let Pe=0;if(ie.forEach(je=>{Pe+=je.size}),Pe/(1024*1024)>10){Ot.error("Total file size should be lesser than 10MB."),_(!1);return}const Re=ie.map(je=>new Promise((qn,lr)=>{const Ye=new FileReader;Ye.onload=function(rn){qn(rn.target.result)},Ye.readAsDataURL(je)}));Promise.all(Re).then(je=>{je.forEach((qn,lr)=>{const Ye=new FormData,rn=ie[lr];let et,tt;const wt=new Image;wt.src=qn,wt.onload=async function(){if(B===!0){const kt=wt.height,St=wt.width,an=document.createElement("canvas"),yi=an.getContext("2d");if(kt>300&&St>300)if(St<kt){et=300;const Hn=St/et;tt=kt/Hn}else{tt=300;const Hn=kt/tt;et=St/Hn}else tt=kt,et=St;an.width=et,an.height=tt,yi.drawImage(wt,0,0,et,tt);const _i=an.toDataURL("image/jpeg"),cr=q(_i,rn.name);let bi=URL.createObjectURL(cr);M.onChange([...M.value,bi]),Ye.append("file",cr)}else Ye.append("file",rn);W(Ye)}})}),j.target.value=""}})]})]})}),k&&u.jsx(Si,{message:"This file is required"})]})})})})})})}let dr=!1,jt,Lr,Br,cs,Ur,Vr,zr,Wr,Gr;function Jr(s,e={auto:!1}){if(dr)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(jt)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${jt}'\``);dr=e.auto,jt=s.kind,Lr=s.fetch,s.Request,s.Response,s.Headers,Br=s.FormData,s.Blob,cs=s.File,Ur=s.ReadableStream,Vr=s.getMultipartRequestOptions,zr=s.getDefaultAgent,Wr=s.fileFromPath,Gr=s.isFsReadStream}class Ti{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function qr({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,r,a;try{t=fetch,n=Request,r=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,o)=>({...o,body:new Ti(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Jr(qr({manuallyImported:!0}));const us="RFC3986",ds={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},Ei="RFC1738",Ii=Array.isArray,xe=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),Kn=1024,Ni=(s,e,t,n,r)=>{if(s.length===0)return s;let a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let i="";for(let o=0;o<a.length;o+=Kn){const c=a.length>=Kn?a.slice(o,o+Kn):a,l=[];for(let d=0;d<c.length;++d){let f=c.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||r===Ei&&(f===40||f===41)){l[l.length]=c.charAt(d);continue}if(f<128){l[l.length]=xe[f];continue}if(f<2048){l[l.length]=xe[192|f>>6]+xe[128|f&63];continue}if(f<55296||f>=57344){l[l.length]=xe[224|f>>12]+xe[128|f>>6&63]+xe[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|c.charCodeAt(d)&1023),l[l.length]=xe[240|f>>18]+xe[128|f>>12&63]+xe[128|f>>6&63]+xe[128|f&63]}i+=l.join("")}return i};function Oi(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function fr(s,e){if(Ii(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const ji=Object.prototype.hasOwnProperty,Hr={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},ve=Array.isArray,$i=Array.prototype.push,Xr=function(s,e){$i.apply(s,ve(e)?e:[e])},Mi=Date.prototype.toISOString,X={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Ni,encodeValuesOnly:!1,format:us,formatter:ds[us],indices:!1,serializeDate(s){return Mi.call(s)},skipNulls:!1,strictNullHandling:!1};function Fi(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const Qn={};function Kr(s,e,t,n,r,a,i,o,c,l,d,f,p,g,N,v,B,U){let k=s,J=U,D=0,_=!1;for(;(J=J.get(Qn))!==void 0&&!_;){const M=J.get(s);if(D+=1,typeof M<"u"){if(M===D)throw new RangeError("Cyclic object value");_=!0}typeof J.get(Qn)>"u"&&(D=0)}if(typeof l=="function"?k=l(e,k):k instanceof Date?k=p?.(k):t==="comma"&&ve(k)&&(k=fr(k,function(M){return M instanceof Date?p?.(M):M})),k===null){if(a)return c&&!v?c(e,X.encoder,B,"key",g):e;k=""}if(Fi(k)||Oi(k)){if(c){const M=v?e:c(e,X.encoder,B,"key",g);return[N?.(M)+"="+N?.(c(k,X.encoder,B,"value",g))]}return[N?.(e)+"="+N?.(String(k))]}const C=[];if(typeof k>"u")return C;let L;if(t==="comma"&&ve(k))v&&c&&(k=fr(k,c)),L=[{value:k.length>0?k.join(",")||null:void 0}];else if(ve(l))L=l;else{const M=Object.keys(k);L=d?M.sort(d):M}const q=o?String(e).replace(/\./g,"%2E"):String(e),W=n&&ve(k)&&k.length===1?q+"[]":q;if(r&&ve(k)&&k.length===0)return W+"[]";for(let M=0;M<L.length;++M){const j=L[M],ie=typeof j=="object"&&typeof j.value<"u"?j.value:k[j];if(i&&ie===null)continue;const Pe=f&&o?j.replace(/\./g,"%2E"):j,ze=ve(k)?typeof t=="function"?t(W,Pe):W:W+(f?"."+Pe:"["+Pe+"]");U.set(s,D);const Re=new WeakMap;Re.set(Qn,U),Xr(C,Kr(ie,ze,t,n,r,a,i,o,t==="comma"&&v&&ve(k)?null:c,l,d,f,p,g,N,v,B,Re))}return C}function Zi(s=X){if(typeof s.allowEmptyArrays<"u"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys<"u"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder<"u"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||X.charset;if(typeof s.charset<"u"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=us;if(typeof s.format<"u"){if(!ji.call(ds,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=ds[t];let r=X.filter;(typeof s.filter=="function"||ve(s.filter))&&(r=s.filter);let a;if(s.arrayFormat&&s.arrayFormat in Hr?a=s.arrayFormat:"indices"in s?a=s.indices?"indices":"repeat":a=X.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof s.allowDots>"u"?s.encodeDotInKeys?!0:X.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:X.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:X.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:X.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter>"u"?X.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:X.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:X.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:X.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:X.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:X.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:X.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:X.strictNullHandling}}function Di(s,e={}){let t=s;const n=Zi(e);let r,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):ve(n.filter)&&(a=n.filter,r=a);const i=[];if(typeof t!="object"||t===null)return"";const o=Hr[n.arrayFormat],c=o==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const l=new WeakMap;for(let p=0;p<r.length;++p){const g=r[p];n.skipNulls&&t[g]===null||Xr(i,Kr(t[g],g,o,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}const d=i.join(n.delimiter);let f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}const it="4.93.0",Qr=()=>{jt||Jr(qr(),{auto:!0})};Qr();class S extends Error{}class Y extends S{constructor(e,t,n,r){super(`${Y.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t;const a=t;this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,t,n){const r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new $n({message:n,cause:hs(t)});const a=t?.error;return e===400?new Yr(e,a,n,r):e===401?new ea(e,a,n,r):e===403?new ta(e,a,n,r):e===404?new na(e,a,n,r):e===409?new sa(e,a,n,r):e===422?new ra(e,a,n,r):e===429?new aa(e,a,n,r):e>=500?new ia(e,a,n,r):new Y(e,a,n,r)}}class de extends Y{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class $n extends Y{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Rs extends $n{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Yr extends Y{}class ea extends Y{}class ta extends Y{}class na extends Y{}class sa extends Y{}class ra extends Y{}class aa extends Y{}class ia extends Y{}class oa extends S{constructor(){super("Could not parse response content as the length limit was reached")}}class la extends S{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var on=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},We=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},le;class Mn{constructor(){le.set(this,void 0),this.buffer=new Uint8Array,on(this,le,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let a;for(;(a=Li(this.buffer,We(this,le,"f")))!=null;){if(a.carriage&&We(this,le,"f")==null){on(this,le,a.index,"f");continue}if(We(this,le,"f")!=null&&(a.index!==We(this,le,"f")+1||a.carriage)){r.push(this.decodeText(this.buffer.slice(0,We(this,le,"f")-1))),this.buffer=this.buffer.slice(We(this,le,"f")),on(this,le,null,"f");continue}const i=We(this,le,"f")!==null?a.preceding-1:a.preceding,o=this.decodeText(this.buffer.slice(0,i));r.push(o),this.buffer=this.buffer.slice(a.index),on(this,le,null,"f")}return r}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new S(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new S(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new S("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}le=new WeakMap;Mn.NEWLINE_CHARS=new Set([`
`,"\r"]);Mn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Li(s,e){for(let r=e??0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Bi(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}function ca(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class ke{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*r(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const i of Ui(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null||i.event.startsWith("response.")||i.event.startsWith("transcript.")){let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(o&&o.error)throw new Y(void 0,o.error,void 0,ya(e.headers));yield o}else{let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new Y(void 0,o.error,o.message,void 0);yield{event:i.event,data:o}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new ke(r,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const i=new Mn,o=ca(e);for await(const c of o)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const o of r())i||o&&(yield JSON.parse(o));i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new ke(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new ke(()=>r(e),this.controller),new ke(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Ur({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:i}=await t.next();if(i)return r.close();const o=n.encode(JSON.stringify(a)+`
`);r.enqueue(o)}catch(a){r.error(a)}},async cancel(){await t.return?.()}})}}async function*Ui(s,e){if(!s.body)throw e.abort(),new S("Attempted to iterate over a response with no body");const t=new zi,n=new Mn,r=ca(s.body);for await(const a of Vi(r))for(const i of n.decode(a)){const o=t.decode(i);o&&(yield o)}for(const a of n.flush()){const i=t.decode(a);i&&(yield i)}}async function*Vi(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),e=r;let a;for(;(a=Bi(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class zi{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Wi(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function Wi(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}const ua=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",da=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Fn(s),Fn=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",Gi=s=>da(s)||ua(s)||Gr(s);async function fa(s,e,t){if(s=await s,da(s))return s;if(ua(s)){const r=await s.blob();e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=Fn(r)?[await r.arrayBuffer()]:[r];return new cs(a,e,t)}const n=await Ji(s);if(e||(e=Hi(s)??"unknown_file"),!t?.type){const r=n[0]?.type;typeof r=="string"&&(t={...t,type:r})}return new cs(n,e,t)}async function Ji(s){let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(Fn(s))e.push(await s.arrayBuffer());else if(Xi(s))for await(const t of s)e.push(t);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${s?.constructor?.name}; props: ${qi(s)}`);return e}function qi(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function Hi(s){return Yn(s.name)||Yn(s.filename)||Yn(s.path)?.split(/[\\/]/).pop()}const Yn=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},Xi=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",hr=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",mt=async s=>{const e=await Ki(s.body);return Vr(e,s)},Ki=async s=>{const e=new Br;return await Promise.all(Object.entries(s||{}).map(([t,n])=>fs(e,t,n))),e},fs=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(Gi(t)){const n=await fa(t);s.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>fs(s,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,r])=>fs(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var ha={},Qi=function(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t},Yi=function(s,e,t,n){if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ln;Qr();async function ma(s){const{response:e}=s;if(s.options.stream)return Ze("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):ke.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const n=e.headers.get("content-type")?.split(";")[0]?.trim();if(n?.includes("application/json")||n?.endsWith("+json")){const i=await e.json();return Ze("response",e.status,e.url,e.headers,i),pa(i,e)}const a=await e.text();return Ze("response",e.status,e.url,e.headers,a),a}function pa(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Zn extends Promise{constructor(e,t=ma){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Zn(this.responsePromise,async t=>pa(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class eo{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=es("maxRetries",t),this.timeout=es("timeout",n),this.httpAgent=r,this.fetch=a??Lr}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ao(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${co()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&Fn(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){e={...e};const{method:n,path:r,query:a,headers:i={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:hr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,c=this.calculateContentLength(o),l=this.buildURL(r,a);"timeout"in e&&es("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const d=e.httpAgent??this.httpAgent??zr(l),f=e.timeout+1e3;typeof d?.options?.timeout=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:e,headers:i,contentLength:c,retryCount:t});return{req:{method:n,...o&&{body:o},headers:p,...d&&{agent:d},signal:e.signal??null},url:l,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const i=this.defaultHeaders(e);return yr(a,i),yr(a,t),hr(e.body)&&jt!=="node"&&delete a["content-type"],un(i,"x-stainless-retry-count")===void 0&&un(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),un(i,"x-stainless-timeout")===void 0&&un(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return Y.generate(e,t,n,r)}request(e,t=null){return new Zn(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:i,timeout:o}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:i,options:n}),Ze("request",i,n,a.headers),n.signal?.aborted)throw new de;const c=new AbortController,l=await this.fetchWithTimeout(i,a,o,c).catch(hs);if(l instanceof Error){if(n.signal?.aborted)throw new de;if(t)return this.retryRequest(n,t);throw l.name==="AbortError"?new Rs:new $n({cause:l})}const d=ya(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const B=`retrying, ${t} attempts remaining`;return Ze(`response (error; ${B})`,l.status,i,d),this.retryRequest(n,t,d)}const f=await l.text().catch(B=>hs(B).message),p=io(f),g=p?void 0:f;throw Ze(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,d,g),this.makeStatusError(l.status,p,g,d)}return{response:l,options:n,controller:c}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new to(this,n,e)}buildURL(e,t){const n=lo(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return _a(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new S(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>r.abort());const o=setTimeout(()=>r.abort(),n),c={signal:r.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n?.["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(r=o)}const i=n?.["retry-after"];if(i&&!r){const o=parseFloat(i);Number.isNaN(o)?r=Date.parse(i)-Date.now():r=o*1e3}if(!(r&&0<=r&&r<60*1e3)){const o=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Kt(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${it}`}}class ga{constructor(e,t,n,r){ln.set(this,void 0),Qi(this,ln,e),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new S("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[r,a]of n)e.url.searchParams.set(r,a);t.query=void 0,t.path=e.url.toString()}return await Yi(this,ln,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ln=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class to extends Zn{constructor(e,t,n){super(t,async r=>new n(e,r.response,await ma(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const ya=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),no={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},G=s=>typeof s=="object"&&s!==null&&!_a(s)&&Object.keys(s).every(e=>ba(no,e)),so=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":pr(Deno.build.os),"X-Stainless-Arch":mr(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":pr(process.platform),"X-Stainless-Arch":mr(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=ro();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ro(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${r}.${a}.${i}`}}}return null}const mr=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",pr=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let gr;const ao=()=>gr??(gr=so()),io=s=>{try{return JSON.parse(s)}catch{return}},oo=/^[a-z][a-z0-9+.-]*:/i,lo=s=>oo.test(s),Kt=s=>new Promise(e=>setTimeout(e,s)),es=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new S(`${s} must be an integer`);if(e<0)throw new S(`${s} must be a positive integer`);return e},hs=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch{}return new Error(s)},cn=s=>{if(typeof process<"u")return ha?.[s]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(s)?.trim()};function _a(s){if(!s)return!0;for(const e in s)return!1;return!0}function ba(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function yr(s,e){for(const t in e){if(!ba(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}const _r=new Set(["authorization","api-key"]);function Ze(s,...e){if(typeof process<"u"&&ha?.DEBUG==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const a={...n,headers:{...n.headers}};for(const i in n.headers)_r.has(i.toLowerCase())&&(a.headers[i]="REDACTED");return a}let r=null;for(const a in n)_r.has(a.toLowerCase())&&(r??(r={...n}),r[a]="REDACTED");return r??n});console.log(`OpenAI:DEBUG:${s}`,...t)}}const co=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),uo=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",fo=s=>typeof s?.get=="function",un=(s,e)=>{const t=e.toLowerCase();if(fo(s)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(r,a,i)=>a+i.toUpperCase());for(const r of[e,t,e.toUpperCase(),n]){const a=s.get(r);if(a)return a}}for(const[n,r]of Object.entries(s))if(n.toLowerCase()===t)return Array.isArray(r)?(r.length<=1||console.warn(`Received ${r.length} entries for the ${e} header, using the first entry.`),r[0]):r},ho=s=>{if(typeof Buffer<"u"){const e=Buffer.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};function ts(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class Dn extends ga{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ee extends ga{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class I{constructor(e){this._client=e}}let xa=class extends I{list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,mo,{query:t,...n})}},Ln=class extends I{constructor(){super(...arguments),this.messages=new xa(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/chat/completions",Bn,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class Bn extends ee{}class mo extends ee{}Ln.ChatCompletionsPage=Bn;Ln.Messages=xa;let Un=class extends I{constructor(){super(...arguments),this.completions=new Ln(this._client)}};Un.Completions=Ln;Un.ChatCompletionsPage=Bn;class va extends I{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class wa extends I{create(e,t){return this._client.post("/audio/transcriptions",mt({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class ka extends I{create(e,t){return this._client.post("/audio/translations",mt({body:e,...t,__metadata:{model:e.model}}))}}class Qt extends I{constructor(){super(...arguments),this.transcriptions=new wa(this._client),this.translations=new ka(this._client),this.speech=new va(this._client)}}Qt.Transcriptions=wa;Qt.Translations=ka;Qt.Speech=va;class Ts extends I{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/batches",Es,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Es extends ee{}Ts.BatchesPage=Es;class Is extends I{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/assistants",Ns,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Ns extends ee{}Is.AssistantsPage=Ns;function br(s){return typeof s.parse=="function"}const dt=s=>s?.role==="assistant",Sa=s=>s?.role==="function",Aa=s=>s?.role==="tool";var me=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},V=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ms,yn,_n,At,Ct,bn,Pt,Ee,Rt,kn,Sn,ot,Ca;class Os{constructor(){ms.add(this),this.controller=new AbortController,yn.set(this,void 0),_n.set(this,()=>{}),At.set(this,()=>{}),Ct.set(this,void 0),bn.set(this,()=>{}),Pt.set(this,()=>{}),Ee.set(this,{}),Rt.set(this,!1),kn.set(this,!1),Sn.set(this,!1),ot.set(this,!1),me(this,yn,new Promise((e,t)=>{me(this,_n,e,"f"),me(this,At,t,"f")}),"f"),me(this,Ct,new Promise((e,t)=>{me(this,bn,e,"f"),me(this,Pt,t,"f")}),"f"),V(this,yn,"f").catch(()=>{}),V(this,Ct,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},V(this,ms,"m",Ca).bind(this))},0)}_connected(){this.ended||(V(this,_n,"f").call(this),this._emit("connect"))}get ended(){return V(this,Rt,"f")}get errored(){return V(this,kn,"f")}get aborted(){return V(this,Sn,"f")}abort(){this.controller.abort()}on(e,t){return(V(this,Ee,"f")[e]||(V(this,Ee,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=V(this,Ee,"f")[e];if(!n)return this;const r=n.findIndex(a=>a.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(V(this,Ee,"f")[e]||(V(this,Ee,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{me(this,ot,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){me(this,ot,!0,"f"),await V(this,Ct,"f")}_emit(e,...t){if(V(this,Rt,"f"))return;e==="end"&&(me(this,Rt,!0,"f"),V(this,bn,"f").call(this));const n=V(this,Ee,"f")[e];if(n&&(V(this,Ee,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!V(this,ot,"f")&&!n?.length&&Promise.reject(r),V(this,At,"f").call(this,r),V(this,Pt,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!V(this,ot,"f")&&!n?.length&&Promise.reject(r),V(this,At,"f").call(this,r),V(this,Pt,"f").call(this,r),this._emit("end")}}_emitFinal(){}}yn=new WeakMap,_n=new WeakMap,At=new WeakMap,Ct=new WeakMap,bn=new WeakMap,Pt=new WeakMap,Ee=new WeakMap,Rt=new WeakMap,kn=new WeakMap,Sn=new WeakMap,ot=new WeakMap,ms=new WeakSet,Ca=function(e){if(me(this,kn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new de),e instanceof de)return me(this,Sn,!0,"f"),this._emit("abort",e);if(e instanceof S)return this._emit("error",e);if(e instanceof Error){const t=new S(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new S(String(e)))};function po(s,e){const t={...s};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function js(s){return s?.$brand==="auto-parseable-response-format"}function Yt(s){return s?.$brand==="auto-parseable-tool"}function go(s,e){return!e||!Pa(e)?{...s,choices:s.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:$s(s,e)}function $s(s,e){const t=s.choices.map(n=>{if(n.finish_reason==="length")throw new oa;if(n.finish_reason==="content_filter")throw new la;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:n.message.tool_calls?.map(r=>_o(e,r))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?yo(e,n.message.content):null}}});return{...s,choices:t}}function yo(s,e){return s.response_format?.type!=="json_schema"?null:s.response_format?.type==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function _o(s,e){const t=s.tools?.find(n=>n.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Yt(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function bo(s,e){if(!s)return!1;const t=s.tools?.find(n=>n.function?.name===e.function.name);return Yt(t)||t?.function.strict||!1}function Pa(s){return js(s.response_format)?!0:s.tools?.some(e=>Yt(e)||e.type==="function"&&e.function.strict===!0)??!1}function xo(s){for(const e of s??[]){if(e.type!=="function")throw new S(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new S(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var re=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},te,ps,An,gs,ys,_s,Ra,bs;const xr=10;class Ta extends Os{constructor(){super(...arguments),te.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Sa(e)||Aa(e))&&e.content)this._emit("functionCallResult",e.content);else if(dt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(dt(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new S("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),re(this,te,"m",ps).call(this)}async finalMessage(){return await this.done(),re(this,te,"m",An).call(this)}async finalFunctionCall(){return await this.done(),re(this,te,"m",gs).call(this)}async finalFunctionCallResult(){return await this.done(),re(this,te,"m",ys).call(this)}async totalUsage(){return await this.done(),re(this,te,"m",_s).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=re(this,te,"m",An).call(this);t&&this._emit("finalMessage",t);const n=re(this,te,"m",ps).call(this);n&&this._emit("finalContent",n);const r=re(this,te,"m",gs).call(this);r&&this._emit("finalFunctionCall",r);const a=re(this,te,"m",ys).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",re(this,te,"m",_s).call(this))}async _createChatCompletion(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),re(this,te,"m",Ra).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion($s(a,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const r="function",{function_call:a="auto",stream:i,...o}=t,c=typeof a!="string"&&a?.name,{maxChatCompletions:l=xr}=n||{},d={};for(const p of t.functions)d[p.name||p.function.name]=p;const f=t.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const N=(await this._createChatCompletion(e,{...o,function_call:a,functions:f,messages:[...this.messages]},n)).choices[0]?.message;if(!N)throw new S("missing message in ChatCompletion response");if(!N.function_call)return;const{name:v,arguments:B}=N.function_call,U=d[v];if(U){if(c&&c!==v){const _=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:r,name:v,content:_});continue}}else{const _=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${f.map(C=>JSON.stringify(C.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:v,content:_});continue}let k;try{k=br(U)?await U.parse(B):B}catch(_){this._addMessage({role:r,name:v,content:_ instanceof Error?_.message:String(_)});continue}const J=await U.function(k,this),D=re(this,te,"m",bs).call(this,J);if(this._addMessage({role:r,name:v,content:D}),c)return}}async _runTools(e,t,n){const r="tool",{tool_choice:a="auto",stream:i,...o}=t,c=typeof a!="string"&&a?.function?.name,{maxChatCompletions:l=xr}=n||{},d=t.tools.map(g=>{if(Yt(g)){if(!g.$callback)throw new S("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),f={};for(const g of d)g.type==="function"&&(f[g.function.name||g.function.function.name]=g.function);const p="tools"in t?d.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<l;++g){const v=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:p,messages:[...this.messages]},n)).choices[0]?.message;if(!v)throw new S("missing message in ChatCompletion response");if(!v.tool_calls?.length)return;for(const B of v.tool_calls){if(B.type!=="function")continue;const U=B.id,{name:k,arguments:J}=B.function,D=f[k];if(D){if(c&&c!==k){const q=`Invalid tool_call: ${JSON.stringify(k)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:r,tool_call_id:U,content:q});continue}}else{const q=`Invalid tool_call: ${JSON.stringify(k)}. Available options are: ${Object.keys(f).map(W=>JSON.stringify(W)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:U,content:q});continue}let _;try{_=br(D)?await D.parse(J):J}catch(q){const W=q instanceof Error?q.message:String(q);this._addMessage({role:r,tool_call_id:U,content:W});continue}const C=await D.function(_,this),L=re(this,te,"m",bs).call(this,C);if(this._addMessage({role:r,tool_call_id:U,content:L}),c)return}}}}te=new WeakSet,ps=function(){return re(this,te,"m",An).call(this).content??null},An=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(dt(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new S("stream ended without producing a ChatCompletionMessage with role=assistant")},gs=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(dt(t)&&t?.function_call)return t.function_call;if(dt(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},ys=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Sa(t)&&t.content!=null||Aa(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>n.role==="assistant"&&n.tool_calls?.some(r=>r.type==="function"&&r.id===t.tool_call_id)))return t.content}},_s=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Ra=function(e){if(e.n!=null&&e.n>1)throw new S("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},bs=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Mt extends Ta{static runFunctions(e,t,n){const r=new Mt,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new Mt,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),dt(e)&&e.content&&this._emit("content",e.content)}}const Ea=1,Ia=2,Na=4,Oa=8,ja=16,$a=32,Ma=64,Fa=128,Za=256,Da=Fa|Za,La=ja|$a|Da|Ma,Ba=Ea|Ia|La,Ua=Na|Oa,vo=Ba|Ua,K={STR:Ea,NUM:Ia,ARR:Na,OBJ:Oa,NULL:ja,BOOL:$a,NAN:Ma,INFINITY:Fa,MINUS_INFINITY:Za,INF:Da,SPECIAL:La,ATOM:Ba,COLLECTION:Ua,ALL:vo};class wo extends Error{}class ko extends Error{}function So(s,e=K.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return Ao(s.trim(),e)}const Ao=(s,e)=>{const t=s.length;let n=0;const r=p=>{throw new wo(`${p} at position ${n}`)},a=p=>{throw new ko(`${p} at position ${n}`)},i=()=>(f(),n>=t&&r("Unexpected end of input"),s[n]==='"'?o():s[n]==="{"?c():s[n]==="["?l():s.substring(n,n+4)==="null"||K.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||K.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||K.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||K.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||K.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||K.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):d()),o=()=>{const p=n;let g=!1;for(n++;n<t&&(s[n]!=='"'||g&&s[n-1]==="\\");)g=s[n]==="\\"?!g:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(p,++n-Number(g)))}catch(N){a(String(N))}else if(K.STR&e)try{return JSON.parse(s.substring(p,n-Number(g))+'"')}catch{return JSON.parse(s.substring(p,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},c=()=>{n++,f();const p={};try{for(;s[n]!=="}";){if(f(),n>=t&&K.OBJ&e)return p;const g=o();f(),n++;try{const N=i();Object.defineProperty(p,g,{value:N,writable:!0,enumerable:!0,configurable:!0})}catch(N){if(K.OBJ&e)return p;throw N}f(),s[n]===","&&n++}}catch{if(K.OBJ&e)return p;r("Expected '}' at end of object")}return n++,p},l=()=>{n++;const p=[];try{for(;s[n]!=="]";)p.push(i()),f(),s[n]===","&&n++}catch{if(K.ARR&e)return p;r("Expected ']' at end of array")}return n++,p},d=()=>{if(n===0){s==="-"&&K.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(g){if(K.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch{}a(String(g))}}const p=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(K.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(p,n))}catch{s.substring(p,n)==="-"&&K.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(p,s.lastIndexOf("e")))}catch(N){a(String(N))}}},f=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return i()},vr=s=>So(s,K.ALL^K.NUM);var nt=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Z=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},H,Te,st,$e,ns,dn,ss,rs,as,fn,is,wr;class Ft extends Ta{constructor(e){super(),H.add(this),Te.set(this,void 0),st.set(this,void 0),$e.set(this,void 0),nt(this,Te,e,"f"),nt(this,st,[],"f")}get currentChatCompletionSnapshot(){return Z(this,$e,"f")}static fromReadableStream(e){const t=new Ft(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new Ft(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Z(this,H,"m",ns).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const i of a)Z(this,H,"m",ss).call(this,i);if(a.controller.signal?.aborted)throw new de;return this._addChatCompletion(Z(this,H,"m",fn).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Z(this,H,"m",ns).call(this),this._connected();const r=ke.fromReadableStream(e,this.controller);let a;for await(const i of r)a&&a!==i.id&&this._addChatCompletion(Z(this,H,"m",fn).call(this)),Z(this,H,"m",ss).call(this,i),a=i.id;if(r.controller.signal?.aborted)throw new de;return this._addChatCompletion(Z(this,H,"m",fn).call(this))}[(Te=new WeakMap,st=new WeakMap,$e=new WeakMap,H=new WeakSet,ns=function(){this.ended||nt(this,$e,void 0,"f")},dn=function(t){let n=Z(this,st,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Z(this,st,"f")[t.index]=n,n)},ss=function(t){if(this.ended)return;const n=Z(this,H,"m",wr).call(this,t);this._emit("chunk",t,n);for(const r of t.choices){const a=n.choices[r.index];r.delta.content!=null&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",r.delta.content,a.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),r.delta.refusal!=null&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:a.message.refusal}),r.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:a.logprobs?.content??[]}),r.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});const i=Z(this,H,"m",dn).call(this,a);a.finish_reason&&(Z(this,H,"m",as).call(this,a),i.current_tool_call_index!=null&&Z(this,H,"m",rs).call(this,a,i.current_tool_call_index));for(const o of r.delta.tool_calls??[])i.current_tool_call_index!==o.index&&(Z(this,H,"m",as).call(this,a),i.current_tool_call_index!=null&&Z(this,H,"m",rs).call(this,a,i.current_tool_call_index)),i.current_tool_call_index=o.index;for(const o of r.delta.tool_calls??[]){const c=a.message.tool_calls?.[o.index];c?.type&&(c?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:c.function?.name,index:o.index,arguments:c.function.arguments,parsed_arguments:c.function.parsed_arguments,arguments_delta:o.function?.arguments??""}):(c?.type,void 0))}}},rs=function(t,n){if(Z(this,H,"m",dn).call(this,t).done_tool_calls.has(n))return;const a=t.message.tool_calls?.[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const i=Z(this,Te,"f")?.tools?.find(o=>o.type==="function"&&o.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:Yt(i)?i.$parseRaw(a.function.arguments):i?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},as=function(t){const n=Z(this,H,"m",dn).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const r=Z(this,H,"m",is).call(this);this._emit("content.done",{content:t.message.content,parsed:r?r.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},fn=function(){if(this.ended)throw new S("stream has ended, this shouldn't happen");const t=Z(this,$e,"f");if(!t)throw new S("request ended without sending any chunks");return nt(this,$e,void 0,"f"),nt(this,st,[],"f"),Co(t,Z(this,Te,"f"))},is=function(){const t=Z(this,Te,"f")?.response_format;return js(t)?t:null},wr=function(t){var n,r,a,i;let o=Z(this,$e,"f");const{choices:c,...l}=t;o?Object.assign(o,l):o=nt(this,$e,{...l,choices:[]},"f");for(const{delta:d,finish_reason:f,index:p,logprobs:g=null,...N}of t.choices){let v=o.choices[p];if(v||(v=o.choices[p]={finish_reason:f,index:p,message:{},logprobs:g,...N}),g)if(!v.logprobs)v.logprobs=Object.assign({},g);else{const{content:C,refusal:L,...q}=g;Object.assign(v.logprobs,q),C&&((n=v.logprobs).content??(n.content=[]),v.logprobs.content.push(...C)),L&&((r=v.logprobs).refusal??(r.refusal=[]),v.logprobs.refusal.push(...L))}if(f&&(v.finish_reason=f,Z(this,Te,"f")&&Pa(Z(this,Te,"f")))){if(f==="length")throw new oa;if(f==="content_filter")throw new la}if(Object.assign(v,N),!d)continue;const{content:B,refusal:U,function_call:k,role:J,tool_calls:D,..._}=d;if(Object.assign(v.message,_),U&&(v.message.refusal=(v.message.refusal||"")+U),J&&(v.message.role=J),k&&(v.message.function_call?(k.name&&(v.message.function_call.name=k.name),k.arguments&&((a=v.message.function_call).arguments??(a.arguments=""),v.message.function_call.arguments+=k.arguments)):v.message.function_call=k),B&&(v.message.content=(v.message.content||"")+B,!v.message.refusal&&Z(this,H,"m",is).call(this)&&(v.message.parsed=vr(v.message.content))),D){v.message.tool_calls||(v.message.tool_calls=[]);for(const{index:C,id:L,type:q,function:W,...M}of D){const j=(i=v.message.tool_calls)[C]??(i[C]={});Object.assign(j,M),L&&(j.id=L),q&&(j.type=q),W&&(j.function??(j.function={name:W.name??"",arguments:""})),W?.name&&(j.function.name=W.name),W?.arguments&&(j.function.arguments+=W.arguments,bo(Z(this,Te,"f"),j)&&(j.function.parsed_arguments=vr(j.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ke(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Co(s,e){const{id:t,choices:n,created:r,model:a,system_fingerprint:i,...o}=s,c={...o,id:t,choices:n.map(({message:l,finish_reason:d,index:f,logprobs:p,...g})=>{if(!d)throw new S(`missing finish_reason for choice ${f}`);const{content:N=null,function_call:v,tool_calls:B,...U}=l,k=l.role;if(!k)throw new S(`missing role for choice ${f}`);if(v){const{arguments:J,name:D}=v;if(J==null)throw new S(`missing function_call.arguments for choice ${f}`);if(!D)throw new S(`missing function_call.name for choice ${f}`);return{...g,message:{content:N,function_call:{arguments:J,name:D},role:k,refusal:l.refusal??null},finish_reason:d,index:f,logprobs:p}}return B?{...g,index:f,finish_reason:d,logprobs:p,message:{...U,role:k,content:N,refusal:l.refusal??null,tool_calls:B.map((J,D)=>{const{function:_,type:C,id:L,...q}=J,{arguments:W,name:M,...j}=_||{};if(L==null)throw new S(`missing choices[${f}].tool_calls[${D}].id
${hn(s)}`);if(C==null)throw new S(`missing choices[${f}].tool_calls[${D}].type
${hn(s)}`);if(M==null)throw new S(`missing choices[${f}].tool_calls[${D}].function.name
${hn(s)}`);if(W==null)throw new S(`missing choices[${f}].tool_calls[${D}].function.arguments
${hn(s)}`);return{...q,id:L,type:C,function:{...j,name:M,arguments:W}}})}}:{...g,message:{...U,content:N,role:k,refusal:l.refusal??null},finish_reason:d,index:f,logprobs:p}}),created:r,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return go(c,e)}function hn(s){return JSON.stringify(s)}class ft extends Ft{static fromReadableStream(e){const t=new ft(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const r=new ft(null),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new ft(t),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}}let Va=class extends I{parse(e,t){return xo(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>$s(n,e))}runFunctions(e,t){return e.stream?ft.runFunctions(this._client,e,t):Mt.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?ft.runTools(this._client,e,t):Mt.runTools(this._client,e,t)}stream(e,t){return Ft.createChatCompletion(this._client,e,t)}};class xs extends I{constructor(){super(...arguments),this.completions=new Va(this._client)}}(function(s){s.Completions=Va})(xs||(xs={}));class za extends I{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Wa extends I{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Vn extends I{constructor(){super(...arguments),this.sessions=new za(this._client),this.transcriptionSessions=new Wa(this._client)}}Vn.Sessions=za;Vn.TranscriptionSessions=Wa;var w=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},oe=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Q,vs,we,xn,pe,qe,ct,Je,Cn,ce,vn,wn,$t,Tt,Et,kr,Sr,Ar,Cr,Pr,Rr,Tr;class ge extends Os{constructor(){super(...arguments),Q.add(this),vs.set(this,[]),we.set(this,{}),xn.set(this,{}),pe.set(this,void 0),qe.set(this,void 0),ct.set(this,void 0),Je.set(this,void 0),Cn.set(this,void 0),ce.set(this,void 0),vn.set(this,void 0),wn.set(this,void 0),$t.set(this,void 0)}[(vs=new WeakMap,we=new WeakMap,xn=new WeakMap,pe=new WeakMap,qe=new WeakMap,ct=new WeakMap,Je=new WeakMap,Cn=new WeakMap,ce=new WeakMap,vn=new WeakMap,wn=new WeakMap,$t=new WeakMap,Q=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ge;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=ke.fromReadableStream(e,this.controller);for await(const a of r)w(this,Q,"m",Tt).call(this,a);if(r.controller.signal?.aborted)throw new de;return this._addRun(w(this,Q,"m",Et).call(this))}toReadableStream(){return new ke(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,a){const i=new ge;return i._run(()=>i._runToolAssistantStream(e,t,n,r,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,r,a){const i=a?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.submitToolOutputs(t,n,o,{...a,signal:this.controller.signal});this._connected();for await(const l of c)w(this,Q,"m",Tt).call(this,l);if(c.controller.signal?.aborted)throw new de;return this._addRun(w(this,Q,"m",Et).call(this))}static createThreadAssistantStream(e,t,n){const r=new ge;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){const a=new ge;return a._run(()=>a._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return w(this,vn,"f")}currentRun(){return w(this,wn,"f")}currentMessageSnapshot(){return w(this,pe,"f")}currentRunStepSnapshot(){return w(this,$t,"f")}async finalRunSteps(){return await this.done(),Object.values(w(this,we,"f"))}async finalMessages(){return await this.done(),Object.values(w(this,xn,"f"))}async finalRun(){if(await this.done(),!w(this,qe,"f"))throw Error("Final run was not received.");return w(this,qe,"f")}async _createThreadAssistantStream(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const o of i)w(this,Q,"m",Tt).call(this,o);if(i.controller.signal?.aborted)throw new de;return this._addRun(w(this,Q,"m",Et).call(this))}async _createAssistantStream(e,t,n,r){const a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.create(t,i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)w(this,Q,"m",Tt).call(this,c);if(o.controller.signal?.aborted)throw new de;return this._addRun(w(this,Q,"m",Et).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let a=e[n];if(a==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(ts(a)&&ts(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...r);continue}for(const i of r){if(!ts(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const o=i.index;if(o==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const c=a[o];c==null?a.push(i):a[o]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,a){return await this._createToolAssistantStream(n,e,t,r,a)}}Tt=function(e){if(!this.ended)switch(oe(this,vn,e,"f"),w(this,Q,"m",Ar).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":w(this,Q,"m",Tr).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":w(this,Q,"m",Sr).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":w(this,Q,"m",kr).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Et=function(){if(this.ended)throw new S("stream has ended, this shouldn't happen");if(!w(this,qe,"f"))throw Error("Final run has not been received");return w(this,qe,"f")},kr=function(e){const[t,n]=w(this,Q,"m",Pr).call(this,e,w(this,pe,"f"));oe(this,pe,t,"f"),w(this,xn,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];a?.type=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,i=t.content[r.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=w(this,ct,"f")){if(w(this,Je,"f"))switch(w(this,Je,"f").type){case"text":this._emit("textDone",w(this,Je,"f").text,w(this,pe,"f"));break;case"image_file":this._emit("imageFileDone",w(this,Je,"f").image_file,w(this,pe,"f"));break}oe(this,ct,r.index,"f")}oe(this,Je,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(w(this,ct,"f")!==void 0){const r=e.data.content[w(this,ct,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,w(this,pe,"f"));break;case"text":this._emit("textDone",r.text,w(this,pe,"f"));break}}w(this,pe,"f")&&this._emit("messageDone",e.data),oe(this,pe,void 0,"f")}},Sr=function(e){const t=w(this,Q,"m",Cr).call(this,e);switch(oe(this,$t,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==w(this,Cn,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(w(this,ce,"f")&&this._emit("toolCallDone",w(this,ce,"f")),oe(this,Cn,a.index,"f"),oe(this,ce,t.step_details.tool_calls[a.index],"f"),w(this,ce,"f")&&this._emit("toolCallCreated",w(this,ce,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":oe(this,$t,void 0,"f"),e.data.step_details.type=="tool_calls"&&w(this,ce,"f")&&(this._emit("toolCallDone",w(this,ce,"f")),oe(this,ce,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Ar=function(e){w(this,vs,"f").push(e),this._emit("event",e)},Cr=function(e){switch(e.event){case"thread.run.step.created":return w(this,we,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=w(this,we,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=ge.accumulateDelta(t,n.delta);w(this,we,"f")[e.data.id]=r}return w(this,we,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":w(this,we,"f")[e.data.id]=e.data;break}if(w(this,we,"f")[e.data.id])return w(this,we,"f")[e.data.id];throw new Error("No snapshot available")},Pr=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=w(this,Q,"m",Rr).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Rr=function(e,t){return ge.accumulateDelta(t,e)},Tr=function(e){switch(oe(this,wn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":oe(this,qe,e.data,"f"),w(this,ce,"f")&&(this._emit("toolCallDone",w(this,ce,"f")),oe(this,ce,void 0,"f"));break}};class Ms extends I{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Fs,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class Fs extends ee{}Ms.MessagesPage=Fs;class Zs extends I{retrieve(e,t,n,r={},a){return G(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t,n={},r){return G(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Ds,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class Ds extends ee{}Zs.RunStepsPage=Ds;let en=class extends I{constructor(){super(...arguments),this.steps=new Zs(this._client)}create(e,t,n){const{include:r,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Ls,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return ge.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Kt(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return ge.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const a=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,a.id,r)}submitToolOutputsStream(e,t,n,r){return ge.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}};class Ls extends ee{}en.RunsPage=Ls;en.Steps=Zs;en.RunStepsPage=Ds;class _t extends I{constructor(){super(...arguments),this.runs=new en(this._client),this.messages=new Ms(this._client)}create(e={},t){return G(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return ge.createThreadAssistantStream(e,this._client.beta.threads,t)}}_t.Runs=en;_t.RunsPage=Ls;_t.Messages=Ms;_t.MessagesPage=Fs;class bt extends I{constructor(){super(...arguments),this.realtime=new Vn(this._client),this.chat=new xs(this._client),this.assistants=new Is(this._client),this.threads=new _t(this._client)}}bt.Realtime=Vn;bt.Assistants=Is;bt.AssistantsPage=Ns;bt.Threads=_t;class Ga extends I{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Ja extends I{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&Ze("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?a:(Ze("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(i=>(i&&i.data&&i.data.forEach(o=>{const c=o.embedding;o.embedding=ho(c)}),i)))}}class Bs extends I{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return G(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,Us,{query:n,...r})}}class Us extends ee{}Bs.OutputItemListResponsesPage=Us;class tn extends I{constructor(){super(...arguments),this.outputItems=new Bs(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,Vs,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class Vs extends ee{}tn.RunListResponsesPage=Vs;tn.OutputItems=Bs;tn.OutputItemListResponsesPage=Us;class nn extends I{constructor(){super(...arguments),this.runs=new tn(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/evals",zs,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class zs extends ee{}nn.EvalListResponsesPage=zs;nn.Runs=tn;nn.RunListResponsesPage=Vs;let Ws=class extends I{create(e,t){return this._client.post("/files",mt({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/files",Gs,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){const r=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await Kt(t),i=await this.retrieve(e),Date.now()-a>n)throw new Rs({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}};class Gs extends ee{}Ws.FileObjectsPage=Gs;class Js extends I{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,qs,{body:t,method:"post",...n})}retrieve(e,t={},n){return G(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions`,t)}}class qs extends Dn{}Js.PermissionCreateResponsesPage=qs;let zn=class extends I{constructor(){super(...arguments),this.permissions=new Js(this._client)}};zn.Permissions=Js;zn.PermissionCreateResponsesPage=qs;class Hs extends I{list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Xs,{query:t,...n})}}class Xs extends ee{}Hs.FineTuningJobCheckpointsPage=Xs;class xt extends I{constructor(){super(...arguments),this.checkpoints=new Hs(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Ks,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return G(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Qs,{query:t,...n})}}class Ks extends ee{}class Qs extends ee{}xt.FineTuningJobsPage=Ks;xt.FineTuningJobEventsPage=Qs;xt.Checkpoints=Hs;xt.FineTuningJobCheckpointsPage=Xs;class vt extends I{constructor(){super(...arguments),this.jobs=new xt(this._client),this.checkpoints=new zn(this._client)}}vt.Jobs=xt;vt.FineTuningJobsPage=Ks;vt.FineTuningJobEventsPage=Qs;vt.Checkpoints=zn;class qa extends I{createVariation(e,t){return this._client.post("/images/variations",mt({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",mt({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Ys extends I{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",er,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class er extends Dn{}Ys.ModelsPage=er;class Ha extends I{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function Po(s,e){return!e||!To(e)?{...s,output_parsed:null,output:s.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:Xa(s,e)}function Xa(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:No(e,r)};if(r.type==="message"){const a=r.content.map(i=>i.type==="output_text"?{...i,parsed:Ro(e,i.text)}:i);return{...r,content:a}}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||Ka(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function Ro(s,e){return s.text?.format?.type!=="json_schema"?null:"$parseRaw"in s.text?.format?(s.text?.format).$parseRaw(e):JSON.parse(e)}function To(s){return!!js(s.text?.format)}function Eo(s){return s?.$brand==="auto-parseable-tool"}function Io(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function No(s,e){const t=Io(s.tools??[],e.name);return{...e,...e,parsed_arguments:Eo(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null}}function Ka(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}class Qa extends I{list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,jo,{query:t,...n})}}var rt=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Me=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},at,mn,Fe,pn,Er,Ir,Nr,Or;class tr extends Os{constructor(e){super(),at.add(this),mn.set(this,void 0),Fe.set(this,void 0),pn.set(this,void 0),rt(this,mn,e,"f")}static createResponse(e,t,n){const r=new tr(t);return r._run(()=>r._createResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createResponse(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Me(this,at,"m",Er).call(this);const a=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const i of a)Me(this,at,"m",Ir).call(this,i);if(a.controller.signal?.aborted)throw new de;return Me(this,at,"m",Nr).call(this)}[(mn=new WeakMap,Fe=new WeakMap,pn=new WeakMap,at=new WeakSet,Er=function(){this.ended||rt(this,Fe,void 0,"f")},Ir=function(t){if(this.ended)return;const n=Me(this,at,"m",Or).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new S(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new S(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new S(`expected content to be 'output_text', got ${a.type}`);this._emit("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new S(`missing output at index ${t.output_index}`);r.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:r.arguments});break}default:this._emit(t.type,t);break}},Nr=function(){if(this.ended)throw new S("stream has ended, this shouldn't happen");const t=Me(this,Fe,"f");if(!t)throw new S("request ended without sending any events");rt(this,Fe,void 0,"f");const n=Oo(t,Me(this,mn,"f"));return rt(this,pn,n,"f"),n},Or=function(t){let n=Me(this,Fe,"f");if(!n){if(t.type!=="response.created")throw new S(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=rt(this,Fe,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const r=n.output[t.output_index];if(!r)throw new S(`missing output at index ${t.output_index}`);r.type==="message"&&r.content.push(t.part);break}case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new S(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new S(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new S(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new S(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.completed":{rt(this,Fe,t.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Me(this,pn,"f");if(!e)throw new S("stream ended without producing a ChatCompletion");return e}}function Oo(s,e){return Po(s,e)}class nr extends I{constructor(){super(...arguments),this.inputItems=new Qa(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&Ka(n),n))}retrieve(e,t={},n){return G(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...n})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>Xa(n,e))}stream(e,t){return tr.createResponse(this._client,e,t)}}class jo extends ee{}nr.InputItems=Qa;class Ya extends I{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,mt({body:t,...n}))}}class sr extends I{constructor(){super(...arguments),this.parts=new Ya(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}sr.Parts=Ya;const $o=async s=>{const e=await Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n};class Wn extends I{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return G(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Gn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=a.data;switch(i.status){case"in_progress":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Kt(o);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,rr,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class Gn extends ee{}class rr extends Dn{}Wn.VectorStoreFilesPage=Gn;Wn.FileContentResponsesPage=rr;class ei extends I{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return G(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Gn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await Kt(o);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=r?.maxConcurrency??5,i=Math.min(a,t.length),o=this._client,c=t.values(),l=[...n];async function d(p){for(let g of p){const N=await o.files.create({file:g,purpose:"assistants"},r);l.push(N.id)}}const f=Array(i).fill(c).map(d);return await $o(f),await this.createAndPoll(e,{file_ids:l})}}class Ve extends I{constructor(){super(...arguments),this.files=new Wn(this._client),this.fileBatches=new ei(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/vector_stores",ar,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,ir,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class ar extends ee{}class ir extends Dn{}Ve.VectorStoresPage=ar;Ve.VectorStoreSearchResponsesPage=ir;Ve.Files=Wn;Ve.VectorStoreFilesPage=Gn;Ve.FileContentResponsesPage=rr;Ve.FileBatches=ei;var ti;class R extends eo{constructor({baseURL:e=cn("OPENAI_BASE_URL"),apiKey:t=cn("OPENAI_API_KEY"),organization:n=cn("OPENAI_ORG_ID")??null,project:r=cn("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new S("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&uo())throw new S(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Ga(this),this.chat=new Un(this),this.embeddings=new Ja(this),this.files=new Ws(this),this.images=new qa(this),this.audio=new Qt(this),this.moderations=new Ha(this),this.models=new Ys(this),this.fineTuning=new vt(this),this.vectorStores=new Ve(this),this.beta=new bt(this),this.batches=new Ts(this),this.uploads=new sr(this),this.responses=new nr(this),this.evals=new nn(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Di(e,{arrayFormat:"brackets"})}}ti=R;R.OpenAI=ti;R.DEFAULT_TIMEOUT=6e5;R.OpenAIError=S;R.APIError=Y;R.APIConnectionError=$n;R.APIConnectionTimeoutError=Rs;R.APIUserAbortError=de;R.NotFoundError=na;R.ConflictError=sa;R.RateLimitError=aa;R.BadRequestError=Yr;R.AuthenticationError=ea;R.InternalServerError=ia;R.PermissionDeniedError=ta;R.UnprocessableEntityError=ra;R.toFile=fa;R.fileFromPath=Wr;R.Completions=Ga;R.Chat=Un;R.ChatCompletionsPage=Bn;R.Embeddings=Ja;R.Files=Ws;R.FileObjectsPage=Gs;R.Images=qa;R.Audio=Qt;R.Moderations=Ha;R.Models=Ys;R.ModelsPage=er;R.FineTuning=vt;R.VectorStores=Ve;R.VectorStoresPage=ar;R.VectorStoreSearchResponsesPage=ir;R.Beta=bt;R.Batches=Ts;R.BatchesPage=Es;R.Uploads=sr;R.Responses=nr;R.Evals=nn;R.EvalListResponsesPage=zs;const Mo=Symbol("Let zodToJsonSchema decide on which parser to use"),jr={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Fo=s=>typeof s=="string"?{...jr,basePath:["#"],definitions:{},name:s}:{...jr,basePath:["#"],definitions:{},...s},ws=s=>"_def"in s?s._def:s;function Zo(s){if(!s)return!0;for(const e in s)return!1;return!0}const Do=s=>{const e=Fo(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,r])=>[ws(r),{def:ws(r),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function ni(s,e,t,n){n?.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t})}function F(s,e,t,n,r){s[e]=t,ni(s,e,n,r)}var O;(function(s){s.assertEqual=r=>r;function e(r){}s.assertIs=e;function t(r){throw new Error}s.assertNever=t,s.arrayToEnum=r=>{const a={};for(const i of r)a[i]=i;return a},s.getValidEnumValues=r=>{const a=s.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),i={};for(const o of a)i[o]=r[o];return s.objectValues(i)},s.objectValues=r=>s.objectKeys(r).map(function(a){return r[a]}),s.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const a=[];for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&a.push(i);return a},s.find=(r,a)=>{for(const i of r)if(a(i))return i},s.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,a=" | "){return r.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}s.joinValues=n,s.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(O||(O={}));var ks;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(ks||(ks={}));const b=O.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ne=s=>{switch(typeof s){case"undefined":return b.undefined;case"string":return b.string;case"number":return isNaN(s)?b.nan:b.number;case"boolean":return b.boolean;case"function":return b.function;case"bigint":return b.bigint;case"symbol":return b.symbol;case"object":return Array.isArray(s)?b.array:s===null?b.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?b.promise:typeof Map<"u"&&s instanceof Map?b.map:typeof Set<"u"&&s instanceof Set?b.set:typeof Date<"u"&&s instanceof Date?b.date:b.object;default:return b.unknown}},h=O.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Lo=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class ue extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},n={_errors:[]},r=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(r);else if(i.code==="invalid_return_type")r(i.returnTypeError);else if(i.code==="invalid_arguments")r(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let o=n,c=0;for(;c<i.path.length;){const l=i.path[c];c===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(t(i))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return r(this),n}static assert(e){if(!(e instanceof ue))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,O.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ue.create=s=>new ue(s);const pt=(s,e)=>{let t;switch(s.code){case h.invalid_type:s.received===b.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case h.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,O.jsonStringifyReplacer)}`;break;case h.unrecognized_keys:t=`Unrecognized key(s) in object: ${O.joinValues(s.keys,", ")}`;break;case h.invalid_union:t="Invalid input";break;case h.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${O.joinValues(s.options)}`;break;case h.invalid_enum_value:t=`Invalid enum value. Expected ${O.joinValues(s.options)}, received '${s.received}'`;break;case h.invalid_arguments:t="Invalid function arguments";break;case h.invalid_return_type:t="Invalid function return type";break;case h.invalid_date:t="Invalid date";break;case h.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:O.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case h.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case h.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case h.custom:t="Invalid input";break;case h.invalid_intersection_types:t="Intersection results could not be merged";break;case h.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case h.not_finite:t="Number must be finite";break;default:t=e.defaultError,O.assertNever(s)}return{message:t}};let si=pt;function Bo(s){si=s}function Pn(){return si}const Rn=s=>{const{data:e,path:t,errorMaps:n,issueData:r}=s,a=[...t,...r.path||[]],i={...r,path:a};if(r.message!==void 0)return{...r,path:a,message:r.message};let o="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)o=l(i,{data:e,defaultError:o}).message;return{...r,path:a,message:o}},Uo=[];function y(s,e){const t=Pn(),n=Rn({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===pt?void 0:pt].filter(r=>!!r)});s.common.issues.push(n)}class ne{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if(r.status==="aborted")return A;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const a=await r.key,i=await r.value;n.push({key:a,value:i})}return ne.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:a,value:i}=r;if(a.status==="aborted"||i.status==="aborted")return A;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||r.alwaysSet)&&(n[a.value]=i.value)}return{status:e.value,value:n}}}const A=Object.freeze({status:"aborted"}),ut=s=>({status:"dirty",value:s}),se=s=>({status:"valid",value:s}),Ss=s=>s.status==="aborted",As=s=>s.status==="dirty",Xe=s=>s.status==="valid",Zt=s=>typeof Promise<"u"&&s instanceof Promise;function Tn(s,e,t,n){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(s)}function ri(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}var x;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(x||(x={}));var It,Nt;class Ae{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const $r=(s,e)=>{if(Xe(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ue(s.common.issues);return this._error=t,this._error}}};function P(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:r}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,o)=>{var c,l;const{message:d}=s;return i.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(c=d??n)!==null&&c!==void 0?c:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(l=d??t)!==null&&l!==void 0?l:o.defaultError}},description:r}}class E{get description(){return this._def.description}_getType(e){return Ne(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ne(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ne,ctx:{common:e.parent.common,data:e.data,parsedType:Ne(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Zt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ne(e)},a=this._parseSync({data:e,path:r.path,parent:r});return $r(r,a)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ne(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return Xe(a)?{value:a.value}:{issues:r.common.issues}}catch(a){!((n=(t=a?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>Xe(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ne(e)},r=this._parse({data:e,path:n.path,parent:n}),a=await(Zt(r)?r:Promise.resolve(r));return $r(n,a)}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,a)=>{const i=e(r),o=()=>a.addIssue({code:h.custom,...n(r)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new be({schema:this,typeName:m.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Se.create(this,this._def)}nullable(){return Ue.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _e.create(this)}promise(){return yt.create(this,this._def)}or(e){return Ut.create([this,e],this._def)}and(e){return Vt.create(this,e,this._def)}transform(e){return new be({...P(this._def),schema:this,typeName:m.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new qt({...P(this._def),innerType:this,defaultValue:t,typeName:m.ZodDefault})}brand(){return new or({typeName:m.ZodBranded,type:this,...P(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Ht({...P(this._def),innerType:this,catchValue:t,typeName:m.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return sn.create(this,e)}readonly(){return Xt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Vo=/^c[^\s-]{8,}$/i,zo=/^[0-9a-z]+$/,Wo=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Go=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Jo=/^[a-z0-9_-]{21}$/i,qo=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ho=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Xo=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ko="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let os;const Qo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Yo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,el=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,tl=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nl=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,sl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ai="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rl=new RegExp(`^${ai}$`);function ii(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function al(s){return new RegExp(`^${ii(s)}$`)}function oi(s){let e=`${ai}T${ii(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function il(s,e){return!!((e==="v4"||!e)&&Qo.test(s)||(e==="v6"||!e)&&el.test(s))}function ol(s,e){if(!qo.test(s))return!1;try{const[t]=s.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function ll(s,e){return!!((e==="v4"||!e)&&Yo.test(s)||(e==="v6"||!e)&&tl.test(s))}class ye extends E{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==b.string){const a=this._getOrReturnCtx(e);return y(a,{code:h.invalid_type,expected:b.string,received:a.parsedType}),A}const n=new ne;let r;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(r=this._getOrReturnCtx(e,r),i?y(r,{code:h.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&y(r,{code:h.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")Xo.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"email",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")os||(os=new RegExp(Ko,"u")),os.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"emoji",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")Go.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"uuid",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")Jo.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"nanoid",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")Vo.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"cuid",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")zo.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"cuid2",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")Wo.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"ulid",code:h.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),y(r,{validation:"url",code:h.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"regex",code:h.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?oi(a).test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?rl.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?al(a).test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?Ho.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"duration",code:h.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?il(e.data,a.version)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"ip",code:h.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?ol(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"jwt",code:h.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?ll(e.data,a.version)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"cidr",code:h.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?nl.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"base64",code:h.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?sl.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"base64url",code:h.invalid_string,message:a.message}),n.dirty()):O.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(r=>e.test(r),{validation:t,code:h.invalid_string,...x.errToObj(n)})}_addCheck(e){return new ye({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...x.errToObj(e)})}url(e){return this._addCheck({kind:"url",...x.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...x.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...x.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...x.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...x.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...x.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...x.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...x.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...x.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...x.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...x.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...x.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...x.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...x.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...x.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...x.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...x.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...x.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...x.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...x.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...x.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...x.errToObj(t)})}nonempty(e){return this.min(1,x.errToObj(e))}trim(){return new ye({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ye({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ye({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ye.create=s=>{var e;return new ye({checks:[],typeName:m.ZodString,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...P(s)})};function cl(s,e){const t=(s.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,a=parseInt(s.toFixed(r).replace(".","")),i=parseInt(e.toFixed(r).replace(".",""));return a%i/Math.pow(10,r)}class De extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==b.number){const a=this._getOrReturnCtx(e);return y(a,{code:h.invalid_type,expected:b.number,received:a.parsedType}),A}let n;const r=new ne;for(const a of this._def.checks)a.kind==="int"?O.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:h.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?cl(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:h.not_finite,message:a.message}),r.dirty()):O.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,n,r){return new De({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:x.toString(r)}]})}_addCheck(e){return new De({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:x.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:x.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:x.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:x.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&O.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}De.create=s=>new De({checks:[],typeName:m.ZodNumber,coerce:s?.coerce||!1,...P(s)});class Le extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==b.bigint)return this._getInvalidInput(e);let n;const r=new ne;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),y(n,{code:h.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):O.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:b.bigint,received:t.parsedType}),A}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,n,r){return new Le({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:x.toString(r)}]})}_addCheck(e){return new Le({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Le.create=s=>{var e;return new Le({checks:[],typeName:m.ZodBigInt,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...P(s)})};class Dt extends E{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==b.boolean){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.boolean,received:n.parsedType}),A}return se(e.data)}}Dt.create=s=>new Dt({typeName:m.ZodBoolean,coerce:s?.coerce||!1,...P(s)});class Ke extends E{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==b.date){const a=this._getOrReturnCtx(e);return y(a,{code:h.invalid_type,expected:b.date,received:a.parsedType}),A}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return y(a,{code:h.invalid_date}),A}const n=new ne;let r;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):O.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ke({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:x.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:x.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ke.create=s=>new Ke({checks:[],coerce:s?.coerce||!1,typeName:m.ZodDate,...P(s)});class En extends E{_parse(e){if(this._getType(e)!==b.symbol){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.symbol,received:n.parsedType}),A}return se(e.data)}}En.create=s=>new En({typeName:m.ZodSymbol,...P(s)});class Lt extends E{_parse(e){if(this._getType(e)!==b.undefined){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.undefined,received:n.parsedType}),A}return se(e.data)}}Lt.create=s=>new Lt({typeName:m.ZodUndefined,...P(s)});class Bt extends E{_parse(e){if(this._getType(e)!==b.null){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.null,received:n.parsedType}),A}return se(e.data)}}Bt.create=s=>new Bt({typeName:m.ZodNull,...P(s)});class gt extends E{constructor(){super(...arguments),this._any=!0}_parse(e){return se(e.data)}}gt.create=s=>new gt({typeName:m.ZodAny,...P(s)});class He extends E{constructor(){super(...arguments),this._unknown=!0}_parse(e){return se(e.data)}}He.create=s=>new He({typeName:m.ZodUnknown,...P(s)});class Oe extends E{_parse(e){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:b.never,received:t.parsedType}),A}}Oe.create=s=>new Oe({typeName:m.ZodNever,...P(s)});class In extends E{_parse(e){if(this._getType(e)!==b.undefined){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.void,received:n.parsedType}),A}return se(e.data)}}In.create=s=>new In({typeName:m.ZodVoid,...P(s)});class _e extends E{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==b.array)return y(t,{code:h.invalid_type,expected:b.array,received:t.parsedType}),A;if(r.exactLength!==null){const i=t.data.length>r.exactLength.value,o=t.data.length<r.exactLength.value;(i||o)&&(y(t,{code:i?h.too_big:h.too_small,minimum:o?r.exactLength.value:void 0,maximum:i?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(y(t,{code:h.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(y(t,{code:h.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>r.type._parseAsync(new Ae(t,i,t.path,o)))).then(i=>ne.mergeArray(n,i));const a=[...t.data].map((i,o)=>r.type._parseSync(new Ae(t,i,t.path,o)));return ne.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new _e({...this._def,minLength:{value:e,message:x.toString(t)}})}max(e,t){return new _e({...this._def,maxLength:{value:e,message:x.toString(t)}})}length(e,t){return new _e({...this._def,exactLength:{value:e,message:x.toString(t)}})}nonempty(e){return this.min(1,e)}}_e.create=(s,e)=>new _e({type:s,minLength:null,maxLength:null,exactLength:null,typeName:m.ZodArray,...P(e)});function lt(s){if(s instanceof z){const e={};for(const t in s.shape){const n=s.shape[t];e[t]=Se.create(lt(n))}return new z({...s._def,shape:()=>e})}else return s instanceof _e?new _e({...s._def,type:lt(s.element)}):s instanceof Se?Se.create(lt(s.unwrap())):s instanceof Ue?Ue.create(lt(s.unwrap())):s instanceof Ce?Ce.create(s.items.map(e=>lt(e))):s}class z extends E{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=O.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==b.object){const l=this._getOrReturnCtx(e);return y(l,{code:h.invalid_type,expected:b.object,received:l.parsedType}),A}const{status:n,ctx:r}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Oe&&this._def.unknownKeys==="strip"))for(const l in r.data)i.includes(l)||o.push(l);const c=[];for(const l of i){const d=a[l],f=r.data[l];c.push({key:{status:"valid",value:l},value:d._parse(new Ae(r,f,r.path,l)),alwaysSet:l in r.data})}if(this._def.catchall instanceof Oe){const l=this._def.unknownKeys;if(l==="passthrough")for(const d of o)c.push({key:{status:"valid",value:d},value:{status:"valid",value:r.data[d]}});else if(l==="strict")o.length>0&&(y(r,{code:h.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const d of o){const f=r.data[d];c.push({key:{status:"valid",value:d},value:l._parse(new Ae(r,f,r.path,d)),alwaysSet:d in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const l=[];for(const d of c){const f=await d.key,p=await d.value;l.push({key:f,value:p,alwaysSet:d.alwaysSet})}return l}).then(l=>ne.mergeObjectSync(n,l)):ne.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return x.errToObj,new z({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var r,a,i,o;const c=(i=(a=(r=this._def).errorMap)===null||a===void 0?void 0:a.call(r,t,n).message)!==null&&i!==void 0?i:n.defaultError;return t.code==="unrecognized_keys"?{message:(o=x.errToObj(e).message)!==null&&o!==void 0?o:c}:{message:c}}}:{}})}strip(){return new z({...this._def,unknownKeys:"strip"})}passthrough(){return new z({...this._def,unknownKeys:"passthrough"})}extend(e){return new z({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new z({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:m.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new z({...this._def,catchall:e})}pick(e){const t={};return O.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new z({...this._def,shape:()=>t})}omit(e){const t={};return O.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new z({...this._def,shape:()=>t})}deepPartial(){return lt(this)}partial(e){const t={};return O.objectKeys(this.shape).forEach(n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}),new z({...this._def,shape:()=>t})}required(e){const t={};return O.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof Se;)a=a._def.innerType;t[n]=a}}),new z({...this._def,shape:()=>t})}keyof(){return li(O.objectKeys(this.shape))}}z.create=(s,e)=>new z({shape:()=>s,unknownKeys:"strip",catchall:Oe.create(),typeName:m.ZodObject,...P(e)});z.strictCreate=(s,e)=>new z({shape:()=>s,unknownKeys:"strict",catchall:Oe.create(),typeName:m.ZodObject,...P(e)});z.lazycreate=(s,e)=>new z({shape:s,unknownKeys:"strip",catchall:Oe.create(),typeName:m.ZodObject,...P(e)});class Ut extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new ue(o.ctx.common.issues));return y(t,{code:h.invalid_union,unionErrors:i}),A}if(t.common.async)return Promise.all(n.map(async a=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(r);{let a;const i=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:l});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(c=>new ue(c));return y(t,{code:h.invalid_union,unionErrors:o}),A}}get options(){return this._def.options}}Ut.create=(s,e)=>new Ut({options:s,typeName:m.ZodUnion,...P(e)});const Ie=s=>s instanceof Wt?Ie(s.schema):s instanceof be?Ie(s.innerType()):s instanceof Gt?[s.value]:s instanceof Be?s.options:s instanceof Jt?O.objectValues(s.enum):s instanceof qt?Ie(s._def.innerType):s instanceof Lt?[void 0]:s instanceof Bt?[null]:s instanceof Se?[void 0,...Ie(s.unwrap())]:s instanceof Ue?[null,...Ie(s.unwrap())]:s instanceof or||s instanceof Xt?Ie(s.unwrap()):s instanceof Ht?Ie(s._def.innerType):[];class Jn extends E{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.object)return y(t,{code:h.invalid_type,expected:b.object,received:t.parsedType}),A;const n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(y(t,{code:h.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),A)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const a of t){const i=Ie(a.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(r.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);r.set(o,a)}}return new Jn({typeName:m.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...P(n)})}}function Cs(s,e){const t=Ne(s),n=Ne(e);if(s===e)return{valid:!0,data:s};if(t===b.object&&n===b.object){const r=O.objectKeys(e),a=O.objectKeys(s).filter(o=>r.indexOf(o)!==-1),i={...s,...e};for(const o of a){const c=Cs(s[o],e[o]);if(!c.valid)return{valid:!1};i[o]=c.data}return{valid:!0,data:i}}else if(t===b.array&&n===b.array){if(s.length!==e.length)return{valid:!1};const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=e[a],c=Cs(i,o);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===b.date&&n===b.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class Vt extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(a,i)=>{if(Ss(a)||Ss(i))return A;const o=Cs(a.value,i.value);return o.valid?((As(a)||As(i))&&t.dirty(),{status:t.value,value:o.data}):(y(n,{code:h.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,i])=>r(a,i)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Vt.create=(s,e,t)=>new Vt({left:s,right:e,typeName:m.ZodIntersection,...P(t)});class Ce extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==b.array)return y(n,{code:h.invalid_type,expected:b.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return y(n,{code:h.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(y(n,{code:h.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map((i,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new Ae(n,i,n.path,o)):null}).filter(i=>!!i);return n.common.async?Promise.all(a).then(i=>ne.mergeArray(t,i)):ne.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Ce({...this._def,rest:e})}}Ce.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ce({items:s,typeName:m.ZodTuple,rest:null,...P(e)})};class zt extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==b.object)return y(n,{code:h.invalid_type,expected:b.object,received:n.parsedType}),A;const r=[],a=this._def.keyType,i=this._def.valueType;for(const o in n.data)r.push({key:a._parse(new Ae(n,o,n.path,o)),value:i._parse(new Ae(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?ne.mergeObjectAsync(t,r):ne.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof E?new zt({keyType:e,valueType:t,typeName:m.ZodRecord,...P(n)}):new zt({keyType:ye.create(),valueType:e,typeName:m.ZodRecord,...P(t)})}}class Nn extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==b.map)return y(n,{code:h.invalid_type,expected:b.map,received:n.parsedType}),A;const r=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map(([o,c],l)=>({key:r._parse(new Ae(n,o,n.path,[l,"key"])),value:a._parse(new Ae(n,c,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of i){const l=await c.key,d=await c.value;if(l.status==="aborted"||d.status==="aborted")return A;(l.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(l.value,d.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const c of i){const l=c.key,d=c.value;if(l.status==="aborted"||d.status==="aborted")return A;(l.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(l.value,d.value)}return{status:t.value,value:o}}}}Nn.create=(s,e,t)=>new Nn({valueType:e,keyType:s,typeName:m.ZodMap,...P(t)});class Qe extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==b.set)return y(n,{code:h.invalid_type,expected:b.set,received:n.parsedType}),A;const r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(y(n,{code:h.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(y(n,{code:h.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function i(c){const l=new Set;for(const d of c){if(d.status==="aborted")return A;d.status==="dirty"&&t.dirty(),l.add(d.value)}return{status:t.value,value:l}}const o=[...n.data.values()].map((c,l)=>a._parse(new Ae(n,c,n.path,l)));return n.common.async?Promise.all(o).then(c=>i(c)):i(o)}min(e,t){return new Qe({...this._def,minSize:{value:e,message:x.toString(t)}})}max(e,t){return new Qe({...this._def,maxSize:{value:e,message:x.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Qe.create=(s,e)=>new Qe({valueType:s,minSize:null,maxSize:null,typeName:m.ZodSet,...P(e)});class ht extends E{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.function)return y(t,{code:h.invalid_type,expected:b.function,received:t.parsedType}),A;function n(o,c){return Rn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Pn(),pt].filter(l=>!!l),issueData:{code:h.invalid_arguments,argumentsError:c}})}function r(o,c){return Rn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Pn(),pt].filter(l=>!!l),issueData:{code:h.invalid_return_type,returnTypeError:c}})}const a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof yt){const o=this;return se(async function(...c){const l=new ue([]),d=await o._def.args.parseAsync(c,a).catch(g=>{throw l.addIssue(n(c,g)),l}),f=await Reflect.apply(i,this,d);return await o._def.returns._def.type.parseAsync(f,a).catch(g=>{throw l.addIssue(r(f,g)),l})})}else{const o=this;return se(function(...c){const l=o._def.args.safeParse(c,a);if(!l.success)throw new ue([n(c,l.error)]);const d=Reflect.apply(i,this,l.data),f=o._def.returns.safeParse(d,a);if(!f.success)throw new ue([r(d,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ht({...this._def,args:Ce.create(e).rest(He.create())})}returns(e){return new ht({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ht({args:e||Ce.create([]).rest(He.create()),returns:t||He.create(),typeName:m.ZodFunction,...P(n)})}}class Wt extends E{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Wt.create=(s,e)=>new Wt({getter:s,typeName:m.ZodLazy,...P(e)});class Gt extends E{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return y(t,{received:t.data,code:h.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}}Gt.create=(s,e)=>new Gt({value:s,typeName:m.ZodLiteral,...P(e)});function li(s,e){return new Be({values:s,typeName:m.ZodEnum,...P(e)})}class Be extends E{constructor(){super(...arguments),It.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return y(t,{expected:O.joinValues(n),received:t.parsedType,code:h.invalid_type}),A}if(Tn(this,It)||ri(this,It,new Set(this._def.values)),!Tn(this,It).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return y(t,{received:t.data,code:h.invalid_enum_value,options:n}),A}return se(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Be.create(e,{...this._def,...t})}exclude(e,t=this._def){return Be.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}It=new WeakMap;Be.create=li;class Jt extends E{constructor(){super(...arguments),Nt.set(this,void 0)}_parse(e){const t=O.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==b.string&&n.parsedType!==b.number){const r=O.objectValues(t);return y(n,{expected:O.joinValues(r),received:n.parsedType,code:h.invalid_type}),A}if(Tn(this,Nt)||ri(this,Nt,new Set(O.getValidEnumValues(this._def.values))),!Tn(this,Nt).has(e.data)){const r=O.objectValues(t);return y(n,{received:n.data,code:h.invalid_enum_value,options:r}),A}return se(e.data)}get enum(){return this._def.values}}Nt=new WeakMap;Jt.create=(s,e)=>new Jt({values:s,typeName:m.ZodNativeEnum,...P(e)});class yt extends E{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==b.promise&&t.common.async===!1)return y(t,{code:h.invalid_type,expected:b.promise,received:t.parsedType}),A;const n=t.parsedType===b.promise?t.data:Promise.resolve(t.data);return se(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}yt.create=(s,e)=>new yt({type:s,typeName:m.ZodPromise,...P(e)});class be extends E{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===m.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:i=>{y(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){const i=r.transform(n.data,a);if(n.common.async)return Promise.resolve(i).then(async o=>{if(t.value==="aborted")return A;const c=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return c.status==="aborted"?A:c.status==="dirty"||t.value==="dirty"?ut(c.value):c});{if(t.value==="aborted")return A;const o=this._def.schema._parseSync({data:i,path:n.path,parent:n});return o.status==="aborted"?A:o.status==="dirty"||t.value==="dirty"?ut(o.value):o}}if(r.type==="refinement"){const i=o=>{const c=r.refinement(o,a);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?A:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?A:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Xe(i))return i;const o=r.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Xe(i)?Promise.resolve(r.transform(i.value,a)).then(o=>({status:t.value,value:o})):i);O.assertNever(r)}}be.create=(s,e,t)=>new be({schema:s,typeName:m.ZodEffects,effect:e,...P(t)});be.createWithPreprocess=(s,e,t)=>new be({schema:e,effect:{type:"preprocess",transform:s},typeName:m.ZodEffects,...P(t)});class Se extends E{_parse(e){return this._getType(e)===b.undefined?se(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Se.create=(s,e)=>new Se({innerType:s,typeName:m.ZodOptional,...P(e)});class Ue extends E{_parse(e){return this._getType(e)===b.null?se(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ue.create=(s,e)=>new Ue({innerType:s,typeName:m.ZodNullable,...P(e)});class qt extends E{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===b.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}qt.create=(s,e)=>new qt({innerType:s,typeName:m.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...P(e)});class Ht extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Zt(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ht.create=(s,e)=>new Ht({innerType:s,typeName:m.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...P(e)});class On extends E{_parse(e){if(this._getType(e)!==b.nan){const n=this._getOrReturnCtx(e);return y(n,{code:h.invalid_type,expected:b.nan,received:n.parsedType}),A}return{status:"valid",value:e.data}}}On.create=s=>new On({typeName:m.ZodNaN,...P(s)});const ul=Symbol("zod_brand");class or extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class sn extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?A:a.status==="dirty"?(t.dirty(),ut(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const r=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?A:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:n.path,parent:n})}}static create(e,t){return new sn({in:e,out:t,typeName:m.ZodPipeline})}}class Xt extends E{_parse(e){const t=this._def.innerType._parse(e),n=r=>(Xe(r)&&(r.value=Object.freeze(r.value)),r);return Zt(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}}Xt.create=(s,e)=>new Xt({innerType:s,typeName:m.ZodReadonly,...P(e)});function Mr(s,e){const t=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof t=="string"?{message:t}:t}function ci(s,e={},t){return s?gt.create().superRefine((n,r)=>{var a,i;const o=s(n);if(o instanceof Promise)return o.then(c=>{var l,d;if(!c){const f=Mr(e,n),p=(d=(l=f.fatal)!==null&&l!==void 0?l:t)!==null&&d!==void 0?d:!0;r.addIssue({code:"custom",...f,fatal:p})}});if(!o){const c=Mr(e,n),l=(i=(a=c.fatal)!==null&&a!==void 0?a:t)!==null&&i!==void 0?i:!0;r.addIssue({code:"custom",...c,fatal:l})}}):gt.create()}const dl={object:z.lazycreate};var m;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(m||(m={}));const fl=(s,e={message:`Input not instance of ${s.name}`})=>ci(t=>t instanceof s,e),ui=ye.create,di=De.create,hl=On.create,ml=Le.create,fi=Dt.create,pl=Ke.create,gl=En.create,yl=Lt.create,_l=Bt.create,bl=gt.create,xl=He.create,vl=Oe.create,wl=In.create,kl=_e.create,Sl=z.create,Al=z.strictCreate,Cl=Ut.create,Pl=Jn.create,Rl=Vt.create,Tl=Ce.create,El=zt.create,Il=Nn.create,Nl=Qe.create,Ol=ht.create,jl=Wt.create,$l=Gt.create,Ml=Be.create,Fl=Jt.create,Zl=yt.create,Fr=be.create,Dl=Se.create,Ll=Ue.create,Bl=be.createWithPreprocess,Ul=sn.create,Vl=()=>ui().optional(),zl=()=>di().optional(),Wl=()=>fi().optional(),Gl={string:(s=>ye.create({...s,coerce:!0})),number:(s=>De.create({...s,coerce:!0})),boolean:(s=>Dt.create({...s,coerce:!0})),bigint:(s=>Le.create({...s,coerce:!0})),date:(s=>Ke.create({...s,coerce:!0}))},Jl=A;var T=Object.freeze({__proto__:null,defaultErrorMap:pt,setErrorMap:Bo,getErrorMap:Pn,makeIssue:Rn,EMPTY_PATH:Uo,addIssueToContext:y,ParseStatus:ne,INVALID:A,DIRTY:ut,OK:se,isAborted:Ss,isDirty:As,isValid:Xe,isAsync:Zt,get util(){return O},get objectUtil(){return ks},ZodParsedType:b,getParsedType:Ne,ZodType:E,datetimeRegex:oi,ZodString:ye,ZodNumber:De,ZodBigInt:Le,ZodBoolean:Dt,ZodDate:Ke,ZodSymbol:En,ZodUndefined:Lt,ZodNull:Bt,ZodAny:gt,ZodUnknown:He,ZodNever:Oe,ZodVoid:In,ZodArray:_e,ZodObject:z,ZodUnion:Ut,ZodDiscriminatedUnion:Jn,ZodIntersection:Vt,ZodTuple:Ce,ZodRecord:zt,ZodMap:Nn,ZodSet:Qe,ZodFunction:ht,ZodLazy:Wt,ZodLiteral:Gt,ZodEnum:Be,ZodNativeEnum:Jt,ZodPromise:yt,ZodEffects:be,ZodTransformer:be,ZodOptional:Se,ZodNullable:Ue,ZodDefault:qt,ZodCatch:Ht,ZodNaN:On,BRAND:ul,ZodBranded:or,ZodPipeline:sn,ZodReadonly:Xt,custom:ci,Schema:E,ZodSchema:E,late:dl,get ZodFirstPartyTypeKind(){return m},coerce:Gl,any:bl,array:kl,bigint:ml,boolean:fi,date:pl,discriminatedUnion:Pl,effect:Fr,enum:Ml,function:Ol,instanceof:fl,intersection:Rl,lazy:jl,literal:$l,map:Il,nan:hl,nativeEnum:Fl,never:vl,null:_l,nullable:Ll,number:di,object:Sl,oboolean:Wl,onumber:zl,optional:Dl,ostring:Vl,pipeline:Ul,preprocess:Bl,promise:Zl,record:El,set:Nl,strictObject:Al,string:ui,symbol:gl,transformer:Fr,tuple:Tl,undefined:yl,union:Cl,unknown:xl,void:wl,NEVER:Jl,ZodIssueCode:h,quotelessJson:Lo,ZodError:ue});function ql(){return{}}function Hl(s,e){const t={type:"array"};return s.type?._def?.typeName!==m.ZodAny&&(t.items=$(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&F(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&F(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(F(t,"minItems",s.exactLength.value,s.exactLength.message,e),F(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function Xl(s,e){const t={type:"integer",format:"int64"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?F(t,"minimum",n.value,n.message,e):F(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),F(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?F(t,"maximum",n.value,n.message,e):F(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),F(t,"maximum",n.value,n.message,e));break;case"multipleOf":F(t,"multipleOf",n.value,n.message,e);break}return t}function Kl(){return{type:"boolean"}}function Ql(s,e){return $(s.type._def,e)}const Yl=(s,e)=>$(s.innerType._def,e);function hi(s,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((r,a)=>hi(s,e,r))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return ec(s,e)}}const ec=(s,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of s.checks)switch(n.kind){case"min":F(t,"minimum",n.value,n.message,e);break;case"max":F(t,"maximum",n.value,n.message,e);break}return t};function tc(s,e){return{...$(s.innerType._def,e),default:s.defaultValue()}}function nc(s,e,t){return e.effectStrategy==="input"?$(s.schema._def,e,t):{}}function sc(s){return{type:"string",enum:[...s.values]}}const rc=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function ac(s,e){const t=[$(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),$(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const r=[];return t.forEach(a=>{if(rc(a))r.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let i=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...c}=a;i=c}else n=void 0;r.push(i)}}),r.length?{allOf:r,...n}:void 0}function ic(s,e){const t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}let ls;const Ge={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ls===void 0&&(ls=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ls),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function mi(s,e){const t={type:"string"};function n(r){return e.patternStrategy==="escape"?oc(r):r}if(s.checks)for(const r of s.checks)switch(r.kind){case"min":F(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":F(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":fe(t,"email",r.message,e);break;case"format:idn-email":fe(t,"idn-email",r.message,e);break;case"pattern:zod":he(t,Ge.email,r.message,e);break}break;case"url":fe(t,"uri",r.message,e);break;case"uuid":fe(t,"uuid",r.message,e);break;case"regex":he(t,r.regex,r.message,e);break;case"cuid":he(t,Ge.cuid,r.message,e);break;case"cuid2":he(t,Ge.cuid2,r.message,e);break;case"startsWith":he(t,RegExp(`^${n(r.value)}`),r.message,e);break;case"endsWith":he(t,RegExp(`${n(r.value)}$`),r.message,e);break;case"datetime":fe(t,"date-time",r.message,e);break;case"date":fe(t,"date",r.message,e);break;case"time":fe(t,"time",r.message,e);break;case"duration":fe(t,"duration",r.message,e);break;case"length":F(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),F(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{he(t,RegExp(n(r.value)),r.message,e);break}case"ip":{r.version!=="v6"&&fe(t,"ipv4",r.message,e),r.version!=="v4"&&fe(t,"ipv6",r.message,e);break}case"emoji":he(t,Ge.emoji,r.message,e);break;case"ulid":{he(t,Ge.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{fe(t,"binary",r.message,e);break}case"contentEncoding:base64":{F(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{he(t,Ge.base64,r.message,e);break}}break}case"nanoid":he(t,Ge.nanoid,r.message,e)}return t}const oc=s=>Array.from(s).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),fe=(s,e,t,n)=>{s.format||s.anyOf?.some(r=>r.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&n.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):F(s,"format",e,t,n)},he=(s,e,t,n)=>{s.pattern||s.allOf?.some(r=>r.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&n.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:Zr(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):F(s,"pattern",Zr(e,n),t,n)},Zr=(s,e)=>{const t=typeof s=="function"?s():s;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let a="",i=!1,o=!1,c=!1;for(let l=0;l<r.length;l++){if(i){a+=r[l],i=!1;continue}if(n.i){if(o){if(r[l].match(/[a-z]/)){c?(a+=r[l],a+=`${r[l-2]}-${r[l]}`.toUpperCase(),c=!1):r[l+1]==="-"&&r[l+2]?.match(/[a-z]/)?(a+=r[l],c=!0):a+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){a+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(n.m){if(r[l]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[l]==="."){a+=o?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}a+=r[l],r[l]==="\\"?i=!0:o&&r[l]==="]"?o=!1:!o&&r[l]==="["&&(o=!0)}try{const l=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return a};function pi(s,e){if(e.target==="openApi3"&&s.keyType?._def.typeName===m.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((n,r)=>({...n,[r]:$(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:$(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(s.keyType?._def.typeName===m.ZodString&&s.keyType._def.checks?.length){const n=Object.entries(mi(s.keyType._def,e)).reduce((r,[a,i])=>a==="type"?r:{...r,[a]:i},{});return{...t,propertyNames:n}}else if(s.keyType?._def.typeName===m.ZodEnum)return{...t,propertyNames:{enum:s.keyType._def.values}};return t}function lc(s,e){if(e.mapStrategy==="record")return pi(s,e);const t=$(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=$(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function cc(s){const e=s.values,n=Object.keys(s.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function uc(){return{not:{}}}function dc(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const jn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function fc(s,e){if(e.target==="openApi3")return Dr(s,e);const t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(n=>n._def.typeName in jn&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((r,a)=>{const i=jn[a._def.typeName];return i&&!r.includes(i)?[...r,i]:r},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((r,a)=>{const i=typeof a._def.value;switch(i){case"string":case"number":case"boolean":return[...r,i];case"bigint":return[...r,"integer"];case"object":if(a._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(n.length===t.length){const r=n.filter((a,i,o)=>o.indexOf(a)===i);return{type:r.length>1?r:r[0],enum:t.reduce((a,i)=>a.includes(i._def.value)?a:[...a,i._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,r)=>[...n,...r._def.values.filter(a=>!n.includes(a))],[])};return Dr(s,e)}const Dr=(s,e)=>{const t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((n,r)=>$(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function hc(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:jn[s.innerType._def.typeName],nullable:!0}:{type:[jn[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=$(s.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=$(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function mc(s,e){const t={type:"number"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"int":t.type="integer",ni(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?F(t,"minimum",n.value,n.message,e):F(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),F(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?F(t,"maximum",n.value,n.message,e):F(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),F(t,"maximum",n.value,n.message,e));break;case"multipleOf":F(t,"multipleOf",n.value,n.message,e);break}return t}function pc(s,e){return e.removeAdditionalStrategy==="strict"?s.catchall._def.typeName==="ZodNever"?s.unknownKeys!=="strict":$(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:s.catchall._def.typeName==="ZodNever"?s.unknownKeys==="passthrough":$(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function gc(s,e){const t={type:"object",...Object.entries(s.shape()).reduce((n,[r,a])=>{if(a===void 0||a._def===void 0)return n;const i=$(a._def,{...e,currentPath:[...e.currentPath,"properties",r],propertyPath:[...e.currentPath,"properties",r]});return i===void 0?n:{properties:{...n.properties,[r]:i},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,r]}},{properties:{},required:[]}),additionalProperties:pc(s,e)};return t.required.length||delete t.required,t}const yc=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return $(s.innerType._def,e);const t=$(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},_c=(s,e)=>{if(e.pipeStrategy==="input")return $(s.in._def,e);if(e.pipeStrategy==="output")return $(s.out._def,e);const t=$(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=$(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(r=>r!==void 0)}};function bc(s,e){return $(s.type._def,e)}function xc(s,e){const n={type:"array",uniqueItems:!0,items:$(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&F(n,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&F(n,"maxItems",s.maxSize.value,s.maxSize.message,e),n}function vc(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,n)=>$(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:$(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,n)=>$(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function wc(){return{not:{}}}function kc(){return{}}const Sc=(s,e)=>$(s.innerType._def,e);function $(s,e,t=!1){const n=e.seen.get(s);if(e.override){const i=e.override?.(s,e,n,t);if(i!==Mo)return i}if(n&&!t){const i=Ac(n,e);if(i!==void 0)return"$ref"in i&&e.seenRefs.add(i.$ref),i}const r={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,r);const a=Pc(s,s.typeName,e,t);return a&&Rc(s,e,a),r.jsonSchema=a,a}const Ac=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"extract-to-root":const t=s.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=s.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:Cc(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},Cc=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return[(s.length-t).toString(),...e.slice(t)].join("/")},Pc=(s,e,t,n)=>{switch(e){case m.ZodString:return mi(s,t);case m.ZodNumber:return mc(s,t);case m.ZodObject:return gc(s,t);case m.ZodBigInt:return Xl(s,t);case m.ZodBoolean:return Kl();case m.ZodDate:return hi(s,t);case m.ZodUndefined:return wc();case m.ZodNull:return dc(t);case m.ZodArray:return Hl(s,t);case m.ZodUnion:case m.ZodDiscriminatedUnion:return fc(s,t);case m.ZodIntersection:return ac(s,t);case m.ZodTuple:return vc(s,t);case m.ZodRecord:return pi(s,t);case m.ZodLiteral:return ic(s,t);case m.ZodEnum:return sc(s);case m.ZodNativeEnum:return cc(s);case m.ZodNullable:return hc(s,t);case m.ZodOptional:return yc(s,t);case m.ZodMap:return lc(s,t);case m.ZodSet:return xc(s,t);case m.ZodLazy:return $(s.getter()._def,t);case m.ZodPromise:return bc(s,t);case m.ZodNaN:case m.ZodNever:return uc();case m.ZodEffects:return nc(s,t,n);case m.ZodAny:return ql();case m.ZodUnknown:return kc();case m.ZodDefault:return tc(s,t);case m.ZodBranded:return Ql(s,t);case m.ZodReadonly:return Sc(s,t);case m.ZodCatch:return Yl(s,t);case m.ZodPipeline:return _c(s,t);case m.ZodFunction:case m.ZodVoid:case m.ZodSymbol:return;default:return(r=>{})()}},Rc=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t),Tc=(s,e)=>{const t=Do(e),n=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,r=$(s._def,n===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(r.title=a);const i=(()=>{if(Zo(t.definitions))return;const c={},l=new Set;for(let d=0;d<500;d++){const f=Object.entries(t.definitions).filter(([p])=>!l.has(p));if(f.length===0)break;for(const[p,g]of f)c[p]=$(ws(g),{...t,currentPath:[...t.basePath,t.definitionPath,p]},!0)??{},l.add(p)}return c})(),o=n===void 0?i?{...r,[t.definitionPath]:i}:r:t.nameStrategy==="duplicate-ref"?{...r,...i||t.seenRefs.size?{[t.definitionPath]:{...i,...t.seenRefs.size?{[n]:r}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...i,[n]:r}};return t.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function Ec(s,e){return Tc(s,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Ic(s,e,t){return po({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:Ec(s,{name:e})}},n=>s.parse(JSON.parse(n)))}const Nc=T.enum(["English","Hindi","Malayalam","Tamil","Telugu","Kannada","Arabic","Urdu","Samskritham","Polish","German","Gujarati","Chinese","Any/NA"]),Oc=T.enum(["Male","Female","Both"]),jc=T.enum(["Offline","Online","Action","Art","Dance","Literacy","Music","Off Stage","On Stage","Oral","Others","Special","Written"]),$c=T.enum(["Marks","Count","Rating out of 10","Range out of 10"]),Mc=T.enum(["Individual","Team"]),gi=T.enum(["Individual","Team","Any"]),Fc=T.enum(["First","Second","Third"]),Zc=T.object({RankTitle:Fc,ParticipantTypeTitle:gi,GroupGroupName:T.string().describe("Must be a valid group name as same as in the AgeBasedGroup, its only need if need some custom grade points for a group").optional(),CompetitionItemTitle:T.string().describe("Must be a valid competition name as same as in the CompetitionItems, its only need if need some custom grade points for a competition").optional(),Points:T.number().describe("Must be a valid number, if no points then keep 5 points for first, 3 points for second and 1 point for third")}),Dc=T.object({ParticipantTypeTitle:gi,GroupGroupName:T.string().describe("Must be a valid group name as same as in the AgeBasedGroup, its only need if need some custom grade points for a group").optional(),CompetitionItemTitle:T.string().describe("Must be a valid competition name as same as in the CompetitionItems, its only need if need some custom grade points for a competition").optional(),GradeName:T.string().describe("Must be a valid grade name like A, B, C, etc"),Points:T.number().describe("Must be a valid number, if no points then keep 5 points for A, 3 points for B and 1 point for C"),Value:T.number().describe("Must be a valid number, it represents how much score is need out of 10 to get this grade, if no grade then keep 6 for A, 5 for B and 4 for C")}),Lc=T.object({GroupName:T.string().describe("Must be the name of a age group or keep it as All Groups"),AgeFrom:T.number().describe("Must be a valid age or if no age group then keep it as 0").optional(),AgeTo:T.number().describe("Must be a valid age or if no age group then keep it as 100").optional()}),Bc=T.object({Title:T.string().describe("Must be a valid competition name like Dance, Singing, etc"),CategoryCategoryName:jc,ScoreLabelLabel:$c}),Uc=T.object({ParticipantTypeTitle:Mc,GroupGroupName:T.string().describe("Must be a valid group name as same as in the AgeBasedGroup"),CompetitionItemTitle:T.string().describe("Must be a valid competition name as same as in the CompetitionItems"),LanguageLanguageName:Nc,GenderGenderTitle:Oc,Remarks:T.string().nullable().optional().describe("Any remarks,rules or description, prize informations about the competition, and all other informations mentioned in the document should be added here related to this competition"),MaximumScore:T.number().optional(),MaximumCandidates:T.number().optional(),Fees:T.number().optional(),MaximumMinutes:T.number().optional(),MaximumSeconds:T.number().optional(),MinimumMinutes:T.number().optional(),MinimumSeconds:T.number().optional()}),Vc=T.object({competitionsAssignedToGroup:T.array(Uc),competitionItems:T.array(Bc),ageWiseGroups:T.array(Lc),ranks:T.array(Zc),grades:T.array(Dc)});let zc=document.getElementById("OpenAIKey").value;const Wc=new R({apiKey:zc,dangerouslyAllowBrowser:!0});let Gc=`Generate competitions from the image.
Always try to translate the image text to English and generate the values.
Always try to keep generated values are exact as in the images.
Always try to find all competitions matching for all groups from the image.
Rules:
1. If there is seperate competitions based on gender, then create seperate rows in competitionStructureModel and add specific GenderName.
2. If there is seperate competitions based on language, then create seperate competitions and add LanguageName instead of using Any/NA.
3. On generate ranks and grades, if there a rank or grade not specifically mentioned for a particular group or competition, then keep value empty.
4. If there is no specific grades or ranks, mentioned then the arrays can be empty.
5 Dont assign any competitions or groups to ranks if there is no specific ranks for a group or competition. keep it as Any/NA.
`;const Jc=async(s,e,t)=>{if(!s?.length){alert("Please upload an image");return}try{let n=s.map(i=>({type:"image_url",image_url:{url:i.webUrl}}));const r=await Wc.beta.chat.completions.parse({model:"gpt-4o-2024-08-06",messages:[{role:"system",content:[{type:"text",text:Gc}]},{role:"user",content:[{type:"text",text:t},...n]}],response_format:Ic(Vc,"allCompetitionsModel")});try{const i=r.choices[0].message.parsed;e(i)}catch(i){console.error("Error:",i);const o=r.choices[0].message.content;o?.length>1&&o.indexOf("{")>=0&&e(JSON.parse(o))}const a=r.choices[0].message.parsed;e(a)}catch(n){console.error("Error:",n)}},gn=({heading:s,items:e,isLoading:t,columns:n})=>u.jsx(u.Fragment,{children:e?.length>0&&u.jsxs("div",{className:"px-2 sm:px-4 lg:px-6 relative",children:[t&&u.jsx(Ps,{}),u.jsx("div",{className:"sm:flex sm:items-center",children:u.jsx("h1",{className:"text-sm font-semibold leading-6 text-gray-900",children:s})}),u.jsx("div",{className:"mt-4 flow-root",children:u.jsx("div",{className:"-mx-2 -my-1 overflow-x-auto sm:-mx-4 lg:-mx-6",children:u.jsx("div",{className:"inline-block min-w-full py-1 align-middle sm:px-4 lg:px-6",children:u.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:n.map(r=>u.jsx("th",{scope:"col",className:"py-2 pl-2 pr-1 text-left text-xs font-semibold text-gray-900 sm:pl-4",children:r.label},r.field))})}),u.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:e?.map(r=>u.jsx("tr",{className:"divide-x divide-gray-200",children:n.map(a=>u.jsx("td",{className:"whitespace-nowrap px-1 py-2 text-xs text-gray-500",children:r[a.field]},a.field))},r.GroupName))})]})})})})})]})});function hu(){const[s,e]=ae.useState(localStorage.getItem("aiPrompt")||""),[t,n]=ae.useState([]),[r,a]=ae.useState(!1),[i,o]=ae.useState(!1),[c,l]=ae.useState([]),{control:d,getValues:f,setValue:p,formState:{errors:g}}=vi();let N=f();ae.useEffect(()=>{let _=sessionStorage.getItem("competitionsGroups");_&&n(JSON.parse(_));let C=sessionStorage.getItem("images");C&&p("fileUploads",JSON.parse(C));let L=sessionStorage.getItem("selectedCheckboxes");L&&l(JSON.parse(L))},[]);const v=async _=>{_.competitionsAssignedToGroup?.forEach(C=>{C.Id||(C.Id=Xn())}),n(_),sessionStorage.setItem("competitionsGroups",JSON.stringify(_)),o(!1)},B=()=>{o(!0);const _=f("fileUploads");Jc(_,v,s)},U=async()=>{if(o(!0),c.length>0){let _=t.competitionsAssignedToGroup.filter(L=>c.includes(L.Id)),C={...t,competitionsAssignedToGroup:_};await ki("/SetUpJson/InstallEventSettingsItems",C),Ot.success("Competitions have been successfully installed"),setTimeout(()=>{window.top.location.href="/CompetitionStructure/Tab"},2e3),o(!1)}else Ot.error("Please select at least one competition"),o(!1)},k=(_,C)=>{let L={..._,GenderGenderTitle:"Male",Id:Xn()},q={..._,GenderGenderTitle:"Female",Id:Xn()},W=t.competitionsAssignedToGroup.slice(0,C),M=t.competitionsAssignedToGroup.slice(C+1);t.competitionsAssignedToGroup=[...W,L,q,...M],v({...t})},J=()=>{const _=t.competitionsAssignedToGroup.map(C=>C.Id);l(r?[]:_),a(!r),sessionStorage.setItem("selectedCheckboxes",JSON.stringify(c))},D=_=>{c.includes(_)?l(c.filter(C=>C.id!==_)):l([...c,_]),sessionStorage.setItem("selectedCheckboxes",JSON.stringify(c))};return u.jsxs("div",{children:[u.jsx("div",{children:u.jsxs("div",{className:"flex justify-center w-full flex-col place-items-center",children:[u.jsx(Ri,{label:"Upload Images Related to the competition",errors:g,control:d,validExtensions:["jpg","png","jpeg"],validExtensionsMimeTypes:["image/jpg","image/png","image/jpeg"],fieldName:"fileUploads",fileUploadUrl:"/uploadJson/UploadCandidateImage",editId:N?.id,onChangeValidation:_=>{sessionStorage.setItem("images",JSON.stringify(_)),p("fileUploads",_)}}),u.jsxs("div",{className:"mt-4 px-10 flex flex-col w-full",children:[u.jsx("label",{htmlFor:"aiPrompt",className:"block text-sm font-semibold text-gray-700",children:"AI Prompt"}),u.jsx("textarea",{id:"aiPrompt",name:"aiPrompt",value:s,onChange:_=>{e(_.target.value),localStorage.setItem("aiPrompt",_.target.value)},rows:"4",className:"mt-1 min-w-full max-w-full block w-full shadow-sm sm:text-sm focus:ring-indigo-500 focus:border-indigo-500 border-gray-300 rounded-md",placeholder:"Enter the AI Prompt"})]}),u.jsx("button",{onClick:B,className:"mt-8 w-full max-w-72 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Get Results"}),u.jsx("a",{href:"https://ilovepdf.com/pdf_to_jpg",target:"_blank",className:"text-sm text-blue-500 mt-2",rel:"noreferrer",children:"Donâ€™t have an Image to test? Click here to convert PDF to Image"})]})}),u.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[u.jsx("div",{className:"mt-8 flow-root",children:u.jsxs("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:[u.jsxs("div",{className:"flex flex-row",children:[u.jsx(gn,{heading:"Age Wise Groups",items:t?.ageWiseGroups,isLoading:i,columns:[{field:"GroupName",label:"Group Name"},{field:"AgeFrom",label:"Age From"},{field:"AgeTo",label:"Age To"}]}),u.jsx(gn,{heading:"Competition Items",items:t?.competitionItems,isLoading:i,columns:[{field:"Title",label:"Title"},{field:"CategoryCategoryName",label:"Category"},{field:"ScoreLabelLabel",label:"Score By"}]}),u.jsx(gn,{heading:"Ranks",items:t?.ranks,isLoading:i,columns:[{field:"ParticipantTypeTitle",label:"Participant Type"},{field:"GroupGroupName",label:"Group Name"},{field:"CompetitionItemTitle",label:"Competition Item"},{field:"RankTitle",label:"Rank Title"},{field:"Points",label:"Points"}]}),u.jsx(gn,{heading:"Grades",items:t?.grades,isLoading:i,columns:[{field:"ParticipantTypeTitle",label:"Participant Type"},{field:"GroupGroupName",label:"Group Name"},{field:"CompetitionItemTitle",label:"Competition Item"},{field:"GradeName",label:"Grade Title"},{field:"Points",label:"Points"}]})]}),u.jsx("div",{className:"sm:flex sm:items-center px-10 mt-10",children:u.jsxs("div",{className:"sm:flex-auto",children:[u.jsx("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"Generated Competitions"}),u.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all AI generated competitions."})]})}),u.jsxs("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8 relative",children:[i&&u.jsx(Ps,{}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"divide-x divide-gray-200",children:[u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-sm font-semibold text-gray-900 sm:pl-2",children:u.jsx("input",{id:"selectAll",name:"selectAll",type:"checkbox",checked:r,"aria-describedby":"selectAll-description",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",onChange:J})}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Participant Type"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Group Name"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Competition Name"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Language"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Gender"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Split Gender"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Remarks"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Maximum Score"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Maximum Candidates"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Fees"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Maximum Minutes"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Maximum Seconds"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Minimum Minutes"}),u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-gray-900",children:"Minimum Seconds"})]})}),t?.competitionsAssignedToGroup?.length>0&&u.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:t?.competitionsAssignedToGroup?.map((_,C)=>u.jsxs("tr",{className:"divide-x divide-gray-200",children:[u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:u.jsx("input",{id:`checkbox${_.Id}`,name:`checkbox${_.Id}`,type:"checkbox",checked:c.includes(_.Id),"aria-describedby":`checkbox${C}-description`,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",onChange:()=>D(_.Id)})}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.ParticipantTypeTitle}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.GroupGroupName}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.CompetitionItemTitle}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.LanguageLanguageName}),u.jsxs("td",{className:"px-2 py-2 text-xs font-medium text-gray-900 flex justify-center ",children:[_.GenderGenderTitle," "]}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.GenderGenderTitle==="Both"?u.jsx("button",{onClick:()=>{k(_,C)},type:"button",className:"rounded-full bg-indigo-600 p-1 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:u.jsx(Pi,{"aria-hidden":"true",className:"h-5 w-5"})}):null}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.Remarks}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MaximumScore}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MaximumCandidates}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.Fees}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MaximumMinutes}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MaximumSeconds}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MinimumMinutes}),u.jsx("td",{className:"px-2 py-2 text-xs font-medium text-gray-900",children:_.MinimumSeconds})]},_.Id))},t?.competitionsAssignedToGroup?.length)]})]})]})}),u.jsx("div",{className:"flex justify-center w-full flex-col place-items-center",children:u.jsx("button",{onClick:U,className:"mt-8 w-full max-w-72 rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600",children:"Submit"})})]})]})}export{hu as default};
