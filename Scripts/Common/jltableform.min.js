"use strict";function adjustwidth(n,t){var i=0,r;n.each(function(){$(this).outerWidth()>i&&(i=$(this).outerWidth())});i>0&&(r=i/t*100,n.css({width:i}))}function setrightangle(n,t,i){n.find(".tablebody .rightangle").length===0&&n.find(".tablebody").append('<div class="rightangle"><svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" class="angle-right"><path fill="currentColor" d="M166.9 264.5l-117.8 116c-4.7 4.7-12.3 4.7-17 0l-7.1-7.1c-4.7-4.7-4.7-12.3 0-17L127.3 256 25.1 155.6c-4.7-4.7-4.7-12.3 0-17l7.1-7.1c4.7-4.7 12.3-4.7 17 0l117.8 116c4.6 4.7 4.6 12.3-.1 17z" class=""><\/path><\/svg><\/div>');var r=i-n.find(".tablebody .rightangle").width(),u=n.find(".tablehead").outerHeight()+1;converttotstyle(t+"stylesangleright","#"+t+" .rightangle","left",r+"px");converttotstyle(t+"stylesanglerighttop","#"+t+" .rightangle","top",u+"px")}function setleftangle(n,t,i){n.find(".tablebody .leftangle").length===0&&n.find(".tablebody").prepend('<div class="leftangle"><svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" class="angle-right"><path fill="currentColor" d="M25.1 247.5l117.8-116c4.7-4.7 12.3-4.7 17 0l7.1 7.1c4.7 4.7 4.7 12.3 0 17L64.7 256l102.2 100.4c4.7 4.7 4.7 12.3 0 17l-7.1 7.1c-4.7 4.7-12.3 4.7-17 0L25 264.5c-4.6-4.7-4.6-12.3.1-17z" class=""><\/path><\/svg><\/div>');var r=i,u=n.find(".tablehead").outerHeight()+1;converttotstyle(t+"stylesangleleft","#"+t+" .leftangle","left",r+"px");converttotstyle(t+"stylesanglelefttop","#"+t+" .leftangle","top",u+"px")}function settableresponsive(n,t){var i=n.closest(".datamanager"),e=i.attr("id");t;var f=i.scrollLeft(),r=i.outerWidth(),u=n.find(".tablehead").outerWidth();u+100>r&&n.addClass("hidemaximumpossible");$("#"+e+" .divtable > div > div > .datacolumn:nth-child(2)").addClass("titlecolumn");setTimeout(function(){var e=n.find(".tablehead .actioncolumn:first").outerWidth(),s=n.find(".tablehead .checkrow:first").outerWidth(),t,o;f>5;r=i.outerWidth();u=n.find(".tablehead").outerWidth();e=n.find(".tablehead .actioncolumn:first").outerWidth();t=n.find(".tablehead .orderrow:first").outerWidth();t||(t=0);o=u-r-e-t;f+r+5<u},500)}function scrollAlignment(n){settableresponsive(n)}function focusinput(n){var f,e,r,t,i,u;n&&n.prop("tagName")&&n.prop("tagName").toLowerCase()=="select"?(f=n[0],e=!1,document.createEvent&&(r=document.createEvent("MouseEvents"),r.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e=f.dispatchEvent(r))):(t=n[0],t&&(t!=null&&t.value&&t.value.length!=0?t.createTextRange?(i=t.createTextRange(),i.moveStart("character",t.value.length),i.collapse(),i.select()):(t.selectionStart||t.selectionStart=="0")&&(u=t.value.length,t.selectionStart=u,t.selectionEnd=u,t.focus()):t.focus()));n.trigger("focused");n.trigger("keydowned")}function jldeleterow(n,t,i,r){var u={},f=t.closest(".table-cell-actions").attr("data-keyname"),e=t.closest(".table-cell-actions").attr("data-id");u.formdata={};u.formdata[f]=e;n.trigger("beforedeletetableform",u);alert("Are you sure to delete it?",function(){$.ajax({url:i,type:"DELETE",success:function(i){if(i&&i.Results){alert("Deleted successfully");var u=$("#fakeitem");n.attr("data-deleteaction")&&(u=$("[data-json='"+n.attr("data-deleteaction").replace(/Remove/i,"Get")+"']"));u=u.not(n);n.attr("data-updatebinder")&&$(n.attr("data-updatebinder")).binder&&(u=u.add($(n.attr("data-updatebinder"))));u.each(function(){$.binder.clear($(this))});u.binder();t.closest(".table-row").remove()}else alert("Unable to delete, <br/>due to, <br/>It's using somewhere or <br/>not selected all depended values or <br/>because of  security reasons",!1,!1,!1,"w",5e3);r&&r(i)},error:function(){alert("Can't deleteit, because it using in somewhere")},data:u.formdata})},!1,"Deleteit","c")}var bulkrowUpdatesCount,adjustModalSize;$.ajaxSetup({cache:!1});$.fn.jltableform=function(n){return $(this).each(function(){var t=$(this);t.attr("id")||t.attr("id","Id"+(new Date).getTime().toString()+""+Math.random().toString().replace(".",""));var r=t.attr("id"),i=$.extend({},$.fn.jltableform.defaults),u=$.fn.jltableform.keys,f=$.extend($.fn.jltableform.date,$.fn.jltableform.methods);typeof n=="object"&&(i=$.extend(i,n));t.children("[data-wrapfollow]").length>0?t.children("[data-wrapfollow]").children().attr("data-jltableformrow","true"):t.children().attr("data-jltableformrow","true");t.attr("data-jltableforminit")||t.attr("data-jltableforminit",!0)}),$(this)};bulkrowUpdatesCount=0;$.fn.jltableform.methods={saveform:function(n,t,i,r){var e,o,l,c,h;if(t.hasClass("disablejltableform"))return!1;var f=t.closest("[data-jltableformrow]"),u="",s=t.attr("name")?t.attr("name").replace("[","").replace("]",""):"";if(window.submitform(f)){if(!i){if(u=t.val(),t.prop("tagName").toLowerCase()=="select"&&(u=t.find("option:selected").text()),(t.attr("type")=="checkbox"||t.attr("type")=="radio")&&(u=$.fn.binder.methods.fetchvalue[t.attr("type")](t)),o=f.find("[data-jltext-"+s+"],[data-jlattr-"+s+"]"),e=t.closest(".form-group").next(".table-cell-content"),l=t.attr("data-jlorgvalue"),e.text()==u||l==u)return!1;c=$.fn.binder.methods.attr(e);u=$.fn.binder.methods.textautofn(c,u,e);u=$.fn.binder.methods.applydatefunctionalitybyattributes(c,s,u);$.fn.binder.methods.applyfunctionalitybasedonattributes(c,e,s,u);e.add(o).text("Not updated, please try again");t.attr("data-jlorgvalue",u)}var v=n.attr("data-method")?n.attr("data-method"):"post",y=n.attr("data-action"),a={};a=$.fn.binder.methods.makepostdata(f.find("[name]").not(f.find("[data-jltableform] [name]")));h={};h.formdata=a;h.newrowdata=i;n.trigger("beforesavetableform",h);f.trigger("beforesavetablerow",h);$(".validationmessageblock").removeClass("validationmessageblock");$(".validationmessage").remove();r&&bulkrowUpdatesCount++;$[v](y,h.formdata,function(t){if(f.trigger("aftersavetablerow",t),r&&bulkrowUpdatesCount--,t.ModelState&&t.ModelState&&t.ModelState.SecurityValidations&&t.ModelState.SecurityValidations.length>0)$.each(t.ModelState.SecurityValidations,function(n,t){alert(t,!1,!1,"SecurityValidations","w",5e3)});else if(t&&t.validationErrors&&typeof t.validationErrors=="object")$.each(t.validationErrors[0],function(n,t){var i=f.find('[name="form['+n+']"]').closest(".form-group").parent("[data-label]");i.addClass("validationmessageblock");i.find(".validationmessage").remove();i.append('<span class="validationmessage">'+t+"<\/span>")});else{o&&o.attr("data-jlattr-"+s)&&o.attr(o.attr("data-jlattr-"+s),u);o&&o.attr("data-jltext-"+s)&&o.text(u);e&&e.attr("data-jltext-"+s)&&e.text(u);var c=n.attr("data-action").replace(/Save/i,"Get"),h=$("div[data-json='"+c+"']");if(n.attr("data-updatebinder")&&$(n.attr("data-updatebinder")).binder&&(h=h.add($(n.attr("data-updatebinder")))),h.attr("data-uniquekey")&&f.trigger("jlupdaterow",!0),i||r||(h=h.not(n)),i){f.find("input[name][type=text]:not(.disablejltableform)").val("").trigger("change");h.one("afterappendcomplete",function(){h.find(".table-addnewrow").removeClass("hidden").removeAttr("style").find(".formcontrol:visible:first").focus()})}r&&bulkrowUpdatesCount!=0||(h.each(function(){$.binder.clear($(this))}),h.binder());n.trigger("aftersavetableform",t);f.trigger("aftersavetableformrow",t);alert("Saved",!1,!1,"Savedalert","a",4e3)}})}}};$.fn.jltableform.keys={};$.fn.jltableform.defaults={};adjustModalSize=function(){window==window.top&&$(".rightModal").each(function(){$(this).children().removeAttr("style");var n=$(this).children("div").outerHeight()>$(window).height()?$(this).children("div").outerHeight():$(window).height();$(this).children().css("height",n);$(this).find("#rightmodeliframe").css("min-height","auto");$(this).find("#rightmodeliframe").css("min-height",$(this).innerHeight()-$("#rightModalLabel").parent().innerHeight()-$("#rightModalClose").parent().innerHeight()-40)})};$(document).ready(function(){var s=!1,u=0,h=function(n,t){var r,i,f,e;t&&t.length>0&&(s=!0,f=t.attr("name"),i=t.parent().parent().parent().next().find("[name*='"+f+"'],a.deleterow,a.addrow").first(),n==40&&i.length>0&&($(".tableformhover").removeClass("tableformhover"),r=i,i.parent().parent().addClass("tableformhover"),i.focus().parent().parent().addClass("tableformhover")),i=t.parent().parent().parent().prev().find("[name*='"+f+"'],a.deleterow,a.addrow").first(),n==38&&i.length>0&&($(".tableformhover").removeClass("tableformhover"),r=i,i.parent().parent().addClass("tableformhover"),i.focus().parent().parent().addClass("tableformhover")),i=t.parent().parent().next("div:not('.disableedit')").find("[name*='form['],a.deleterow,a.addrow").first(),n==39&&i.length>0&&(r=i,$(".tableformhover").removeClass("tableformhover"),i.focus().parent().parent().addClass("tableformhover")),i=t.parent().parent().prev("div:not('.disableedit')").find("[name*='form['],a.deleterow,a.addrow").first(),n==37&&i.length>0&&(r=i,$(".tableformhover").removeClass("tableformhover"),i.focus().parent().parent().addClass("tableformhover")),r&&r.length>0&&focusinput(r),u++,e=u,setTimeout(function(){e==u&&(s=!1)},1e3))},f=!1,e=0,o,t,i,r,n,c;$("body").on("keydown focus",".jltableouter .tablebody[data-jltableform] input[type][name]:not([type=checkbox],[type=radio],.optinput)",function(){$(this).css("width",$(this).val().length*14+"px")});$("body").on("keydown","[data-jltableform] [name]",function(n){if(n.keyCode>=37&&n.keyCode<=40&&n.ctrlKey){n.preventDefault();f=!0;h(n.keyCode,$(this));e++;var t=e;setTimeout(function(){t==e&&(f=!1)},100)}});$(document).on("keydown",function(n){if(n.keyCode>=37&&n.keyCode<=40&&n.ctrlKey&&f==!1){var t=$(".tableformhover:first").find("[name]");h(n.keyCode,t)}});$("body").on("click",".refreshtable",function(n){if(n.originalEvent){var t=$(this).closest(".datamanager");t.find(".tablebody[data-json]").binder()}});$("body").on("afterappendcomplete","[data-jltableform]",function(n){n.target==n.currentTarget&&($(this).jltableform(),$(this).closest(".divtable:visible").length>0&&settableresponsive($(this).closest(".divtable"),!0),$(window).trigger("resize"),$(this).find(".editdata").addClass("hidden"),$(this).closest(".divtable").find(".tablehead .gridcheck").prop("checked")&&$(this).closest(".divtable").find(".tablehead .gridcheck").trigger("change",!0))});$("body").on("afterappendcomplete","div[data-json]",function(n){n.target==n.currentTarget&&$(this).find("[data-jltableform]:not([data-json]):not([data-jltableforminit])").not($(this).find("[data-json] [data-jltableform]")).jltableform()});$("body").on("afterappendcomplete","#rightModal [data-jltableform]",function(n){n.target==n.currentTarget&&$(window).trigger("resize")});o={};$("body").on("afterappendcomplete","[data-jltableform] select[data-json]",function(n,t){n.target==n.currentTarget&&($(this).removeAttr("data-parent"),t.rows&&t.rows.Results&&t.rows.Results.length==0&&!o[$(this).attr("data-module")]&&(o[$(this).attr("data-module")]=!0))});$("body").on("click",".table-row,.table-addnewrow",function(){$(".showalldetails").not($(this)).removeClass("showalldetails");$(this).not(".table-addnewrow").addClass("showalldetails")});$("body").on("click",".searchbtn",function(n){n.preventDefault();var t=$(this).closest(".datamanager");t.find(".table-addnewrow,.bulkrow,.duplicaterow").addClass("hidden");t.find(".searchrow").toggleClass("hidden");t.find(".searchrow").hasClass("hidden")?t.find(".searchrow").hide():t.find(".searchrow").show()});$("body").on("click",".addnewrow",function(n){var t,i;n.preventDefault();t=$(this).closest(".datamanager");t.find(".searchrow").addClass("hidden");t.find(".table-addnewrow:visible").length==0?t.find(".table-addnewrow").removeClass("hidden"):t.find(".table-addnewrow").addClass("hidden");t.find(".table-addnewrow").trigger("click").removeAttr("style");i=$(this).closest(".tablemenulist");i.hide();setTimeout(function(){i.removeAttr("style")},500)});$("body").on("click",".editrow",function(n){n.preventDefault();var t=$(this).closest(".table-cell-actions"),i=$(this).closest("[data-jltableform]"),r=$(i.attr("data-editform"));r.find("[name="+t.attr("data-keyname")+"]").val(t.attr("data-id")).trigger("change",!0)});$("body").on("click",".showeditbox",function(n){n.preventDefault();var t=$(this).closest("[data-jltableformrow]");t.find(".viewdata").addClass("hidden");t.find(".editdata").removeClass("hidden");$(this).find("i").addClass("fas fa-arrow-left").removeClass("fa fa-pen");$(this).addClass("hideeditbox").removeClass("showeditbox")});$("body").on("click",".hideeditbox",function(n){n.preventDefault();var t=$(this).closest("[data-jltableformrow]");t.find(".editdata").addClass("hidden");t.find(".viewdata").removeClass("hidden");$(this).find("i").removeClass("fas fa-arrow-left").addClass("fa fa-pen");$(this).addClass("showeditbox").removeClass("hideeditbox")});$("body").on("change",".tablehead .gridcheck",function(n,t){if(n.originalEvent||t){var i=$(this).prop("checked"),r=$(this).closest(".jltable");r.find(".table-row .gridcheck").prop("checked",i).trigger("change")}});$("body").on("change",".table-row .gridcheck",function(n){var i=$(this).closest(".table-row"),r=$(this).prop("checked"),t=$(this).closest(".datamanager");i.trigger("click");t.find(".bulkrow,.duplicaterow").removeClass("hidden").removeAttr("style");t.find(".table-row .gridcheck:checked").length==0&&t.find(".bulkrow,.duplicaterow").addClass("hidden");n.originalEvent&&(t.find(".table-row .gridcheck").length==t.find(".table-row .gridcheck:checked").length?t.find(".tablehead .gridcheck").prop("checked",!0).trigger("change"):t.find(".tablehead .gridcheck").prop("checked",!1).trigger("change"));r?i.addClass("rowselected"):i.removeClass("rowselected")});t=!0;i=0;$("body").on("aftercreate",".datamanager div[data-json]",function(n){n.target==n.currentTarget&&$(this).closest(".datamanager").scroll(function(){var r=$(this),n=r.attr("id"),u;converttotstyle(n+"stylesangleleft","#"+n+" .leftangle","display","none");converttotstyle(n+"stylesangleright","#"+n+" .rightangle","display","none");i++;u=i;setTimeout(function(){u===i&&(scrollAlignment(r.find(".divtable")),t=!0)},100)})});$("body").on("click",".leftangle",function(){t=!1;var n=$(this),u=n.find(".tablehead .checkrow:first").outerWidth(),e=n.closest(".datamanager").find(".actioncolumn:first").outerWidth(),f=n.closest(".datamanager").find(".titlecolumn:first").outerWidth()+20;u&&(f+=u);var o=n.closest(".datamanager").outerWidth(),i=o-e-f,r=n.closest(".datamanager").scrollLeft();r-i<0&&(i=r);n.closest(".datamanager").animate({scrollLeft:r-i},1300,function(){})});$("body").on("click",".rightangle",function(){t=!1;var n=$(this),f=n.closest(".datamanager").get(0).scrollWidth,i=n.closest(".datamanager").find(".actioncolumn:first").outerWidth()+50,o=n.closest(".datamanager").find(".titlecolumn:first").outerWidth()+50,r=n.closest(".datamanager").outerWidth(),u=r-i-o,e=n.closest(".datamanager").scrollLeft();e+u>=f-r+i&&(u=f-r+i);n.closest(".datamanager").animate({scrollLeft:e+u},1300,function(){})});r=0;$(window).on("resize",function(){r++;var n=r,t=$(this);setTimeout(function(){n==r&&(adjustModalSize(),$(".divtable:visible").each(function(){settableresponsive($(this))}))},500)});$(window).trigger("resize");$("body").on("click","[data-modal]",function(){var n=$(this).attr("data-modal"),t=$(this).attr("data-modalfilter");$(n).find("[data-json]").attr("data-filterby-inline",t);$("#rightModal").show();$("body").css("overflow-y","hidden");$(n).find("[data-json]").binder()});$("#rightModal").on("hidden.bs.modal",function(){$("body").css("overflow-y","scroll")});$("body").find("[data-jltableform]:not([data-json]):not([data-jltableforminit])").not($(this).find("[data-json] [data-jltableform]")).jltableform();n=$.fn.jltableform.methods;$("body").on("keydown","[data-jltableform] .table-row input[name]",function(t){var i=$(this).closest("[data-jltableform]");if($(this).closest("[data-jltableformrow]").find(".saverow").length>0)return!1;t.keyCode==13&&t.originalEvent&&(t.preventDefault(),t.stopImmediatePropagation(),n.saveform(i,$(this)))});$("body").on("change","[data-jltableform] .table-row [name]",function(t,i){var r=$(this).closest("[data-jltableform]");if($(this).closest("[data-jltableformrow]").find(".saverow").length>0)return!1;t.stopImmediatePropagation();(t.originalEvent||i)&&n.saveform(r,$(this))});$("body").on("keydown","[data-jltableform] .table-addnewrow [name]",function(t){var i=$(this).closest("[data-jltableform]");if($(this).closest("[data-jltableformrow]").find(".saverow").length>0)return!1;t.keyCode==13&&t.originalEvent&&(t.preventDefault(),t.stopImmediatePropagation(),n.saveform(i,$(this),!0))});$("body").on("click","[data-jltableform] .addrow",function(t,i){var r=$(this).closest("[data-jltableform]");t.stopImmediatePropagation();(t.originalEvent||i)&&n.saveform(r,$(this),!0)});$("body").on("click","[data-jltableform] .saverow",function(t,i){var r=$(this).closest("[data-jltableform]");t.stopImmediatePropagation();(t.originalEvent||i)&&n.saveform(r,$(this),!0)});c=$(this);$("body").on("click","[data-jltableform] .table-row .deleterow",function(n){var t,i;if(n.stopImmediatePropagation(),t=$(this).closest("[data-jltableformrow]"),i=$(this).closest("[data-jltableform]"),n.originalEvent){var r=i.attr("data-deleteaction"),u=$(this);jldeleterow(t,u,r)}});$("body").on("change","[data-jltableform] .bulkrow .form-control[name]",function(n){var u=$(this).closest("[data-jltableform]");if(n.stopImmediatePropagation(),n.originalEvent){var t=$(this).attr("name"),i=$(this).val(),r=$(this).closest(".jltable");r.find(".table-row .gridcheck:checked").each(function(){var n=$(this).closest("[data-jltableformrow]"),r=$(this);n.find("[name='"+t+"']").val()!=i&&n.find("[name='"+t+"']").val(i).trigger("change",!0)})}});$("body").on("click","[data-jltableform] .duplicaterow .duplicaterowbtn",function(t){var r,i,u;t.stopImmediatePropagation();r=$(this).closest("[data-jltableform]");t.originalEvent&&(i=$(this).closest(".jltable"),u=$(this).closest(".duplicaterow"),u.find(".form-control").each(function(){if($(this).val()){var n=$(this).attr("name"),t=$(this).val();i.find(".table-row .gridcheck:checked").each(function(){var i=$(this).closest("[data-jltableformrow]");i.find("[name='"+n+"']").val(t);$(this).closest("[data-jltableformrow]").find(".actioncolumn .form-control").val("")})}}),i.find(".table-row .gridcheck:checked").each(function(){if(!$(this).closest("[data-jltableformrow]").find(".actioncolumn .form-control").val()){var t=$(this);n.saveform(r,t,!1,!0)}}))});$("body").on("click","[data-jltableform] .bulkrow .deleterow",function(n){if(n.stopImmediatePropagation(),n.originalEvent){var t=$(this).closest("[data-jltableformrow]"),r=$(this).closest("[data-jltableform]"),e=t.attr("data-method")?t.attr("data-method"):"post",u=r.attr("data-deleteaction").replace("Delete","DeleteAll"),i={},f=$(this).closest(".jltable");i.formdata={};i.formdata.models=[];alert("Are you sure to delete selected data?",function(){f.find(".table-row .gridcheck:checked").each(function(){var n=$(this).closest(".table-row").find(".table-cell-actions").attr("data-keyname"),r=$(this).closest(".table-row").find(".table-cell-actions").attr("data-id"),f=$(this);i.formdata={};i.formdata[n]=r;t.trigger("beforedeletetableform",i);$.ajax({url:u,type:"DELETE",success:function(n){if(n&&n.Results){alert("Deleted successfully, please reload results");var i=$("#fakeitem");t.attr("data-deleteaction")&&(i=$("[data-json='"+t.attr("data-deleteaction").replace(/Remove/i,"Get")+"']"));t.attr("data-updatebinder")&&$(t.attr("data-updatebinder")).binder&&(i=i.add($(t.attr("data-updatebinder"))));i=i.not(t);f.closest(".table-row").remove()}else alert("Can't deleteit, because it using in somewhere")},data:i.formdata})})},!1,"Deleteit","c")}})});