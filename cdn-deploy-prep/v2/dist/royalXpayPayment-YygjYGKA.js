import{r as i,j as e,f}from"./main-T_zjahGS.js";import{p as U}from"./httpService-DhFNxXIP.js";import{c as R}from"./utilities-CN4lTu6a.js";import{V}from"./validationMessage-DUn8aBkg.js";import{F as E}from"./CheckCircleIcon-Do9fQXHq.js";import{F as B}from"./ExclamationTriangleIcon-BWWt-szw.js";import{F as M}from"./CreditCardIcon-IY1eCr5G.js";import{F as G}from"./GlobeAltIcon-CrR_xF5-.js";import{F as H}from"./ShieldCheckIcon-BeLuppsl.js";import{F as J}from"./ArrowPathIcon-MCRZVL3U.js";import"./index-t--hEgTQ.js";const ne=({label:I,errors:x,register:k,formData:s,onChangeValue:m,disabled:A,readOnly:L,optional:b,component:n})=>{const a="royalXpayPayment",[u,g]=i.useState(!1),[d,h]=i.useState(!1),[v,w]=i.useState(null),[X,P]=i.useState(null),$=n?.merchantKey||"",q=n?.merchantSecret||"",p=n?.amount||s?.amount||"0.00",y=n?.currency||"AED",F=n?.description||"Payment",S=n?.isLiveMode||!1,r={email:s?.email||s?.customerEmail||"",firstName:s?.firstName||s?.customerFirstName||"",lastName:s?.lastName||s?.customerLastName||"",mobilePhone:s?.mobilePhone||s?.customerPhone||"",phone:s?.phone||s?.customerPhone||""},l={city:s?.city||s?.billingCity||"",stateProvince:s?.state||s?.billingState||"",country:s?.country||s?.billingCountry||"UAE",postcodeZip:s?.zipCode||s?.billingZip||"",street:s?.address||s?.billingAddress||"",street2:s?.address2||s?.billingAddress2||""};let T=x?.[a],[j,o]=i.useState(T);i.useEffect(()=>{o(x?.[a])},[x?.[a]]),i.useEffect(()=>{h(s?.[a]===!0)},[s?.[a]]);const O=()=>{const t=[];return r.email||t.push("Email"),r.firstName||t.push("First Name"),r.lastName||t.push("Last Name"),r.mobilePhone||t.push("Mobile Phone"),l.city||t.push("City"),l.stateProvince||t.push("State/Province"),l.street||t.push("Address"),parseFloat(p)<=0&&t.push("Amount"),t},Z=async()=>{try{g(!0),o("");const t=O();if(t.length>0)throw new Error(`Missing required fields: ${t.join(", ")}`);const z={registrationId:s?.registrationId||s?.id||null,billing:{address:{city:l.city,stateProvince:l.stateProvince,country:l.country,postcodeZip:l.postcodeZip,street:l.street,street2:l.street2}},order:{amount:parseFloat(p).toFixed(2),currency:y,description:F,id:""},customer:{email:r.email,firstName:r.firstName,lastName:r.lastName,mobilePhone:r.mobilePhone,phone:r.phone||r.mobilePhone}},c=await U("/api/royalxpay/create-order",z);if(c.success)w(c.orderId),P(c.paymentLink),f.success("Payment order created successfully!"),c.paymentLink&&window.open(c.paymentLink,"_blank","width=800,height=600,scrollbars=yes,resizable=yes");else throw new Error(c.message||"Failed to create payment order")}catch(t){console.error("RoyalXpay order creation failed:",t),o(t.message),f.error(t.message)}finally{g(!1)}},K=()=>{h(!0),m&&m(a,!0),o(""),f.success("Payment marked as completed!")},_=()=>{h(!1),w(null),P(null),m&&m(a,!1)},N=$&&q,C=N&&!A&&!L&&!d;return e.jsxs("div",{className:"sm:col-span-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 rounded-lg",children:e.jsx("img",{src:"https://royalxpay.com/assets_frontend/images/RoyalXpay-whitewithtransparent.png",alt:"RoyalXpay",className:"h-8 object-contain filter brightness-0 invert"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[I||"RoyalXpay Payment",!b&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("div",{className:"flex items-center mt-1",children:S?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium",children:"Live Mode"})]}):e.jsxs("div",{className:"flex items-center text-orange-600",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Test Mode"})]})})]})]}),d&&e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(E,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-medium",children:"Completed"})]})]}),e.jsx("input",{type:"hidden",...k(a,{required:!b}),value:d?"true":""}),e.jsxs("div",{className:R("border rounded-lg p-6 bg-gradient-to-br from-white to-gray-50",d?"border-green-300 bg-green-50":"border-gray-300",j?"border-red-300":""),children:[!N&&e.jsx("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-5 w-5 text-amber-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-amber-800",children:"RoyalXpay not configured. Please set up merchant credentials."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(M,{className:"h-5 w-5 mr-2 text-gray-600"}),"Payment Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount:"}),e.jsxs("span",{className:"font-medium",children:[y," ",parseFloat(p).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Currency:"}),e.jsx("span",{className:"font-medium",children:y})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Description:"}),e.jsx("span",{className:"font-medium",children:F})]}),v&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Order ID:"}),e.jsx("span",{className:"font-mono text-xs",children:v})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(G,{className:"h-5 w-5 mr-2 text-gray-600"}),"Customer Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium truncate ml-2",children:r.email||"Not provided"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsxs("span",{className:"font-medium",children:[r.firstName," ",r.lastName]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:r.mobilePhone||"Not provided"})]})]})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(H,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("span",{className:"font-medium text-blue-900",children:"Secure Payment Features"})]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• 3D Secure Authentication"}),e.jsx("li",{children:"• PCI DSS Compliant"}),e.jsx("li",{children:"• SSL Encrypted Transactions"}),e.jsx("li",{children:"• Supports Major Credit Cards (Visa, Mastercard, Amex)"})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:d?e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(E,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-medium",children:"Payment Completed Successfully"})]}),e.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Reset"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:Z,disabled:!C||u,className:R("flex-1 inline-flex items-center justify-center gap-x-2 rounded-md px-6 py-3 text-sm font-semibold shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",C&&!u?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 focus-visible:outline-blue-600":"bg-gray-200 text-gray-700 cursor-not-allowed"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-5 w-5 animate-spin"}),"Creating Order..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-5 w-5"}),"Pay with RoyalXpay"]})}),X&&e.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 text-sm font-medium text-green-700 bg-green-100 border border-green-300 rounded-md hover:bg-green-200",children:"Mark as Completed"})]})}),!S&&N&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-yellow-900 mb-3",children:"Testing Information"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Test Merchant Credentials"}),e.jsx("p",{className:"text-blue-800 text-xs",children:"• Merchant Key: Any 16-digit number (e.g., live-1234567890123456)"}),e.jsx("p",{className:"text-blue-800 text-xs",children:"• Merchant Secret: Any 23-digit number (e.g., sec-12345678901234567890123)"})]}),e.jsx("h6",{className:"font-medium text-yellow-900 mb-2",children:"Test Cards"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Mastercard"}),e.jsx("p",{className:"text-yellow-700",children:"5123450000000008 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"5111111111111118 (No 3D)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Visa"}),e.jsx("p",{className:"text-yellow-700",children:"4508750015741019 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"4012000033330026 (No 3D)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"American Express"}),e.jsx("p",{className:"text-yellow-700",children:"345678901234564 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"371449635398431 (No 3D)"})]})]})]})]}),j&&e.jsx(V,{message:j})]})};export{ne as default};
