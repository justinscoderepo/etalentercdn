import{e as he,r as l,a as xe,d as K,q as b,n as Se,j as e,L as Q,R as W,_ as X,g as ve,p as be,k as we}from"./main-CNwsE70q.js";import{B as Y}from"./box-CfSvlUat.js";import{r as je,e as Ne,g as Ce,b as ye,u as Re,U as Te,c as Ue,S as Ae}from"./publicRegistrationHelper-DSKxe5b9.js";import{RenderRegistrationForm as Je}from"./renderRegistrationForm-DLxtPi7y.js";import{F as Ee}from"./PencilIcon-CA0sNp2r.js";import{F as Fe}from"./PrinterIcon-PWQQtAns.js";import"./alert-wKSlA-83.js";const Le=W.lazy(()=>X(()=>import("./formSubmission-CdpBaeEc.js"),[])),Ie=W.lazy(()=>X(()=>import("./modalForm-Ct03LL-Z.js"),[]));function Be({view:s,setActiveTab:y,getEvets:i,isCoordinatorView:m,setParticipantTypeInt:c,getParticipants:n,participantTypeInt:u,candidateId:d,closeModel:p,customComponents:w,allowEdit:R}){let{user:f}=he()||{};f?.RoleTitle,f?.Email?.indexOf("justnshalom")!=-1;let[o,T]=l.useState(null),[J,P]=l.useState({}),[j,t]=l.useState(null),[g,h]=l.useState(!1),[I,U]=l.useState(null),[x,A]=l.useState([]),[N,Ge]=l.useState(u==1?"Individual":u==2?"Team":""),[Z,_e]=l.useState([...je]);const z=xe(),{row:ee,status:te}=K(i||"",{select:"AllowDisplayCompetitionOrder,Description,EVId,EndDateString,EventCategory,EventCategoryTitle,EventLogo,EventName,IdentityBackgroundImage,OrganizationLogo,OrganizationName,OrganizationShortName,StartDateString,Venue,JsonSettings",doCache:!0,noGet:!i}),V=i?ee:z.eventDetails,se=i?te:z.eventStatus;let ne="finished",ae="finished",ie="finished",{row:B,status:re}=K(n||"/CandidateJson/GetParticipants",{deleteUrl:"/CandidateJson/RemoveUser",mandatoryParams:["participantType"],select:"participantList,userList,UserEmail,UserName,UserDobString,UserImage,UserMobile,UserPhone,Email,Group,Candidate,CandidateUser,JsonSettings,Gender,GroupName,Fees,TeamTeamName,Team,TeamStrength,TeamMembersList,TeamMembers,TeamStrength,CandidateIdentityNumber,TeamIdentityNumber,CompetitionOrder,CreatedBy,CreatedByUserName,ParticipationId,UserJsonSettings,TeamJsonSettings,Remarks,LevelSettings,RegistrationId",updateUrl:"/CandidateJson/UpdateParticipant",doCache:!0,filter:d?{Candidate:d,...u==1?{participantType:"1"}:u==2?{participantType:"2"}:{}}:{}}),oe=Ne(B,d,o?.UId,j?.Team),{userRole:M,users:q,userData:k,teamData:O}=oe;if(o=o||k,j=j||O,q?.length||b(localStorage.user)?.user,N=="Team"){let a=b(localStorage.user)?.user;a&&a?.Email?.indexOf("justnshalom")==-1}g=Se(se,ne,ae,ie,re)||g;let H=b(M?.JsonSettings),le=b(k?.JsonSettings),ue=b(O?.TeamJsonSettings);const D=V?.JsonSettings,E=(D!=null&&D!=""?b(D):{components:{}}).components,me=Object.keys(E??{});let de=b(J?.JsonSettings),G=me?.includes("Agreement")&&E?.Agreement?.filter(a=>a?.validate?.required&&!H[a.name]&&!de[a.name])?.length==0;G&&localStorage.setItem("isAgreementStepFilled","true"),localStorage.getItem("isAgreementStepFilled")=="true"&&(G=!0);let r=Ce(E,Z,G,N,q,{},s),F={},ce=!0,pe=()=>{p&&p()};if(d&&!B)return e.jsx(Q,{});let S=[];if(N=="Individual"){let a=[];a.push(r[0]),S.push(a);let v=[];r.length>1&&v.push(r[1]),S.push(v),v=[],r.length>2&&v.push(r[2]),S.push(v);let C=[];r.length>3&&C.push(r[3]),S.push(C)}else{let a=[];r.length>2&&a.push(r[2]),S.push(a),a=[],r.length>3&&a.push(r[3]),S.push(a);let v=[];r.length>4&&v.push(r[4]),S.push(v);let C=[];r.length>5&&C.push(r[5]),S.push(C)}return e.jsx("div",{children:e.jsx(Ie,{title:"Registration Form",description:"Please fill the form to register for the event",open:!0,customHeading:w||null,setOpen:()=>{pe()},children:e.jsx(Y,{heading:"",outerClasses:"relative w-full",headingClasses:"px-1 lg:px-4 print:hidden w-full",children:e.jsx("div",{className:"w-full mt-5 min-h-[600px] print:mt-0 flex flex-col",id:"registrationBox",children:S.map((a,v)=>e.jsx("div",{className:"flex w-full flex-1 gap-x-8",children:a.map((C,fe)=>{F=C,x=ye(E,F);let ge=F?Re(F.name,{},()=>{},()=>{},F,M,H,k,le,N,O,B,E,o,j,ue,!1):{};return e.jsx("div",{className:"flex-1",children:e.jsx(Le,{isPrint:!0,isCoordinatorView:m,participantType:N,isGuardianRegistration:!1,handleNext:()=>{},isSubmitted:ce,eventDetails:V,isPlayGround:!1,onChange:()=>{},data:ge,isLastStep:!1,existingComponents:x,selectedComponent:I,setSelectedComponent:()=>{},components:x,setComponents:()=>{}},fe)})})}))})})})})}var _={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var $;function ke(){return $||($=1,(function(s){(function(){var y={}.hasOwnProperty;function i(){for(var m=[],c=0;c<arguments.length;c++){var n=arguments[c];if(n){var u=typeof n;if(u==="string"||u==="number")m.push(n);else if(Array.isArray(n)){if(n.length){var d=i.apply(null,n);d&&m.push(d)}}else if(u==="object"){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){m.push(n.toString());continue}for(var p in n)y.call(n,p)&&n[p]&&m.push(p)}}}return m.join(" ")}s.exports?(i.default=i,s.exports=i):window.classNames=i})()})(_)),_.exports}var Oe=ke();const L=ve(Oe);let De=({selectedParticipantDetails:s,participantType:y,setAllowEdit:i,setOpen:m,setFilter:c,setPrint:n,eventDetails:u})=>{let d=localStorage.getItem("siteConfig")?JSON.parse(localStorage.getItem("siteConfig")):{};const[p,w]=l.useState(!1),[R,f]=l.useState(""),[o,T]=l.useState("Pending"),J=(t,g)=>{let h="";if(g==="Approved"){h="Thank you for your registration, "+t?.UserName+`
`,h+="Based on your date of birth ("+t?.UserDobString+"), you have been assigned to the "+t?.GroupName+` age group and successfully registered for the following competitions:
`;let I=t?.participatingCompetitions,U={};I?.forEach(x=>{let A=x?.GroupName;U[A]||(U[A]=[]),U[A].push(x)});for(const x in U)h+=`
`+x+` Group
`,U[x].forEach((A,N)=>{h+=N+1+" - "+A?.Title+`
`});h+=`
Please login with the credentials sent in your email to see candidate details and participation informations under the Participation tab. 
`,h+="Login: "+d?.emailConfigSiteUrl+`
`}f(h),T(g),w(!0)},P=()=>{if(T(o),R.trim()){f(""),w(!1);let t=b(s?.user?.JsonSettings);t||(t={}),t.ApprovalStatus=o,t.ReviewComments||(t.ReviewComments=[]),t.ReviewComments.push({Comment:R,Status:o,Date:new Date().toISOString()}),o==="Reviewed"&&(t.FinishedSteps=!1),o==="Approved"&&(t.FinishedSteps=!0);let g={ParticipantType:y,UserRoleId:s.user.Candidate,TeamId:s.user.Team,JsonSettings:JSON.stringify(t)};be("/UsersRolesJson/Approve",g).then(h=>{we.success("Review submitted successfully and emailed to the user."),i(!1),m(!1),c(!0)})}else alert("Please add a comment before submitting.")};let j=[];if(s?.user?.JsonSettings){let t=b(s?.user?.JsonSettings);t?.ReviewComments&&(j=t?.ReviewComments)}return e.jsxs("div",{className:"border-b border-gray-200 pb-5 bg-white flex flex-1 flex-col pr-10 print:pr-0",children:[e.jsxs("div",{className:"sm:flex flex-row sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1 gap-x-10",children:[s?.user?.UserName&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.CandidateIdentityNumber," - ",s?.user?.UserName]}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.Email}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.UserMobile}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.UserDobString})]}),s?.user?.TeamTeamName&&e.jsx(e.Fragment,{children:e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.TeamIdentityNumber," -",s?.user?.TeamTeamName]})}),e.jsxs("button",{className:"inline-flex items-center print:hidden gap-x-1.5 px-10 rounded-md bg-blue-600 mt-5  py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",onClick:()=>i(!0),children:[e.jsx(Ee,{className:"h-5 w-5 inline-block -mt-0.5 mr-0 "}),"Edit"]}),e.jsx("button",{onClick:()=>{n(!0)},className:"bg-darkprimary text-white px-10  ml-2 py-1.5 rounded-md print:hidden",children:e.jsx(Fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"hidden print:flex  max-h-90  flex-col justify-items-end flex-wrap",children:[e.jsx("div",{className:"text-primary text-right",children:u?.EventName}),e.jsx("div",{className:"justify-end flex",children:e.jsx("img",{src:u?.EventLogo,alt:"logo",className:"max-h-16 w-auto"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col space-y-4 print:hidden",children:[e.jsx(Te,{person:s?.user}),e.jsx(Ue,{onClick:J,person:s?.user})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{children:j.map((t,g)=>e.jsx("div",{className:"mt-2 flex flex-col relative",children:e.jsx("div",{className:L("border-l-4 p-4",t?.Status==="Reviewed"?"border-yellow-400 bg-yellow-50":t?.Status==="Approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"),children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:L("text-lg font-bold",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Status}),e.jsx("p",{className:L("text-sm whitespace-pre-line",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Comment??t}),e.jsx("p",{className:L("font-medium text-right ",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Date})]})})})},g))}),p&&e.jsx("div",{className:"mt-2 flex flex-col relative print:hidden",children:e.jsxs(Y,{heading:"Please enter the reason for change status to "+o,childrenClasses:"flex flex-col mt-4 relative",children:[e.jsxs("div",{className:"rounded-lg bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment..."}),e.jsx("textarea",{id:"comment",name:"comment",rows:6,placeholder:"Add your comment..., The comment will be sent to the user via email.",className:"block w-full rounded-lg resize-none bg-transparent px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",value:R,onChange:t=>f(t.target.value)})]}),e.jsxs("div",{className:" inset-x-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:[e.jsx("div",{className:"flex items-center space-x-5"}),e.jsx("div",{className:"shrink-0",children:e.jsx(Ae,{onClick:P,currentReviewStatus:o})})]})]})})]})]})};function We({participantType:s,candidateId:y,eventDetails:i,setFilter:m,selectedParticipantDetails:c,setOpen:n,idEdit:u=!1,isDirectOpen:d=!1}){let[p,w]=l.useState(!!u),[R,f]=l.useState(!1),[o,T]=l.useState(!1),J=R?Be:Je;return e.jsx(J,{isDirectOpen:d,isCoordinatorView:!0,view:"participationDetails",getEventsLink:"/EventJson/Get",allowEdit:p,customComponents:e.jsxs(e.Fragment,{children:[o&&e.jsx(Q,{}),e.jsx(De,{setPrint:()=>{window.parent.document.title="Candiidate Details - "+c.user.UserName+" - "+c.user.UserDobString,f(!0),T(!0),window.onafterprint=()=>{f(!1)},setTimeout(()=>{T(!1)},2e3),setTimeout(()=>{window.print()},3e3)},participantType:s,eventDetails:i,selectedParticipantDetails:c,setFilter:m,setOpen:n,setAllowEdit:w})]}),getParticipantsLink:"/CoordinatorJson/GetParticipants",closeModel:()=>{n(!1)},participantTypeInt:s,candidateId:y,setActiveTab:()=>{}})}export{We as default};
