import{r,j as e}from"./main-C93JHIOS.js";import{B as u}from"./react-toastify.esm-CzmeULdp.js";import{F as f}from"./CheckCircleIcon-DPyZOfl1.js";import{F as b}from"./XCircleIcon-1ADqkybN.js";import{h as j}from"./navigationUtils-W0BRL3MD.js";import"./clsx-B-dksMZM.js";const C=()=>{const[x]=j(),[a,s]=r.useState("processing"),[g,o]=r.useState(""),[n,p]=r.useState(""),[h,y]=r.useState(!1),l=x.get("token"),i=async(t="")=>{if(!l){s("error"),o("Invalid or missing token");return}try{const m=await(await fetch("/EventRemindersJson/OptOut",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Token:l,Reason:t||n||"User opted out via email link"})})).json();m.items?(s("success"),o(m.items.Message||"You have been successfully opted out from reminders."),u.success("Successfully opted out!")):(s("error"),o(m.message||"Failed to opt out. Please try again."),u.error("Opt-out failed"))}catch(d){console.error("Error opting out:",d),s("error"),o("An error occurred while processing your request."),u.error("Error: "+d.message)}},c=t=>{i(t)};return r.useEffect(()=>{x.get("auto")==="true"&&l&&i("Auto opted out via email link")},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-xl overflow-hidden",children:[a==="processing"&&e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-full mb-4",children:e.jsxs("svg",{className:"animate-spin h-8 w-8 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Stop Event Reminders"}),e.jsx("p",{className:"text-gray-600",children:"We're sorry to see you go. Please let us know why you want to opt out of future event reminders."})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{onClick:()=>c("No longer interested in events"),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"No longer interested"}),e.jsx("p",{className:"text-sm text-gray-600",children:"I don't want to participate in events anymore"})]}),e.jsxs("button",{onClick:()=>c("Not with the organization anymore"),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Left the organization"}),e.jsx("p",{className:"text-sm text-gray-600",children:"I'm no longer part of this organization"})]}),e.jsxs("button",{onClick:()=>c("Too many emails"),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Too many emails"}),e.jsx("p",{className:"text-sm text-gray-600",children:"I receive too many reminder emails"})]}),e.jsxs("button",{onClick:()=>y(!h),className:"w-full text-left px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Other reason"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Specify your own reason"})]})]}),h&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Reason (Optional)"}),e.jsx("textarea",{value:n,onChange:t=>p(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:"3",placeholder:"Tell us why you want to opt out..."}),e.jsx("button",{onClick:()=>i(n),className:"mt-3 w-full bg-red-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Submit & Opt Out"})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"By clicking any option above, you will no longer receive reminder emails for this event."})]}),a==="success"&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(f,{className:"h-10 w-10 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Successfully Opted Out"}),e.jsx("p",{className:"text-gray-600 mb-6",children:g}),e.jsx("p",{className:"text-sm text-gray-500",children:"You will no longer receive reminder emails for this event. If you change your mind, you can contact the event organizer directly."})]}),a==="error"&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:e.jsx(b,{className:"h-10 w-10 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Opt-Out Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:g}),e.jsx("button",{onClick:()=>s("processing"),className:"px-6 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Try Again"})]})]})})};export{C as default};
