import{g as ce,r as o,p as b,j as e,L as $,a as Q,_ as W,f as ge,d as fe}from"./main-BTxYPv0w.js";import{B as X}from"./box-WSpyXs8E.js";import{u as H,i as he}from"./useBackend-CblGpngf.js";import{r as xe,e as Se,g as ve,d as be,u as we,U as je,f as Ne,S as Ce}from"./publicRegistrationHelper-Bd0w2fTh.js";import{R as ye}from"./renderRegistrationForm-DObFDW0W.js";import{p as Re}from"./httpService-COMwHiVS.js";import{F as Ue}from"./PencilIcon-B1pfmL72.js";import{F as Te}from"./PrinterIcon-Bx_eOmXk.js";import"./utilities-CN4lTu6a.js";import"./useConfirmation-q7cjOGwg.js";import"./dialog-BqguU9KB.js";import"./keyboard-wSkleyN5.js";import"./CheckIcon-CGQDP91E.js";import"./TrashIcon-D1Ai0PWr.js";import"./eventDetailedView-Df9faCot.js";import"./navigationUtils-BLWJCr5T.js";import"./UserPlusIcon-BHpirQYr.js";import"./UserGroupIcon-BMyE4m80.js";import"./ChevronRightIcon-GlGzyr-8.js";import"./TrashIcon-BUu4eKwJ.js";import"./index-t--hEgTQ.js";const Je=Q.lazy(()=>W(()=>import("./formSubmission-CHy5E0Zd.js"),[])),Ee=Q.lazy(()=>W(()=>import("./modalForm-C0iiDvso.js"),[]));function Ae({view:s,setActiveTab:y,getEvets:l,isCoordinatorView:u,setParticipantTypeInt:p,getParticipants:i,participantTypeInt:m,candidateId:d,closeModel:c,customComponents:w,allowEdit:R}){let{user:h}=ce()||{};h?.RoleTitle,h?.Email?.indexOf("justnshalom")!=-1;let[r,I]=o.useState(null),[A,k]=o.useState({}),[j,t]=o.useState(null),[x,g]=o.useState(!1),[L,U]=o.useState(null),[S,T]=o.useState([]),[N,Ge]=o.useState(m==1?"Individual":m==2?"Team":""),[Y,Be]=o.useState([...xe]);const{row:z,status:Z}=H(l||"/CandidateJson/GetEvents",{select:"AllowDisplayCompetitionOrder,Description,EVId,EndDateString,EventCategory,EventCategoryTitle,EventLogo,EventName,IdentityBackgroundImage,OrganizationLogo,OrganizationName,OrganizationShortName,StartDateString,Venue,JsonSettings",doCache:!0});let ee="finished",te="finished",se="finished",{row:G,status:ie}=H(i||"/CandidateJson/GetParticipants",{deleteUrl:"/CandidateJson/RemoveUser",mandatoryParams:["participantType"],select:"participantList,userList,UserEmail,UserName,UserDobString,UserImage,UserMobile,UserPhone,Email,Group,Candidate,CandidateUser,JsonSettings,Gender,GroupName,Fees,TeamTeamName,Team,TeamStrength,TeamMembersList,TeamMembers,TeamStrength,CandidateIdentityNumber,TeamIdentityNumber,CompetitionOrder,CreatedBy,CreatedByUserName,ParticipationId,UserJsonSettings,TeamJsonSettings,Remarks,LevelSettings,RegistrationId",updateUrl:"/CandidateJson/UpdateParticipant",doCache:!0,filter:d?{Candidate:d,...m==1?{participantType:"1"}:m==2?{participantType:"2"}:{}}:{}}),ne=Se(G,d,r?.UId,j?.Team),{userRole:V,users:M,userData:B,teamData:O}=ne;if(r=r||B,j=j||O,M?.length||b(localStorage.user)?.user,N=="Team"){let n=b(localStorage.user)?.user;n&&n?.Email?.indexOf("justnshalom")==-1}x=he(Z,ee,te,se,ie)||x;let q=b(V?.JsonSettings),ae=b(B?.JsonSettings),re=b(O?.TeamJsonSettings);const _=z?.JsonSettings,J=(_!=null&&_!=""?b(_):{components:{}}).components,oe=Object.keys(J??{});let le=b(A?.JsonSettings),D=oe?.includes("Agreement")&&J?.Agreement?.filter(n=>n?.validate?.required&&!q[n.name]&&!le[n.name])?.length==0;D&&localStorage.setItem("isAgreementStepFilled","true"),localStorage.getItem("isAgreementStepFilled")=="true"&&(D=!0);let a=ve(J,Y,D,N,M,{},s),E={},me=!0,ue=()=>{c&&c()};if(d&&!G)return e.jsx($,{});let f=[];if(N=="Individual"){let n=[];n.push(a[0]),f.push(n);let v=[];a.length>1&&v.push(a[1]),f.push(v),v=[],a.length>2&&v.push(a[2]),f.push(v);let C=[];a.length>3&&C.push(a[3]),f.push(C)}else{let n=[];a.length>2&&n.push(a[2]),f.push(n),n=[],a.length>3&&n.push(a[3]),f.push(n);let v=[];a.length>4&&v.push(a[4]),f.push(v);let C=[];a.length>5&&C.push(a[5]),f.push(C)}return console.log({splitBy2:f}),e.jsx("div",{children:e.jsx(Ee,{title:"Registration Form",description:"Please fill the form to register for the event",open:!0,customHeading:w||null,setOpen:()=>{ue()},children:e.jsx(X,{heading:"",outerClasses:"relative w-full",headingClasses:"px-1 lg:px-4 print:hidden w-full",children:e.jsx("div",{className:"w-full mt-5 min-h-[600px] print:mt-0 flex flex-col",id:"registrationBox",children:f.map((n,v)=>e.jsx("div",{className:"flex w-full flex-1 gap-x-8",children:n.map((C,de)=>{E=C,S=be(J,E);let pe=E?we(E.name,{},()=>{},()=>{},E,V,q,B,ae,N,O,G,J,r,j,re,!1,A):{};return e.jsx("div",{className:"flex-1",children:e.jsx(Je,{isPrint:!0,isCoordinatorView:u,participantType:N,isGuardianRegistration:!1,handleNext:()=>{},isSubmitted:me,eventDetails:z,isPlayGround:!1,onChange:()=>{},data:pe,isLastStep:!1,existingComponents:S,selectedComponent:L,setSelectedComponent:()=>{},components:S,setComponents:()=>{}},de)})})}))})})})})}var P={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var K;function Fe(){return K||(K=1,(function(s){(function(){var y={}.hasOwnProperty;function l(){for(var u=[],p=0;p<arguments.length;p++){var i=arguments[p];if(i){var m=typeof i;if(m==="string"||m==="number")u.push(i);else if(Array.isArray(i)){if(i.length){var d=l.apply(null,i);d&&u.push(d)}}else if(m==="object"){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){u.push(i.toString());continue}for(var c in i)y.call(i,c)&&i[c]&&u.push(c)}}}return u.join(" ")}s.exports?(l.default=l,s.exports=l):window.classNames=l})()})(P)),P.exports}var Ie=Fe();const F=ge(Ie);let Le=({selectedParticipantDetails:s,participantType:y,setAllowEdit:l,setOpen:u,setFilter:p,setPrint:i,eventDetails:m})=>{let d=localStorage.getItem("siteConfig")?JSON.parse(localStorage.getItem("siteConfig")):{};const[c,w]=o.useState(!1),[R,h]=o.useState(""),[r,I]=o.useState("Pending"),A=(t,x)=>{let g="";if(console.log("selectedParticipantDetails",t),x==="Approved"){g="Thank you for your registration, "+t?.UserName+`
`,g+="Based on your date of birth ("+t?.UserDobString+"), you have been assigned to the "+t?.GroupName+` age group and successfully registered for the following competitions:
`;let L=t?.participatingCompetitions,U={};L?.forEach(S=>{let T=S?.GroupName;U[T]||(U[T]=[]),U[T].push(S)});for(const S in U)g+=`
`+S+` Group
`,U[S].forEach((T,N)=>{g+=N+1+" - "+T?.Title+`
`});g+=`
Please login with the credentials sent in your email to see candidate details and participation informations under the Participation tab. 
`,g+="Login: "+d?.emailConfigSiteUrl+`
`}console.log("mailComment",g),h(g),I(x),w(!0)},k=()=>{if(I(r),R.trim()){h(""),w(!1);let t=b(s?.user?.JsonSettings);t||(t={}),t.ApprovalStatus=r,t.ReviewComments||(t.ReviewComments=[]),t.ReviewComments.push({Comment:R,Status:r,Date:new Date().toISOString()}),r==="Reviewed"&&(t.FinishedSteps=!1),r==="Approved"&&(t.FinishedSteps=!0);let x={ParticipantType:y,UserRoleId:s.user.Candidate,TeamId:s.user.Team,JsonSettings:JSON.stringify(t)};Re("/UsersRolesJson/Approve",x).then(g=>{fe.success("Review submitted successfully and emailed to the user."),l(!1),u(!1),p(!0)})}else alert("Please add a comment before submitting.")};let j=[];if(s?.user?.JsonSettings){let t=b(s?.user?.JsonSettings);t?.ReviewComments&&(j=t?.ReviewComments)}return e.jsxs("div",{className:"border-b border-gray-200 pb-5 bg-white flex flex-1 flex-col pr-10 print:pr-0",children:[e.jsxs("div",{className:"sm:flex flex-row sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1 gap-x-10",children:[s?.user?.UserName&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.CandidateIdentityNumber," - ",s?.user?.UserName]}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.Email}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.UserMobile}),e.jsx("p",{className:"mt-1 truncate text-sm text-gray-500",children:s?.user?.UserDobString})]}),s?.user?.TeamTeamName&&e.jsx(e.Fragment,{children:e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.TeamIdentityNumber," -",s?.user?.TeamTeamName]})}),e.jsxs("button",{className:"inline-flex items-center print:hidden gap-x-1.5 px-10 rounded-md bg-blue-600 mt-5  py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",onClick:()=>l(!0),children:[e.jsx(Ue,{className:"h-5 w-5 inline-block -mt-0.5 mr-0 "}),"Edit"]}),e.jsx("button",{onClick:()=>{i(!0)},className:"bg-darkprimary text-white px-10  ml-2 py-1.5 rounded-md print:hidden",children:e.jsx(Te,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"hidden print:flex  max-h-90  flex-col justify-items-end flex-wrap",children:[e.jsx("div",{className:"text-primary text-right",children:m?.EventName}),e.jsx("div",{className:"justify-end flex",children:e.jsx("img",{src:m?.EventLogo,alt:"logo",className:"max-h-16 w-auto"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col space-y-4 print:hidden",children:[e.jsx(je,{person:s?.user}),e.jsx(Ne,{onClick:A,person:s?.user})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{children:j.map((t,x)=>e.jsx("div",{className:"mt-2 flex flex-col relative",children:e.jsx("div",{className:F("border-l-4 p-4",t?.Status==="Reviewed"?"border-yellow-400 bg-yellow-50":t?.Status==="Approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"),children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:F("text-lg font-bold",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Status}),e.jsx("p",{className:F("text-sm whitespace-pre-line",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Comment??t}),e.jsx("p",{className:F("font-medium text-right ",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Date})]})})})},x))}),c&&e.jsx("div",{className:"mt-2 flex flex-col relative print:hidden",children:e.jsxs(X,{heading:"Please enter the reason for change status to "+r,childrenClasses:"flex flex-col mt-4 relative",children:[e.jsxs("div",{className:"rounded-lg bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment..."}),e.jsx("textarea",{id:"comment",name:"comment",rows:6,placeholder:"Add your comment..., The comment will be sent to the user via email.",className:"block w-full rounded-lg resize-none bg-transparent px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",value:R,onChange:t=>h(t.target.value)})]}),e.jsxs("div",{className:" inset-x-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:[e.jsx("div",{className:"flex items-center space-x-5"}),e.jsx("div",{className:"shrink-0",children:e.jsx(Ce,{onClick:k,currentReviewStatus:r})})]})]})})]})]})};function rt({participantType:s,candidateId:y,eventDetails:l,setFilter:u,selectedParticipantDetails:p,setOpen:i}){let[m,d]=o.useState(!1),[c,w]=o.useState(!1),[R,h]=o.useState(!1),r=c?Ae:ye;return e.jsx(r,{isCoordinatorView:!0,view:"participationDetails",getEvets:"/EventJson/Get",allowEdit:m,getUserRoles:"/UsersRolesPlusUsersJson/Get",getTeams:"/CompetitionParticipantsTeamsJson/Get",getUsers:"/UsersRolesPlusUsersJson/Get",customComponents:e.jsxs(e.Fragment,{children:[R&&e.jsx($,{}),e.jsx(Le,{setPrint:()=>{window.parent.document.title="Candiidate Details - "+p.user.UserName+" - "+p.user.UserDobString,w(!0),h(!0),window.onafterprint=()=>{w(!1)},setTimeout(()=>{h(!1)},2e3),setTimeout(()=>{window.print()},3e3)},participantType:s,eventDetails:l,selectedParticipantDetails:p,setFilter:u,setOpen:i,setAllowEdit:d})]}),getParticipants:"/CoordinatorJson/GetParticipants",closeModel:()=>{i(!1)},participantTypeInt:s,candidateId:y,setActiveTab:()=>{}})}export{rt as default};
