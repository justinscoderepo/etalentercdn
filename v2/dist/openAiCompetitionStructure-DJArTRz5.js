import{r,j as e,L as q,h as Q,t as T,v as se,p as X}from"./main-CFuZbwu-.js";import{C as le,u as ae}from"./index.esm-Cp4oFFOI.js";import{L as re}from"./layoutOuter-D-5IlDlv.js";import{P as ie}from"./pageHeader-Dw8EoUZJ.js";import{V as oe}from"./validationMessage-BvVDG05Q.js";import{F as ne}from"./XMarkIcon-BSKwIPS2.js";import{v as W}from"./v4-BKT09osN.js";function ce({title:n,titleId:d,...s},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":d},s),n?r.createElement("title",{id:d},n):null,r.createElement("path",{fillRule:"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z",clipRule:"evenodd"}))}const de=r.forwardRef(ce);function me({optional:n,control:d,fieldName:s,label:i,errors:a,enableCrop:m,onChangeValidation:c,viewOnly:g,aspect:u,disableRequiredsymbol:b,validVideoExtensions:_,validImageExtensions:M,validExtensions:E,rules:A,labelFont:P,fileUploadUrl:U,isImageOptimize:O}){let D=a?.[s],[w,z]=r.useState(D);const[J,t]=r.useState(!1);let[l,f]=r.useState([]);r.useEffect(()=>{z(a?.[s])},[a?.[s]]);function V(x,o){const p=x.split(","),S=p[0].match(/:(.*?);/)[1],I=atob(p[1]);let j=I.length;const h=new Uint8Array(j);for(;j--;)h[j]=I.charCodeAt(j);return new File([h],o,{type:S})}const H=async x=>{try{t(!0);let o=await se(`${U}`,x);o?.data?.Results&&(o.data?(l.push({filePath:o.data.Results,webUrl:`${o.data.Results}`}),f(l),c(l)):(T.error("Failed to upload"),c([{filePath:"",webUrl:""}])),t(!1))}catch(o){T.error(o?.response?.data?.message),c([{filePath:"",webUrl:""}])}t(!1)};return e.jsx("div",{className:"overflow-hidden min-h-64",children:J?e.jsx(q,{}):e.jsx("div",{className:"",children:e.jsx("div",{children:e.jsx("div",{className:"",children:!g&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-5",children:[e.jsx("label",{htmlFor:s,className:Q(P||" text-sm text-center block font-medium text-gray-700 mb-1",w?"text-danger":"text-gray-400"),children:i||s}),A&&A.required&&!b?e.jsx("sup",{}):"",e.jsx(le,{name:s,control:d,rules:{required:!n},render:({field:x})=>e.jsxs("div",{className:Q("flex flex-col p-10 w-full border-0 pt-4 border-b border-transparent bg-gray-100 focus:border-darkprimary focus:ring-0 sm:text-sm",w?"border-danger":"text-gray-200 border-purple-400"),children:[x?.value?.length?e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-1 w-full relative h-full  space-x-8  grow flex-row items-center rounded-lg tracking-wide overflow-x-scroll",children:x.value.map((o,p)=>e.jsxs("div",{className:"relative flex flex-shrink-0",children:[e.jsx("img",{src:o.webUrl,alt:`Image ${p}`,className:"max-h-100 flex w-96 mb-3 mr-3 nonselectable",draggable:!1}),e.jsx("div",{className:"absolute top-0 right-0  pt-2 pr-2 block",children:e.jsxs("button",{type:"button",className:"rounded-md bg-transparent text-shadow text-white hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 bg-lightcharcoal p-2 bg-opacity-90",onClick:()=>{setTimeout(()=>{l=l.filter((S,I)=>I!==p),f(l),c(l)},100)},children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(ne,{className:"h-8 w-8 text-[#c5c5c5]","aria-hidden":"true"})]})})]},p))})}):e.jsx(e.Fragment,{}),e.jsxs("label",{className:"w-100 relative h-full flex flex-col items-center rounded-lg tracking-wide cursor-pointer ",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-8 h-8 mt-8 text-primary",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z",className:"text-lightcharcoal"}),e.jsx("path",{className:"text-lightcharcoal",strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),e.jsx("span",{className:"mt-2 font-medium leading-normal text-primary mb-8",children:"Upload"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:async o=>{t(!0);const p=Array.from(o.target.files);let S=0;if(p.forEach(h=>{S+=h.size}),S/(1024*1024)>10){T.error("Total file size should be lesser than 10MB."),t(!1);return}const j=p.map(h=>new Promise(($,Z)=>{const y=new FileReader;y.onload=function(F){$(F.target.result)},y.readAsDataURL(h)}));Promise.all(j).then(h=>{h.forEach(($,Z)=>{const y=new FormData,F=p[Z];let N,v;const k=new Image;k.src=$,k.onload=async function(){if(O===!0){const C=k.height,G=k.width,L=document.createElement("canvas"),Y=L.getContext("2d");if(C>300&&G>300)if(G<C){N=300;const B=G/N;v=C/B}else{v=300;const B=C/v;N=G/B}else v=C,N=G;L.width=N,L.height=v,Y.drawImage(k,0,0,N,v);const ee=L.toDataURL("image/jpeg"),K=V(ee,F.name);let te=URL.createObjectURL(K);x.onChange([...x.value,te]),y.append("file",K)}else y.append("file",F);H(y)}})}),o.target.value=""}})]})]})}),w&&e.jsx(oe,{message:"This file is required"})]})})})})})})}const xe=async(n,d,s)=>{if(!n?.length){alert("Please upload an image");return}try{const a={imageUrls:n.map(c=>c.webUrl),aiPrompt:s||"Generate competitions from the image."},m=await X("/AIHelperJson/GetResultFromImage",a);m&&m.success?d(m.data):(console.error("API Error:",m?.message||"Unknown error"),alert("Error processing image: "+(m?.message||"Unknown error")))}catch(i){console.error("Error:",i),alert("Error processing image: "+(i.message||"Network error"))}},R=({heading:n,items:d,isLoading:s,columns:i})=>e.jsx(e.Fragment,{children:d?.length>0&&e.jsxs("div",{className:"px-2 sm:px-4 lg:px-6 relative",children:[s&&e.jsx(q,{}),e.jsx("div",{className:"sm:flex sm:items-center",children:e.jsx("h1",{className:"text-sm font-semibold leading-6 text-onSurface",children:n})}),e.jsx("div",{className:"mt-4 flow-root",children:e.jsx("div",{className:"-mx-2 -my-1 overflow-x-auto sm:-mx-4 lg:-mx-6",children:e.jsx("div",{className:"inline-block min-w-full py-1 align-middle sm:px-4 lg:px-6",children:e.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{className:"bg-surfaceCard",children:e.jsx("tr",{children:i.map(a=>e.jsx("th",{scope:"col",className:"py-2 pl-2 pr-1 text-left text-xs font-semibold text-onSurface sm:pl-4",children:a.label},a.field))})}),e.jsx("tbody",{className:"divide-y divide-border bg-contentBgOuter",children:d?.map(a=>e.jsx("tr",{className:"divide-x divide-gray-200",children:i.map(m=>e.jsx("td",{className:"whitespace-nowrap px-1 py-2 text-xs text-onSurfaceVariant",children:a[m.field]},m.field))},a.GroupName))})]})})})})})]})});function ye(){const[n,d]=r.useState(localStorage.getItem("aiPrompt")||""),[s,i]=r.useState([]),[a,m]=r.useState(!1),[c,g]=r.useState(!1),[u,b]=r.useState([]),{control:_,getValues:M,setValue:E,formState:{errors:A}}=ae();let P=M();r.useEffect(()=>{let t=sessionStorage.getItem("competitionsGroups");t&&i(JSON.parse(t));let l=sessionStorage.getItem("images");l&&E("fileUploads",JSON.parse(l));let f=sessionStorage.getItem("selectedCheckboxes");f&&b(JSON.parse(f))},[]);const U=async t=>{t.competitionsAssignedToGroup?.forEach(l=>{l.Id||(l.Id=W())}),i(t),sessionStorage.setItem("competitionsGroups",JSON.stringify(t)),g(!1)},O=()=>{g(!0);const t=M("fileUploads");xe(t,U,n)},D=async()=>{if(g(!0),u.length>0){let t=s.competitionsAssignedToGroup.filter(f=>u.includes(f.Id)),l={...s,competitionsAssignedToGroup:t};await X("/SetUpJson/InstallEventSettingsItems",l),T.success("Competitions have been successfully installed"),setTimeout(()=>{window.top.location.href="/CompetitionStructure/Tab"},2e3),g(!1)}else T.error("Please select at least one competition"),g(!1)},w=(t,l)=>{let f={...t,GenderGenderTitle:"Male",Id:W()},V={...t,GenderGenderTitle:"Female",Id:W()},H=s.competitionsAssignedToGroup.slice(0,l),x=s.competitionsAssignedToGroup.slice(l+1);s.competitionsAssignedToGroup=[...H,f,V,...x],U({...s})},z=()=>{const t=s.competitionsAssignedToGroup.map(l=>l.Id);b(a?[]:t),m(!a),sessionStorage.setItem("selectedCheckboxes",JSON.stringify(u))},J=t=>{u.includes(t)?b(u.filter(l=>l.id!==t)):b([...u,t]),sessionStorage.setItem("selectedCheckboxes",JSON.stringify(u))};return e.jsx(re,{children:e.jsxs("div",{className:"flex flex-col grow",children:[e.jsx(ie,{heading:"AI Competition Structure",subHeading:"Upload images and use AI to generate competition structure automatically"}),e.jsxs("div",{className:"flex justify-center w-full flex-col place-items-center",children:[e.jsx(me,{label:"Upload Images Related to the competition",errors:A,control:_,validExtensions:["jpg","png","jpeg"],validExtensionsMimeTypes:["image/jpg","image/png","image/jpeg"],fieldName:"fileUploads",fileUploadUrl:"/uploadJson/UploadCandidateImage",editId:P?.id,onChangeValidation:t=>{sessionStorage.setItem("images",JSON.stringify(t)),E("fileUploads",t)}}),e.jsxs("div",{className:"mt-4 px-10 flex flex-col w-full",children:[e.jsx("label",{htmlFor:"aiPrompt",className:"block text-sm font-semibold text-onSurface",children:"AI Prompt"}),e.jsx("textarea",{id:"aiPrompt",name:"aiPrompt",value:n,onChange:t=>{d(t.target.value),localStorage.setItem("aiPrompt",t.target.value)},rows:"4",className:"mt-1 min-w-full max-w-full block w-full shadow-sm sm:text-sm focus:ring-primary focus:border-primary border-border rounded-md",placeholder:"Enter the AI Prompt"})]}),e.jsx("button",{onClick:O,className:"mt-8 w-full max-w-72 rounded-md bg-primary px-3 py-2 text-sm font-semibold text-white shadow hover:bg-primaryHover focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:"Get Results"}),e.jsx("a",{href:"https://ilovepdf.com/pdf_to_jpg",target:"_blank",className:"text-sm text-blue-500 mt-2",rel:"noreferrer",children:"Donâ€™t have an Image to test? Click here to convert PDF to Image"})]}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mt-8 flow-root",children:e.jsxs("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx(R,{heading:"Age Wise Groups",items:s?.ageWiseGroups,isLoading:c,columns:[{field:"GroupName",label:"Group Name"},{field:"AgeFrom",label:"Age From"},{field:"AgeTo",label:"Age To"}]}),e.jsx(R,{heading:"Competition Items",items:s?.competitionItems,isLoading:c,columns:[{field:"Title",label:"Title"},{field:"CategoryCategoryName",label:"Category"},{field:"ScoreLabelLabel",label:"Score By"}]}),e.jsx(R,{heading:"Ranks",items:s?.ranks,isLoading:c,columns:[{field:"ParticipantTypeTitle",label:"Participant Type"},{field:"GroupGroupName",label:"Group Name"},{field:"CompetitionItemTitle",label:"Competition Item"},{field:"RankTitle",label:"Rank Title"},{field:"Points",label:"Points"}]}),e.jsx(R,{heading:"Grades",items:s?.grades,isLoading:c,columns:[{field:"ParticipantTypeTitle",label:"Participant Type"},{field:"GroupGroupName",label:"Group Name"},{field:"CompetitionItemTitle",label:"Competition Item"},{field:"GradeName",label:"Grade Title"},{field:"Points",label:"Points"}]})]}),e.jsx("div",{className:"sm:flex sm:items-center px-10 mt-10",children:e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-base font-semibold leading-6 text-onSurface",children:"Generated Competitions"}),e.jsx("p",{className:"mt-2 text-sm text-onSurfaceVariant",children:"A list of all AI generated competitions."})]})}),e.jsxs("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8 relative",children:[c&&e.jsx(q,{}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"divide-x divide-gray-200",children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-sm font-semibold text-onSurface sm:pl-2",children:e.jsx("input",{id:"selectAll",name:"selectAll",type:"checkbox",checked:a,"aria-describedby":"selectAll-description",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",onChange:z})}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Participant Type"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Group Name"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Competition Name"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Language"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Gender"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Split Gender"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Remarks"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Maximum Score"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Maximum Candidates"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Fees"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Maximum Minutes"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Maximum Seconds"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Minimum Minutes"}),e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-4 text-left text-xs font-semibold text-onSurface",children:"Minimum Seconds"})]})}),s?.competitionsAssignedToGroup?.length>0&&e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:s?.competitionsAssignedToGroup?.map((t,l)=>e.jsxs("tr",{className:"divide-x divide-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:e.jsx("input",{id:`checkbox${t.Id}`,name:`checkbox${t.Id}`,type:"checkbox",checked:u.includes(t.Id),"aria-describedby":`checkbox${l}-description`,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",onChange:()=>J(t.Id)})}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.ParticipantTypeTitle}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.GroupGroupName}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.CompetitionItemTitle}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.LanguageLanguageName}),e.jsxs("td",{className:"px-2 py-2 text-xs font-medium text-onSurface flex justify-center ",children:[t.GenderGenderTitle," "]}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.GenderGenderTitle==="Both"?e.jsx("button",{onClick:()=>{w(t,l)},type:"button",className:"rounded-full bg-primary p-1 text-white shadow-sm hover:bg-primaryHover focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:e.jsx(de,{"aria-hidden":"true",className:"h-5 w-5"})}):null}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.Remarks}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MaximumScore}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MaximumCandidates}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.Fees}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MaximumMinutes}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MaximumSeconds}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MinimumMinutes}),e.jsx("td",{className:"px-2 py-2 text-xs font-medium text-onSurface",children:t.MinimumSeconds})]},t.Id))},s?.competitionsAssignedToGroup?.length)]})]})]})}),e.jsx("div",{className:"flex justify-center w-full flex-col place-items-center",children:e.jsx("button",{onClick:D,className:"mt-8 w-full max-w-72 rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-green-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600",children:"Submit"})})]})]})})}export{ye as default};
