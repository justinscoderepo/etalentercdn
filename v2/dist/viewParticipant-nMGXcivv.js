import{b as ue,r,u as q,q as g,n as pe,j as e,L as H,k as K,_ as $,p as ce,z as ge}from"./main-DzBv391f.js";import{B as Q}from"./box-CpDtOdJu.js";import{r as he,e as fe,g as xe,d as Se,u as ve,U as be,f as we,S as je}from"./publicRegistrationHelper-M8ywtWW7.js";import{R as Ne}from"./renderRegistrationForm-Dhfp7zde.js";import{c as F}from"./index-D9u4X8Cw.js";import{F as Ce}from"./PencilIcon-BHoIEZiM.js";import{F as ye}from"./PrinterIcon-DjNaR95G.js";import"./useConfirmation-BZyMEGG_.js";import"./dialog-zzEprenY.js";import"./keyboard-DG9qqjHM.js";import"./description-CwqOEykQ.js";import"./use-is-mounted-CWpaa5lC.js";import"./navigationUtils-DKALZK-h.js";import"./CheckIcon-DIbNRK37.js";import"./TrashIcon-BZMsvNOS.js";import"./eventDetailedView-CAOgiQG9.js";import"./UserPlusIcon-BO34RpVv.js";import"./UserGroupIcon-MLbG4p-p.js";import"./ChevronRightIcon-DLtISyxC.js";import"./TrashIcon-DEDzDiTb.js";const Re=K.lazy(()=>$(()=>import("./formSubmission-DqefDVMn.js"),[])),Te=K.lazy(()=>$(()=>import("./modalForm-CxzT8FFM.js"),[]));function Ue({view:s,setActiveTab:E,getEvets:x,isCoordinatorView:T,setParticipantTypeInt:j,getParticipants:S,participantTypeInt:l,candidateId:h,closeModel:N,customComponents:f,allowEdit:C}){let{user:m}=ue()||{};m?.RoleTitle,m?.Email?.indexOf("justnshalom")!=-1;let[n,I]=r.useState(null),[A,D]=r.useState({}),[v,t]=r.useState(null),[d,u]=r.useState(!1),[L,y]=r.useState(null),[p,R]=r.useState([]),[b,Ee]=r.useState(l==1?"Individual":l==2?"Team":""),[W,Ae]=r.useState([...he]);const{row:P,status:X}=q(x||"/CandidateJson/GetEvents",{select:"AllowDisplayCompetitionOrder,Description,EVId,EndDateString,EventCategory,EventCategoryTitle,EventLogo,EventName,IdentityBackgroundImage,OrganizationLogo,OrganizationName,OrganizationShortName,StartDateString,Venue,JsonSettings",doCache:!0});let Y="finished",Z="finished",ee="finished",{row:G,status:te}=q(S||"/CandidateJson/GetParticipants",{deleteUrl:"/CandidateJson/RemoveUser",mandatoryParams:["participantType"],select:"participantList,userList,UserEmail,UserName,UserDobString,UserImage,UserMobile,UserPhone,Email,Group,Candidate,CandidateUser,JsonSettings,Gender,GroupName,Fees,TeamTeamName,Team,TeamStrength,TeamMembersList,TeamMembers,TeamStrength,CandidateIdentityNumber,TeamIdentityNumber,CompetitionOrder,CreatedBy,CreatedByUserName,ParticipationId,UserJsonSettings,TeamJsonSettings,Remarks,LevelSettings,RegistrationId",updateUrl:"/CandidateJson/UpdateParticipant",doCache:!0,filter:h?{Candidate:h,...l==1?{participantType:"1"}:l==2?{participantType:"2"}:{}}:{}}),se=fe(G,h,n?.UId,v?.Team),{userRole:V,users:z,userData:B,teamData:k}=se;if(n=n||B,v=v||k,z?.length||g(localStorage.user)?.user,b=="Team"){let i=g(localStorage.user)?.user;i&&i?.Email?.indexOf("justnshalom")==-1}d=pe(X,Y,Z,ee,te)||d;let M=g(V?.JsonSettings),ie=g(B?.JsonSettings),ae=g(k?.TeamJsonSettings);const O=P?.JsonSettings,U=(O!=null&&O!=""?g(O):{components:{}}).components,ne=Object.keys(U??{});let re=g(A?.JsonSettings),_=ne?.includes("Agreement")&&U?.Agreement?.filter(i=>i?.validate?.required&&!M[i.name]&&!re[i.name])?.length==0;_&&localStorage.setItem("isAgreementStepFilled","true"),localStorage.getItem("isAgreementStepFilled")=="true"&&(_=!0);let a=xe(U,W,_,b,z,{},s),J={},oe=!0,le=()=>{N&&N()};if(h&&!G)return e.jsx(H,{});let o=[];if(b=="Individual"){let i=[];i.push(a[0]),o.push(i);let c=[];a.length>1&&c.push(a[1]),o.push(c),c=[],a.length>2&&c.push(a[2]),o.push(c);let w=[];a.length>3&&w.push(a[3]),o.push(w)}else{let i=[];a.length>2&&i.push(a[2]),o.push(i),i=[],a.length>3&&i.push(a[3]),o.push(i);let c=[];a.length>4&&c.push(a[4]),o.push(c);let w=[];a.length>5&&w.push(a[5]),o.push(w)}return console.log({splitBy2:o}),e.jsx("div",{children:e.jsx(Te,{title:"Registration Form",description:"Please fill the form to register for the event",open:!0,customHeading:f||null,setOpen:()=>{le()},children:e.jsx(Q,{heading:"",outerClasses:"relative w-full",headingClasses:"px-1 lg:px-4 print:hidden w-full",children:e.jsx("div",{className:"w-full mt-5 min-h-[600px] print:mt-0 flex flex-col",id:"registrationBox",children:o.map((i,c)=>e.jsx("div",{className:"flex w-full flex-1 gap-x-8",children:i.map((w,me)=>{J=w,p=Se(U,J);let de=J?ve(J.name,{},()=>{},()=>{},J,V,M,B,ie,b,k,G,U,n,v,ae,!1,A):{};return e.jsx("div",{className:"flex-1",children:e.jsx(Re,{isPrint:!0,isCoordinatorView:T,participantType:b,isGuardianRegistration:!1,handleNext:()=>{},isSubmitted:oe,eventDetails:P,isPlayGround:!1,onChange:()=>{},data:de,isLastStep:!1,existingComponents:p,selectedComponent:L,setSelectedComponent:()=>{},components:p,setComponents:()=>{}},me)})})}))})})})})}let Je=({selectedParticipantDetails:s,participantType:E,setAllowEdit:x,setOpen:T,setFilter:j,setPrint:S,eventDetails:l})=>{let h=localStorage.getItem("siteConfig")?JSON.parse(localStorage.getItem("siteConfig")):{};const[N,f]=r.useState(!1),[C,m]=r.useState(""),[n,I]=r.useState("Pending"),A=(t,d)=>{let u="";if(d==="Approved"){u="Thank you for your registration, "+t?.UserName+`
`,u+="Based on your date of birth ("+t?.UserDobString+"), you have been assigned to the "+t?.GroupName+` age group and successfully registered for the following competitions:
`;let L=t?.participatingCompetitions,y={};L?.forEach(p=>{let R=p?.GroupName;y[R]||(y[R]=[]),y[R].push(p)});for(const p in y)u+=`
`+p+` Group
`,y[p].forEach((R,b)=>{u+=b+1+" - "+R?.Title+`
`});u+=`
Please login with the credentials sent in your email to see candidate details and participation informations under the Participation tab. 
`,u+="Login: "+h?.emailConfigSiteUrl+`
`}m(u),I(d),f(!0)},D=()=>{if(I(n),C.trim()){m(""),f(!1);let t=g(s?.user?.JsonSettings);t||(t={}),t.ApprovalStatus=n,t.ReviewComments||(t.ReviewComments=[]),t.ReviewComments.push({Comment:C,Status:n,Date:new Date().toISOString()}),n==="Reviewed"&&(t.FinishedSteps=!1),n==="Approved"&&(t.FinishedSteps=!0);let d={ParticipantType:E,UserRoleId:s.user.Candidate,TeamId:s.user.Team,JsonSettings:JSON.stringify(t)};ce("/UsersRolesJson/Approve",d).then(u=>{ge.success("Review submitted successfully and emailed to the user."),x(!1),T(!1),j(!0)})}else alert("Please add a comment before submitting.")};let v=[];if(s?.user?.JsonSettings){let t=g(s?.user?.JsonSettings);t?.ReviewComments&&(v=t?.ReviewComments)}return e.jsxs("div",{className:"border-b border-gray-200 pb-5 bg-white flex flex-1 flex-col pr-10 print:pr-0",children:[e.jsxs("div",{className:"sm:flex flex-row sm:justify-between",children:[e.jsxs("div",{className:"sm:flex-1 gap-x-10",children:[s?.user?.UserName&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.CandidateIdentityNumber," - ",s?.user?.UserName]}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:s?.user?.Email}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:s?.user?.UserMobile}),e.jsx("p",{className:"mt-1 truncate text-sm text-onSurfaceVariant",children:s?.user?.UserDobString})]}),s?.user?.TeamTeamName&&e.jsx(e.Fragment,{children:e.jsxs("h1",{id:"message-heading",className:"text-base font-semibold text-gray-900",children:[s?.user?.TeamIdentityNumber," -",s?.user?.TeamTeamName]})}),e.jsxs("button",{className:"inline-flex items-center print:hidden gap-x-1.5 px-10 rounded-md bg-blue-600 mt-5  py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",onClick:()=>x(!0),children:[e.jsx(Ce,{className:"h-5 w-5 inline-block -mt-0.5 mr-0 "}),"Edit"]}),e.jsx("button",{onClick:()=>{S(!0)},className:"bg-darkprimary text-white px-10  ml-2 py-1.5 rounded-md print:hidden",children:e.jsx(ye,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"hidden print:flex  max-h-90  flex-col justify-items-end flex-wrap",children:[e.jsx("div",{className:"text-primary text-right",children:l?.EventName}),e.jsx("div",{className:"justify-end flex",children:e.jsx("img",{src:l?.EventLogo,alt:"logo",className:"max-h-16 w-auto"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col space-y-4 print:hidden",children:[e.jsx(be,{person:s?.user}),e.jsx(we,{onClick:A,person:s?.user})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{children:v.map((t,d)=>e.jsx("div",{className:"mt-2 flex flex-col relative",children:e.jsx("div",{className:F("border-l-4 p-4",t?.Status==="Reviewed"?"border-yellow-400 bg-yellow-50":t?.Status==="Approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"),children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:F("text-lg font-bold",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Status}),e.jsx("p",{className:F("text-sm whitespace-pre-line",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Comment??t}),e.jsx("p",{className:F("font-medium text-right ",t?.Status==="Reviewed"?"text-yellow-700":t?.Status==="Approved"?"text-green-700":"text-red-700"),children:t?.Date})]})})})},d))}),N&&e.jsx("div",{className:"mt-2 flex flex-col relative print:hidden",children:e.jsxs(Q,{heading:"Please enter the reason for change status to "+n,childrenClasses:"flex flex-col mt-4 relative",children:[e.jsxs("div",{className:"rounded-lg bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[e.jsx("label",{htmlFor:"comment",className:"sr-only",children:"Add your comment..."}),e.jsx("textarea",{id:"comment",name:"comment",rows:6,placeholder:"Add your comment..., The comment will be sent to the user via email.",className:"block w-full rounded-lg resize-none bg-transparent px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6",value:C,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:" inset-x-0 bottom-0 flex justify-between py-2 pl-3 pr-2",children:[e.jsx("div",{className:"flex items-center space-x-5"}),e.jsx("div",{className:"shrink-0",children:e.jsx(je,{onClick:D,currentReviewStatus:n})})]})]})})]})]})};function et({participantType:s,candidateId:E,eventDetails:x,setFilter:T,selectedParticipantDetails:j,setOpen:S}){let[l,h]=r.useState(!1),[N,f]=r.useState(!1),[C,m]=r.useState(!1),n=N?Ue:Ne;return e.jsx(n,{isCoordinatorView:!0,view:"participationDetails",getEvets:"/EventJson/Get",allowEdit:l,getUserRoles:"/UsersRolesPlusUsersJson/Get",getTeams:"/CompetitionParticipantsTeamsJson/Get",getUsers:"/UsersRolesPlusUsersJson/Get",customComponents:e.jsxs(e.Fragment,{children:[C&&e.jsx(H,{}),e.jsx(Je,{setPrint:()=>{window.parent.document.title="Candiidate Details - "+j.user.UserName+" - "+j.user.UserDobString,f(!0),m(!0),window.onafterprint=()=>{f(!1)},setTimeout(()=>{m(!1)},2e3),setTimeout(()=>{window.print()},3e3)},participantType:s,eventDetails:x,selectedParticipantDetails:j,setFilter:T,setOpen:S,setAllowEdit:h})]}),getParticipants:"/CoordinatorJson/GetParticipants",closeModel:()=>{S(!1)},participantTypeInt:s,candidateId:E,setActiveTab:()=>{}})}export{et as default};
