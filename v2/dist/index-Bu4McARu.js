import{x as C,r as f,u as p,j as e,p as v,z as h}from"./main-BLlSeYUi.js";import{L as V}from"./layoutOuter-BVrij1ME.js";import{P as L}from"./pageHeader-DIeY4aYW.js";import{O as P}from"./OldNewTabLayout-CEwWPClm.js";import{u as A}from"./index.esm-DOrMqrSw.js";import{F}from"./PlusIcon-DtBqwVZV.js";import{F as E}from"./PencilIcon-BJZE7zI4.js";import{F as O}from"./TrashIcon-BdI6pZ5u.js";import{d as r}from"./tabs-CvsNuLMV.js";import"./navigationUtils-DItAyYjQ.js";import"./use-resolve-button-type-WUAb-KSo.js";import"./keyboard-CBxjQHV4.js";import"./use-is-mounted-fvWOCIc1.js";function R({participantType:d,group:i,competitionItem:b}){const{eventDetails:S}=C(),[g,x]=f.useState(!1),[c,l]=f.useState(null),{rows:m=[],refetch:u}=p("/CompetitionStructureJson/Get",{filter:`EventCategory=${S?.EventCategoryId||0}&ParticipantType=${d}&Group=${i}&CompetitionItem=${b}`,select:"CompetitionStructureId,Order,MaximumScore,MaximumMinutes,MaximumSeconds,MinimumMinutes,MinimumSeconds,WarningMinute,WarningSecond,Fees,Remarks,Gender,GenderGenderTitle,Language,LanguageLanguageName,CompetitionStatus,CompetitionStatusCompetitionStatusTitle",sort:"Order asc"}),{rows:o=[]}=p("/GenderJson/Get",{select:"GenderId,GenderTitle"}),{rows:n=[]}=p("/LanguageJson/Get",{select:"LanguageId,LanguageName"}),{rows:s=[]}=p("/CompetitionStatusJson/Get",{select:"CompetitionStatusId,CompetitionStatusTitle"}),{register:a,handleSubmit:w,reset:j,formState:{errors:y}}=A(),I=async t=>{try{await v("/CompetitionStructureJson/Save",{...t,EventCategory:S?.EventCategoryId,ParticipantType:d,Group:i,CompetitionItem:b}),h.success(c?"Structure updated successfully":"Structure created successfully"),u(),j(),x(!1),l(null)}catch{h.error("Failed to save competition structure")}},k=t=>{l(t),x(!0),j({CompetitionStructureId:t.CompetitionStructureId,Order:t.Order,MaximumScore:t.MaximumScore,MaximumMinutes:t.MaximumMinutes,MaximumSeconds:t.MaximumSeconds,MinimumMinutes:t.MinimumMinutes,MinimumSeconds:t.MinimumSeconds,WarningMinute:t.WarningMinute,WarningSecond:t.WarningSecond,Fees:t.Fees,Remarks:t.Remarks,Gender:t.Gender,Language:t.Language,CompetitionStatus:t.CompetitionStatus})},M=async t=>{if(confirm("Are you sure you want to delete this competition structure?"))try{await v("/CompetitionStructureJson/Remove",{CompetitionStructureId:t}),h.success("Structure deleted successfully"),u()}catch{h.error("Failed to delete structure")}},G=()=>{x(!1),l(null),j()};return e.jsxs("div",{className:"space-y-4",children:[g?e.jsxs("div",{className:"bg-surface p-4 rounded-lg border border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-onSurface mb-4",children:c?"Edit Competition Structure":"Add New Structure"}),e.jsxs("form",{onSubmit:w(I),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Order *"}),e.jsx("input",{type:"number",...a("Order",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"1"}),y.Order&&e.jsx("span",{className:"text-xs text-red-600",children:"Required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Gender *"}),e.jsxs("select",{...a("Gender",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary ring-border",children:[e.jsx("option",{value:"",children:"Select Gender"}),o.map(t=>e.jsx("option",{value:t.GenderId,children:t.GenderTitle},t.GenderId))]}),y.Gender&&e.jsx("span",{className:"text-xs text-red-600",children:"Required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Language *"}),e.jsxs("select",{...a("Language",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary ring-border",children:[e.jsx("option",{value:"",children:"Select Language"}),n.map(t=>e.jsx("option",{value:t.LanguageId,children:t.LanguageName},t.LanguageId))]}),y.Language&&e.jsx("span",{className:"text-xs text-red-600",children:"Required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Max Score"}),e.jsx("input",{type:"number",...a("MaximumScore",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Max Minutes"}),e.jsx("input",{type:"number",...a("MaximumMinutes",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Max Seconds"}),e.jsx("input",{type:"number",...a("MaximumSeconds",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Warning Min"}),e.jsx("input",{type:"number",...a("WarningMinute",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Warning Sec"}),e.jsx("input",{type:"number",...a("WarningSecond",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Fees"}),e.jsx("input",{type:"number",step:"0.01",...a("Fees",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Remarks"}),e.jsx("input",{type:"text",...a("Remarks"),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"Optional remarks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Status"}),e.jsxs("select",{...a("CompetitionStatus",{valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary ring-border",children:[e.jsx("option",{value:"",children:"Select Status"}),s.map(t=>e.jsx("option",{value:t.CompetitionStatusId,children:t.CompetitionStatusTitle},t.CompetitionStatusId))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-x-2 pt-2",children:[e.jsx("button",{type:"button",onClick:G,className:"inline-flex items-center gap-x-2 rounded-md bg-surface px-4 py-2 text-sm font-semibold text-onSurfaceVariant shadow-sm hover:bg-surfaceCard border border-border",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover",children:[c?"Update":"Add"," Structure"]})]})]})]}):e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover",children:[e.jsx(F,{className:"h-4 w-4"}),"Add Structure"]})}),m.length===0?e.jsx("div",{className:"text-center py-8 bg-surface rounded-lg border border-border",children:e.jsx("p",{className:"text-sm text-onSurfaceVariant",children:"No structures created yet. Add your first structure above."})}):e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-border",children:[e.jsx("thead",{className:"bg-surface",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Order"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Gender"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Language"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Max Score"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Max Time"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Warning"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Fees"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-onSurfaceVariant uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-surfaceCard divide-y divide-border",children:m.map(t=>e.jsxs("tr",{className:"hover:bg-surface",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurface",children:t.Order}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.GenderGenderTitle}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.LanguageLanguageName}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.MaximumScore||"-"}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:[t.MaximumMinutes||0,":",(t.MaximumSeconds||0).toString().padStart(2,"0")]}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:[t.WarningMinute||0,":",(t.WarningSecond||0).toString().padStart(2,"0")]}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.Fees||0}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:t.CompetitionStatusCompetitionStatusTitle||"Not Set"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-sm",children:e.jsxs("div",{className:"flex justify-end gap-x-1",children:[e.jsx("button",{onClick:()=>k(t),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-md",title:"Edit",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>M(t.CompetitionStructureId),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-md",title:"Delete",children:e.jsx(O,{className:"h-4 w-4"})})]})})]},t.CompetitionStructureId))})]})})]})}function N(...d){return d.filter(Boolean).join(" ")}function _(){return e.jsx(P,{oldUrl:"/CompetitionStructure/Tab",newComponent:e.jsx(W,{}),title:"Competition Structure Management"})}function W(){const{eventDetails:d}=C(),[i,b]=f.useState(null),[S,g]=f.useState(null),[x,c]=f.useState(null),{rows:l=[]}=p("/ParticipantTypeJson/Get",{select:"ParticipantTypeId,Title",filter:"Status=1"}),{rows:m=[]}=p("/AgewiseGroupsJson/Get",{select:"GroupId,GroupName,ParticipantType",filter:i?`ParticipantType=${i}&EventCategory=${d?.EventCategoryId||0}`:"",noGet:!i}),{rows:u=[]}=p("/CompetitionItemJson/Get",{select:"CompetitionItemId,Title,ParticipantType",filter:i?`ParticipantType=${i}&EventCategory=${d?.EventCategoryId||0}`:"",noGet:!i});return e.jsxs(V,{children:[e.jsx(L,{title:"Competition Structure Management",description:"Manage competition structures with participant types, groups, and competition items"}),e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-surfaceCard rounded-lg border border-border shadow-sm",children:e.jsxs(r.Group,{onChange:o=>{b(l[o]?.ParticipantTypeId||null),g(null),c(null)},children:[e.jsx(r.List,{className:"flex space-x-1 border-b border-border px-4",children:l.map(o=>e.jsx(r,{className:({selected:n})=>N("px-4 py-3 text-sm font-medium leading-5 border-b-2 transition-colors","focus:outline-none",n?"border-primary text-primary":"border-transparent text-onSurfaceVariant hover:text-onSurface hover:border-border"),children:o.Title},o.ParticipantTypeId))}),e.jsx(r.Panels,{className:"p-6",children:l.map(o=>e.jsx(r.Panel,{children:m.length>0?e.jsxs(r.Group,{onChange:n=>{g(m[n]?.GroupId||null),c(null)},children:[e.jsx(r.List,{className:"flex space-x-1 border-b border-border mb-4",children:m.map(n=>e.jsx(r,{className:({selected:s})=>N("px-3 py-2 text-sm font-medium leading-5 border-b-2 transition-colors","focus:outline-none",s?"border-primary text-primary":"border-transparent text-onSurfaceVariant hover:text-onSurface hover:border-border"),children:n.GroupName},n.GroupId))}),e.jsx(r.Panels,{children:m.map(n=>e.jsx(r.Panel,{children:u.length>0?e.jsxs(r.Group,{onChange:s=>{c(u[s]?.CompetitionItemId||null)},children:[e.jsx(r.List,{className:"flex space-x-1 border-b border-border mb-4",children:u.map(s=>e.jsx(r,{className:({selected:a})=>N("px-3 py-2 text-xs font-medium leading-5 border-b-2 transition-colors","focus:outline-none",a?"border-primary text-primary":"border-transparent text-onSurfaceVariant hover:text-onSurface hover:border-border"),children:s.Title},s.CompetitionItemId))}),e.jsx(r.Panels,{children:u.map(s=>e.jsx(r.Panel,{children:e.jsx(R,{participantType:o.ParticipantTypeId,group:n.GroupId,competitionItem:s.CompetitionItemId})},s.CompetitionItemId))})]}):e.jsx("div",{className:"text-center py-8 text-sm text-onSurfaceVariant",children:"No competition items available for this group. Please add competition items first."})},n.GroupId))})]}):e.jsx("div",{className:"text-center py-8 text-sm text-onSurfaceVariant",children:"No groups available for this participant type. Please add groups first."})},o.ParticipantTypeId))})]})})})]})}export{_ as default};
