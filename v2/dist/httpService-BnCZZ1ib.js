import{a as b}from"./index-t--hEgTQ.js";import{g as C,f as g,p as O}from"./main-YrYtAxAS.js";let m=new Date,y=1;function S(...o){if((new Date().getTime()-m.getTime())/1e3>10&&(console.info(`%c===========================================

                Session ${y}

===========================================`,"color: white; font-style: italic; font-weight:bold; font-size:14px"),y++,m=new Date),o.length>0)try{if(localStorage.getItem("development")){console.info("%c"+o[0],"color: orange; font-style: italic; font-weight:bold; font-size:14px");let n=o.reduce(function(r,s,l){return l!=0?typeof s=="object"?Object.assign(r,s):Object.assign(r,{[l-1]:s}):r},{});console.info(n)}}catch{}}let c=window.location.origin,k=localStorage.getItem("siteConfig")?O(localStorage.getItem("siteConfig")):{apiUrl:"https://etalenterapi.azurewebsites.net"};window.location.href.indexOf("localhost")==-1?c=k.apiUrl:c="http://localhost:8888";const d={headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest"}};console.log("apiRoot"+c);const f=b.create({baseURL:c}),I=o=>{o.headers.Platform="Web";const{user:e,token:t}=C()||{};return console.log("httpService - Current user:",e),e&&t&&o.url.indexOf("login")==-1&&(console.log("httpService - Request with user role:",e?.Role),t&&(o.headers.Authorization=`Bearer ${t}`)),o},v=o=>{if(S("responseFailed",o),o&&o.response&&o.response.data&&o.response.data.statusCode===401){var e=window.location.search.replace("?","").split("&"),t=e.filter(r=>r.toLowerCase().indexOf("dataset=")!=-1);if(t&&t.length>0){var n=t[0].split("=")[1];n&&(localStorage.clear(),window.location.href=""+window.location.href)}if(localStorage.userData){let{roleId:r}=JSON.parse(localStorage.userData).user;r==5&&(localStorage.clear(),window.location.href=""+window.location.href)}return localStorage.clear(),window.location.href="#logout",Promise.reject({...o})}return o.request&&o.request.status&&(o.request.status==="400"||o.request.status==="404")?Promise.reject({...o}):Promise.reject({...o})},P=o=>{if(localStorage.userData){let e=JSON.parse(localStorage.userData),{accesstoken:t,refreshtoken:n}=o.headers;t!=null&&n!==null&&t!==e.accessToken&&n!==e.refreshToken&&(e.accessToken=t,e.refreshToken=n,localStorage.removeItem("userData"),localStorage.setItem("userData",JSON.stringify(e)))}return o};function w(o){if(S("errorHandler",o),o){let{response:e}=o,{data:t}=e||{};if(o&&o.isAxiosError&&!e)g.error("Network Issue or Server Down",{autoClose:3e3,toastId:"network"});else if(e&&e.status==401&&t.message&&typeof t.message=="string")g.error(t.message,{autoClose:3e3,toastId:"network"});else if(e&&e.status==401)g.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"});else if(t&&e.status&&e.status==400&&t.SecurityValidations&&t.SecurityValidations.length>0){let n=t.SecurityValidations[0];g.error(n,{autoClose:3e3,toastId:"network"})}else t&&t.statusCode&&t.statusCode==400&&t.message&&typeof t.message=="string"?g.error(t.message,{autoClose:3e3,toastId:"network"}):t&&t.statusCode&&t.statusCode==400&&t.message?g.error(t.message,{autoClose:3e3,toastId:"network"}):t&&t.Message?g.error(t.Message,{autoClose:3e3,toastId:"network"}):g.error(JSON.stringify(t),{autoClose:3e3,toastId:"network"})}}function D(o,e,t){if(e){o+="?";let n=[],r=["query","createUrl","filter"];for(const l in e)if(Object.hasOwnProperty.call(e,l)){let a=e[l];r.indexOf(l.toString())===-1&&a!=null&&n.push(`${l}=${a.toString()}`)}let s=[];for(const l in t)if(Object.hasOwnProperty.call(t,l)){let a=t[l];typeof a=="string"?s.push(`${l}=${a}`):s.push(`${l}=${a}`)}return s.length&&n.push(`${s.join("&")}`),o+=n.join("&"),o}return o}class u{constructor(){f.interceptors.request.handlers.length===0&&(f.interceptors.request.use(e=>I(e)),f.interceptors.response.use(e=>P(e),e=>v(e)))}getWithHeader(e,t){if(e)return f.get(c+e,t,d)}async get(e,t,n,r,s,l){let a={};return a.select=t??["id"],r?.sortOrder&&r?.sortField&&(a.sortField=r.sortField,a.sortOrder=r.sortOrder),a.filter=n,a.page=s+1,a.take=l??10,e=D(e,a,n),new Promise((h,p)=>{if(e)try{f.get(c+e,d).then(i=>{h(i)}).catch(i=>{w(i),p(i)})}catch(i){p(i)}})}async postAsGet(e,t,n,r,s,l){let a={};return a.select=t??["id"],r?.sortOrder&&r?.sortColumn&&(a.sortColumn=r.sortColumn,a.sortOrder=r.sortOrder),a.PageNumber=s+1,a.pageSize=l??10,a={...a,...n},new Promise((h,p)=>{if(e)try{f.post(c+e,a,d).then(i=>{h(i)}).catch(i=>{w(i),i.response?p({message:"Request failed for "+e,status:i.response.status,data:i.response.data}):i.request?p({message:"No response from server for "+e,error:i.message}):p({message:"Request setup error for "+e,error:i.message})})}catch(i){p(i)}})}async blob(e,t){return new Promise((n,r)=>{if(e)try{f.get(c+e,t,{...d,responseType:"blob"}).then(s=>{n(s)}).catch(s=>{w(s),r(s)})}catch(s){r(s)}})}post(e,t){return new Promise((n,r)=>{if(e)try{return f.post(c+e,t,{...d}).then(s=>{n(s)}).catch(s=>{w(s),r(s)})}catch(s){r(s)}})}upload(e,t){return new Promise((n,r)=>{if(e)try{return f.post(c+e,t,{...d,headers:{...d.headers,"Content-Type":"multipart/form-data"}}).then(s=>{n(s)}).catch(s=>{w(s),r(s)})}catch(s){r(s)}})}put(e,t){return new Promise((n,r)=>{if(e)try{return f.put(c+e,t,d).then(s=>{n(s)}).catch(s=>{w(s),r(s)})}catch(s){r(s)}})}remove(e,t){return new Promise((n,r)=>{if(e)try{return f.delete(c+e,{...d,data:t}).then(s=>{n(s)}).catch(s=>{w(s),r(s)})}catch(s){r(s)}})}}new u;const{getWithHeader:q}=new u,{get:T}=new u,{blob:x}=new u,{getAsync:R}=new u,{post:$}=new u,{postAsGet:N}=new u,{upload:z}=new u,{put:H}=new u,{remove:J}=new u,A=c,_=Object.freeze(Object.defineProperty({__proto__:null,apiRootPath:A,blob:x,get:T,getAsync:R,getWithHeader:q,post:$,postAsGet:N,put:H,remove:J,upload:z},Symbol.toStringTag,{value:"Module"}));export{A as a,N as b,_ as h,$ as p,J as r,S as t,z as u};
