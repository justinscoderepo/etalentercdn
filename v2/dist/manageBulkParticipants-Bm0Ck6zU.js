import{r as a,e as re,l as le,m as ce,k as de,j as t,L as r,R as s,_ as l}from"./main-BWzMsQNc.js";import{F as ue}from"./UsersIcon-DoKVuxe5.js";import{F as me}from"./PlusIcon-Dioc2SBy.js";const pe=s.lazy(()=>l(()=>import("./groupFilterTab-Cfe_l1Tg.js"),[])),ge=s.lazy(()=>l(()=>import("./organizationLevelManager-XIYi_5hl.js"),[])),he=s.lazy(()=>l(()=>import("./participantFilterTab-BfVOVixW.js"),[])),fe=s.lazy(()=>l(()=>import("./participantFilters-C1CuCRvL.js"),[])),xe=s.lazy(()=>l(()=>import("./participantManagementLayout-3tvwRnWo.js"),[])),ve=s.lazy(()=>l(()=>import("./renderRegistrationForm-BV-2BUZ1.js"),[])),Se=({user:A})=>{const[j,L]=a.useState(Date.now()),[n,C]=a.useState(""),[h,y]=a.useState(""),[k,u]=a.useState(""),[c,I]=a.useState([]),[z,E]=a.useState(1e5),[O,i]=a.useState(1),[D,G]=a.useState([]),[R,M]=a.useState(!1),[V,be]=a.useState(!1);let{user:U}=re()||{};const f=A||U,{eventDetails:W,eventLevels:J,topLevels:B,groups:d,eventCacheLoaded:S}=le(),{advancedSettings:Q}=ce(),x=Q||{};let m=null;if(d&&Array.isArray(d)&&d.length>0){let e=d.find(o=>o.GroupName.toLowerCase()==="common");e||(e=d.find(o=>(o.JsonSettings?JSON.parse(o.JsonSettings):{}).IsCommon==="Yes")),m=e?e.EventGroupId:null}const[v,b]=a.useState({candidateName:"",candidateIdentityNumber:"",isIncludeStatusTitle:"Yes",isIncludeCommon:"",commonGroup:m,isListWithoutSelectedGroup:""});a.useEffect(()=>{b(e=>({...e,isIncludeCommon:x.DefaultValueForMixingCommonWithOtherAgeGroups=="Yes"?"true":x.DefaultValueForMixingCommonWithOtherAgeGroups==="No"?"false":""}))},[x.DefaultValueForMixingCommonWithOtherAgeGroups]);const Y=a.useCallback(e=>{if(Array.isArray(e)){I(e);const o=e.slice().reverse().find(oe=>{const F=Object.values(oe)[0];return F&&F!==""}),T=o?Object.values(o)[0]:"";u(T),i(1)}else u(e),i(1)},[]),w=a.useCallback(e=>{b(e)},[]),$=a.useCallback(e=>{E(e),i(1)},[]),H=a.useCallback(e=>{i(e)},[]),q=a.useCallback(e=>{C(e),i(1)},[]),K=a.useCallback(e=>{y(e),i(1)},[]),X=a.useCallback(e=>{G(e)},[]),Z=a.useCallback(()=>{M(e=>!e)},[]),P=a.useCallback(e=>{if(e.TeamTeamName){N(e.Team);return}p(e?.Candidate||e?.Team||null),g(!0)},[f]),ee=a.useCallback(async e=>{window.confirm(`Are you sure you want to delete ${e.UserName||e.TeamTeamName}?`)},[]),te=a.useCallback(e=>{N(e.Team)},[]),[_,p]=a.useState(null),[ae,g]=a.useState(!1),se=a.useCallback(()=>{},[]),ne=a.useCallback(()=>{b({candidateName:"",candidateIdentityNumber:"",teamIdentityNumber:"",registrationId:"",isIncludeStatusTitle:"",isIncludeCommon:"",commonGroup:m,isListWithoutSelectedGroup:""}),u(""),C(""),y(""),u(""),i(1),de.success("Filters cleared")},[m]);a.useEffect(()=>{typeof window<"u"&&window.jQuery&&(typeof window.resizeBox=="function"&&window.resizeBox(window.jQuery),window.jQuery(document).trigger("ready"))},[]);const ie=(e=null)=>{p(e),g(!0)},N=e=>{p(e),g(!0)};if(!S||c===null){let e=[];return S||e.push("event data"),c===null&&e.push("organization data"),t.jsx(r,{info:"Loading participants data..."+e.join(", ")})}return t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsxs("div",{className:"max-w-full mx-auto",children:[ae&&t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading participant details..."}),children:t.jsx(ve,{isDirectOpen:!0,isCoordinatorView:!0,view:"participationDetails",eventDetails:W,allowEdit:!0,getParticipantsLink:"/CoordinatorJson/GetParticipants",closeModel:()=>{g(!1),j&&L(Date.now()),p(null)},participantTypeInt:n==="2"?2:n==="1"?1:n,candidateId:_,setActiveTab:()=>{}},_+n)}),t.jsx("div",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"px-3 py-1.5",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ue,{className:"h-5 w-5 text-primary"}),t.jsx("div",{children:t.jsx("h1",{className:"text-sm font-medium text-primary",children:"Manage Participants"})})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{type:"button",onClick:()=>ie(null),className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[t.jsx(me,{className:"h-4 w-4"}),"Add Participant"]})})]})})}),t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsxs("div",{className:"flex flex-row flex-wrap gap-2 w-full",children:[t.jsx("div",{className:"flex-1 min-w-[300px] px-2 py-1",children:t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading organization manager..."}),children:t.jsx(ge,{user:f,eventLevels:J,topLevels:B,selectedOrganizations:c,onOrganizationChange:Y})})}),t.jsx("div",{className:"flex-1 min-w-[300px]",children:t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading filters..."}),children:t.jsx(fe,{filterCriterias:v,onFilterChange:w,onApply:w,showAdvancedFilters:R,onToggleAdvancedFilters:Z})})})]})}),t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsx("div",{className:"px-3 py-2",children:t.jsxs("div",{className:"flex flex-row gap-x-2 justify-between",children:[t.jsx("div",{className:"",children:t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading participant tabs..."}),children:t.jsx(he,{selectedParticipantType:n,onParticipantTypeChange:q,selectedGroupFilter:h})})}),t.jsx("div",{className:"",children:t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading group tabs..."}),children:t.jsx(pe,{selectedGroupFilter:h,onGroupFilterChange:K,selectedParticipantType:n})})})]})})}),t.jsx("div",{className:"bg-gray-50 relative",children:c.length>0&&t.jsx(s.Suspense,{fallback:t.jsx(r,{info:"Loading participants layout..."}),children:t.jsx(xe,{selectedOrganizations:c,selectedGroupFilter:h,selectedParticipantType:n,selectedOrganization:k,searchTerm:v.candidateName,filterCriterias:v,pageSize:z,currentPage:O,onEdit:P,onView:e=>P(e),onDelete:ee,onTeamManage:te,loading:V,selectedParticipants:D,onSelectionChange:X,currentUser:f,onAssignmentChange:se,onPageChange:H,onPageSizeChange:$,onClearFilters:ne},j)})})]})})};export{Se as default};
