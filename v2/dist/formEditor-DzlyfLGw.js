import{r as u,q as S,j as r,L as G}from"./main-CValvRaT.js";import{u as H}from"./index.esm-CUZSpTdX.js";import{RenderComponents as I}from"./renderComponents-P3tZP4oF.js";import $ from"./modalForm-CHovHdG1.js";import{F as k}from"./XCircleIcon-CElOccs5.js";import{F as B}from"./CheckCircleIcon-2ABXY2HL.js";import"./validationMessage-qwRTbBO_.js";import"./CheckCircleIcon-K3DCHWXS.js";import"./dialog-rlnxUHjz.js";import"./keyboard-Ci1fkLH5.js";import"./description-C-FQbQvv.js";import"./use-is-mounted-C3Pqc7HN.js";import"./navigationUtils-pwlPwihw.js";import"./XMarkIcon-CcrC6YcA.js";const le=({row:s,fields:v,viewMode:h,noModal:C,onSave:O,onChange:Q,onCancel:x,title:F,description:E,twoColumnLayout:N=!0,...b})=>{console.log("FormEditor row:",s);const[n,g]=u.useState(s||{});for(let e in n)if(e.indexOf("JsonSettings")>-1&&e.indexOf(".")==-1)try{let t=S(n[e]);if(t)for(let i in t)n[e+"Object."+i]=t[i]}catch(t){console.error("Error parsing JSON:",t)}let[c,j]=u.useState(!1);const[L,J]=u.useState("");let y=v;const{handleSubmit:P,register:V,unregister:w,control:R,clearErrors:D,reset:K,watch:A,getValues:M,setValue:f,formState:{errors:T}}=H({defaultValues:{...s}});u.useEffect(()=>{s&&(Object.keys(s).forEach(e=>{w(e),f(e,s[e])}),g({...s}))},[s]);const q=async e=>{j(!0),window.scrollTo({top:0,behavior:"smooth"});let t=i=>{J(i)};try{await O(e,!1,!0,t)}catch(i){console.error("Error saving user:",i)}j(!1)},p=(e,t)=>{if(f(e,t),s&&(s[e]=t),e.indexOf("JsonSettingsObject")>-1){let a=e.split("Object.")[1],l=e.split("Object.")[0];var i=s[l],o=S(i);let z={[a]:t};o={...o,...z},s[l]=JSON.stringify(o),f(l,JSON.stringify(o))}g({...s});let m=e.charAt(0).toLowerCase()+e.slice(1);b?.[m+"OnChange"]&&b?.[m+"OnChange"](t,n,(a,l)=>{p(a,l)})};let d=[...y];return n&&y?.length>0&&(d=d.filter(e=>{let t=e.conditions?.filter(i=>i.key);return t?.length>0?!!t.find(o=>{if(o.key){let m=o.key.charAt(0).toLowerCase()+o.key.slice(1),a=n[o.key]||n[m];if(a&&a?.toString()==o.value)return!0}}):!0})),r.jsx($,{isPlainView:C,title:F,description:E,open:!0,center:!1,outerClass:"max-w-xl",setOpen:x,childrenClass:"px-6 print:p-0",children:r.jsxs("div",{className:"flex-auto relative mt-5",children:[c&&r.jsx(G,{info:L}),r.jsxs("form",{onSubmit:P(q),children:[r.jsx(I,{handlePropertiesChange:p,handlePropertiesPanelChange:()=>{},viewMode:h,formData:n,isPlayGround:!1,onChangeValue:p,drop:null,isSubmitted:c,isOver:!1,eventDetails:{},components:d,selectedComponent:{},handleSelect:()=>{},register:V,getValues:M,errors:T,control:R,setValue:f,clearErrors:D,reset:K,watch:A,removeComponent:()=>{},twoColumnLayout:N}),!c&&!h&&r.jsx("div",{className:"mb-2 w-full flex justify-end px-0 gap-x-4",children:r.jsxs(r.Fragment,{children:[r.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-x-2  rounded-md bg-gray-200 px-6 py-2.5 text-sm font-semibold text-gray-700 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(k,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Cancel"]}),r.jsxs("button",{type:"submit",className:"inline-flex items-center gap-x-2  rounded-md bg-primary px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[r.jsx(B,{"aria-hidden":"true",className:"-mr-0.5 h-5 w-5"}),"Submit"]})]})})]})]})})};export{le as default};
