import{j as e,x as v,r as x,u as c,p,z as n}from"./main-CR4yjmzD.js";import{u as C}from"./index.esm-DunqIq_l.js";import{L as T}from"./layoutOuter-DMp8uPKL.js";import{P as E}from"./pageHeader-UrzrIPRP.js";import{O as k}from"./OldNewTabLayout-BBXC7KUX.js";import{F as V}from"./PlusIcon-sg3Ob76g.js";import{F as R}from"./PencilIcon-DuWVo7r0.js";import{F as I}from"./TrashIcon-CLNLn4ee.js";import"./navigationUtils-BQipJ1Np.js";function P(){return e.jsx(k,{oldUrl:"/CompetitionSchedule/Manage",newComponent:e.jsx(O,{}),title:"Competition Schedule Management"})}function O(){const{eventDetails:s}=v(),[h,i]=x.useState(!1),[d,o]=x.useState(null),{rows:m=[],refetch:u}=c("/CompetitionScheduleJson/Get",{filter:`Event=${s?.EVId||0}`,select:"CSId,Competition,Phase,PhaseTitle,Stage,StageTitle,ScheduledStartTime,ScheduledEndTime,ReportedStartTime,ReportedEndTime,Order",sort:"Order asc"}),{rows:S=[]}=c("/EventStagesJson/Get",{filter:`EventCategory=${s?.EventCategoryId||0}`,select:"ESGId,Title"}),{rows:f=[]}=c("/CompetitionStructureJson/Get",{filter:`EventCategory=${s?.EventCategoryId||0}`,select:"CompetitionStructureId,CompetitionItemTitle,GroupGroupName,GenderGenderTitle,LanguageLanguageName"}),{register:r,handleSubmit:g,reset:l,formState:{errors:a}}=C(),b=async t=>{try{await p("/CompetitionScheduleJson/Save",{...t,Event:s?.EVId,Status:1}),n.success(d?"Schedule updated successfully":"Schedule created successfully"),u(),l(),i(!1),o(null)}catch{n.error("Failed to save schedule")}},j=t=>{o(t),i(!0),l({CSId:t.CSId,Competition:t.Competition,Stage:t.Stage,ScheduledStartTimeString:t.ScheduledStartTime,ScheduledEndTimeString:t.ScheduledEndTime,ReportedStartTimeString:t.ReportedStartTime,ReportedEndTimeString:t.ReportedEndTime,Order:t.Order})},y=async t=>{if(confirm("Are you sure you want to delete this schedule?"))try{await p("/CompetitionScheduleJson/Remove",{CSId:t}),n.success("Schedule deleted successfully"),u()}catch{n.error("Failed to delete schedule")}},N=()=>{i(!1),o(null),l()};return e.jsxs(T,{children:[e.jsx(E,{title:"Competition Schedule Management",description:"Manage competition schedules, stages, and time slots"}),e.jsxs("div",{className:"space-y-6",children:[h?e.jsxs("div",{className:"bg-surfaceCard p-6 rounded-lg border border-border shadow-sm",children:[e.jsx("h3",{className:"text-base font-medium text-onSurface mb-4",children:d?"Edit Competition Schedule":"Add New Schedule"}),e.jsxs("form",{onSubmit:g(b),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Competition *"}),e.jsxs("select",{...r("Competition",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary ring-border",children:[e.jsx("option",{value:"",children:"Select Competition"}),f.map(t=>e.jsxs("option",{value:t.CompetitionStructureId,children:[t.GroupGroupName," - ",t.CompetitionItemTitle]},t.CompetitionStructureId))]}),a.Competition&&e.jsx("span",{className:"text-xs text-red-600",children:"Competition is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Event Stage *"}),e.jsxs("select",{...r("Stage",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary ring-border",children:[e.jsx("option",{value:"",children:"Select Stage"}),S.map(t=>e.jsx("option",{value:t.ESGId,children:t.Title},t.ESGId))]}),a.Stage&&e.jsx("span",{className:"text-xs text-red-600",children:"Stage is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Scheduled Start Time *"}),e.jsx("input",{type:"datetime-local",...r("ScheduledStartTimeString",{required:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border"}),a.ScheduledStartTimeString&&e.jsx("span",{className:"text-xs text-red-600",children:"Start time is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Scheduled End Time *"}),e.jsx("input",{type:"datetime-local",...r("ScheduledEndTimeString",{required:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border"}),a.ScheduledEndTimeString&&e.jsx("span",{className:"text-xs text-red-600",children:"End time is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Reported Start Time"}),e.jsx("input",{type:"datetime-local",...r("ReportedStartTimeString"),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Reported End Time"}),e.jsx("input",{type:"datetime-local",...r("ReportedEndTimeString"),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-onSurface mb-1",children:"Display Order *"}),e.jsx("input",{type:"number",...r("Order",{required:!0,valueAsNumber:!0}),className:"pl-3 block w-full rounded-md border-0 py-1.5 ring-1 ring-inset focus:ring-2 focus:ring-inset text-sm leading-6 text-onSurface focus:border-darkprimary placeholder:text-onSurfaceVariant ring-border",placeholder:"1"}),a.Order&&e.jsx("span",{className:"text-xs text-red-600",children:"Order is required"})]})]}),e.jsxs("div",{className:"flex justify-end gap-x-2 pt-4",children:[e.jsx("button",{type:"button",onClick:N,className:"inline-flex items-center gap-x-2 rounded-md bg-surface px-4 py-2 text-sm font-semibold text-onSurfaceVariant shadow-sm hover:bg-surfaceCard border border-border",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover",children:d?"Update Schedule":"Add Schedule"})]})]})]}):e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-x-2 rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primaryHover",children:[e.jsx(V,{className:"h-4 w-4"}),"Add Schedule"]})}),e.jsx("div",{className:"bg-surfaceCard rounded-lg border border-border shadow-sm overflow-hidden",children:m.length===0?e.jsx("div",{className:"text-center py-12 bg-surface",children:e.jsx("p",{className:"text-sm text-onSurfaceVariant",children:"No schedules created yet. Add your first schedule above."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border",children:[e.jsx("thead",{className:"bg-surface",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Order"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Competition"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Scheduled Start"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Scheduled End"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Reported Start"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-onSurfaceVariant uppercase",children:"Reported End"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-onSurfaceVariant uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-surfaceCard divide-y divide-border",children:m.map(t=>e.jsxs("tr",{className:"hover:bg-surface",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurface",children:t.Order}),e.jsx("td",{className:"px-4 py-3 text-sm text-onSurface",children:t.Competition||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.StageTitle||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.ScheduledStartTime?new Date(t.ScheduledStartTime).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.ScheduledEndTime?new Date(t.ScheduledEndTime).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.ReportedStartTime?new Date(t.ReportedStartTime).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-onSurfaceVariant",children:t.ReportedEndTime?new Date(t.ReportedEndTime).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm",children:e.jsxs("div",{className:"flex justify-end gap-x-2",children:[e.jsx("button",{onClick:()=>j(t),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-md",title:"Edit",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>y(t.CSId),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-md",title:"Delete",children:e.jsx(I,{className:"h-4 w-4"})})]})})]},t.CSId))})]})})})]})]})}export{P as default};
