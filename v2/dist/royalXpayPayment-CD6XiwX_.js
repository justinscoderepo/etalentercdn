import{r as a,j as e,f as g}from"./main-YrYtAxAS.js";import{p as B}from"./httpService-BnCZZ1ib.js";import{c as E}from"./utilities-CN4lTu6a.js";import{V as G}from"./validationMessage-C8UQV-p_.js";import{F as A}from"./CheckCircleIcon-eDHedEn2.js";import{F as U}from"./ExclamationTriangleIcon-CaIv2k3v.js";import{F as I}from"./CreditCardIcon-BBQ0gQPB.js";import{F as V}from"./ShieldCheckIcon-BfxBiyNE.js";import{F as H}from"./ArrowPathIcon-BuRNjDhE.js";import"./index-t--hEgTQ.js";function J({title:o,titleId:n,...h},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},h),o?a.createElement("title",{id:n},o):null,a.createElement("path",{d:"M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"}))}const Q=a.forwardRef(J),ne=({label:o,errors:n,register:h,formData:s,onChangeValue:x,disabled:Z,readOnly:k,optional:v,component:c})=>{const i="royalXpayPayment",[p,w]=a.useState(!1),[m,y]=a.useState(!1),[P,F]=a.useState(null),[L,M]=a.useState(null),X=c?.merchantKey||"",$=c?.merchantSecret||"",j=c?.amount||s?.amount||"0.00",f=c?.currency||"AED",C=c?.description||"Payment",S=c?.isLiveMode||!1,r={email:s?.email||s?.customerEmail||"",firstName:s?.firstName||s?.customerFirstName||"",lastName:s?.lastName||s?.customerLastName||"",mobilePhone:s?.mobilePhone||s?.customerPhone||"",phone:s?.phone||s?.customerPhone||""},l={city:s?.city||s?.billingCity||"",stateProvince:s?.state||s?.billingState||"",country:s?.country||s?.billingCountry||"UAE",postcodeZip:s?.zipCode||s?.billingZip||"",street:s?.address||s?.billingAddress||"",street2:s?.address2||s?.billingAddress2||""};let q=n?.[i],[b,u]=a.useState(q);a.useEffect(()=>{u(n?.[i])},[n?.[i]]),a.useEffect(()=>{y(s?.[i]===!0)},[s?.[i]]);const O=()=>{const t=[];return r.email||t.push("Email"),r.firstName||t.push("First Name"),r.lastName||t.push("Last Name"),r.mobilePhone||t.push("Mobile Phone"),l.city||t.push("City"),l.stateProvince||t.push("State/Province"),l.street||t.push("Address"),parseFloat(j)<=0&&t.push("Amount"),t},T=async()=>{try{w(!0),u("");const t=O();if(t.length>0)throw new Error(`Missing required fields: ${t.join(", ")}`);const z={registrationId:s?.registrationId||s?.id||null,billing:{address:{city:l.city,stateProvince:l.stateProvince,country:l.country,postcodeZip:l.postcodeZip,street:l.street,street2:l.street2}},order:{amount:parseFloat(j).toFixed(2),currency:f,description:C,id:""},customer:{email:r.email,firstName:r.firstName,lastName:r.lastName,mobilePhone:r.mobilePhone,phone:r.phone||r.mobilePhone}},d=await B("/api/royalxpay/create-order",z);if(d.success)F(d.orderId),M(d.paymentLink),g.success("Payment order created successfully!"),d.paymentLink&&window.open(d.paymentLink,"_blank","width=800,height=600,scrollbars=yes,resizable=yes");else throw new Error(d.message||"Failed to create payment order")}catch(t){console.error("RoyalXpay order creation failed:",t),u(t.message),g.error(t.message)}finally{w(!1)}},K=()=>{y(!0),x&&x(i,!0),u(""),g.success("Payment marked as completed!")},_=()=>{y(!1),F(null),M(null),x&&x(i,!1)},N=X&&$,R=N&&!Z&&!k&&!m;return e.jsxs("div",{className:"sm:col-span-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 rounded-lg",children:e.jsx("img",{src:"https://royalxpay.com/assets_frontend/images/RoyalXpay-whitewithtransparent.png",alt:"RoyalXpay",className:"h-8 object-contain filter brightness-0 invert"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[o||"RoyalXpay Payment",!v&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("div",{className:"flex items-center mt-1",children:S?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium",children:"Live Mode"})]}):e.jsxs("div",{className:"flex items-center text-orange-600",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Test Mode"})]})})]})]}),m&&e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(A,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-medium",children:"Completed"})]})]}),e.jsx("input",{type:"hidden",...h(i,{required:!v}),value:m?"true":""}),e.jsxs("div",{className:E("border rounded-lg p-6 bg-gradient-to-br from-white to-gray-50",m?"border-green-300 bg-green-50":"border-gray-300",b?"border-red-300":""),children:[!N&&e.jsx("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-5 w-5 text-amber-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-amber-800",children:"RoyalXpay not configured. Please set up merchant credentials."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2 text-gray-600"}),"Payment Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount:"}),e.jsxs("span",{className:"font-medium",children:[f," ",parseFloat(j).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Currency:"}),e.jsx("span",{className:"font-medium",children:f})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Description:"}),e.jsx("span",{className:"font-medium",children:C})]}),P&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Order ID:"}),e.jsx("span",{className:"font-mono text-xs",children:P})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.jsx(Q,{className:"h-5 w-5 mr-2 text-gray-600"}),"Customer Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium truncate ml-2",children:r.email||"Not provided"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsxs("span",{className:"font-medium",children:[r.firstName," ",r.lastName]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:r.mobilePhone||"Not provided"})]})]})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(V,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("span",{className:"font-medium text-blue-900",children:"Secure Payment Features"})]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• 3D Secure Authentication"}),e.jsx("li",{children:"• PCI DSS Compliant"}),e.jsx("li",{children:"• SSL Encrypted Transactions"}),e.jsx("li",{children:"• Supports Major Credit Cards (Visa, Mastercard, Amex)"})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:m?e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(A,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-medium",children:"Payment Completed Successfully"})]}),e.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Reset"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:T,disabled:!R||p,className:E("flex-1 inline-flex items-center justify-center gap-x-2 rounded-md px-6 py-3 text-sm font-semibold shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",R&&!p?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 focus-visible:outline-blue-600":"bg-gray-200 text-gray-700 cursor-not-allowed"),children:p?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-5 w-5 animate-spin"}),"Creating Order..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-5 w-5"}),"Pay with RoyalXpay"]})}),L&&e.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 text-sm font-medium text-green-700 bg-green-100 border border-green-300 rounded-md hover:bg-green-200",children:"Mark as Completed"})]})}),!S&&N&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-yellow-900 mb-3",children:"Testing Information"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Test Merchant Credentials"}),e.jsx("p",{className:"text-blue-800 text-xs",children:"• Merchant Key: Any 16-digit number (e.g., live-1234567890123456)"}),e.jsx("p",{className:"text-blue-800 text-xs",children:"• Merchant Secret: Any 23-digit number (e.g., sec-12345678901234567890123)"})]}),e.jsx("h6",{className:"font-medium text-yellow-900 mb-2",children:"Test Cards"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Mastercard"}),e.jsx("p",{className:"text-yellow-700",children:"5123450000000008 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"5111111111111118 (No 3D)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Visa"}),e.jsx("p",{className:"text-yellow-700",children:"4508750015741019 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"4012000033330026 (No 3D)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"American Express"}),e.jsx("p",{className:"text-yellow-700",children:"345678901234564 (3D Secure)"}),e.jsx("p",{className:"text-yellow-700",children:"371449635398431 (No 3D)"})]})]})]})]}),b&&e.jsx(G,{message:b})]})};export{ne as default};
