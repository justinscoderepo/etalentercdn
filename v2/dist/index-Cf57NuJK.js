import{r as g,j as e,u as I,z as f}from"./main-CYp90Aiy.js";import{L}from"./layoutOuter-wA0Zxgvy.js";import{P as T}from"./pageHeader-D82hvFiu.js";import{O as $}from"./OldNewTabLayout-CXjMUDX6.js";import M from"./formEditor-CesQh8WQ.js";import{F}from"./TrophyIcon-dyQA9L7_.js";import{F as R}from"./Bars3Icon-BDjaH-xG.js";import{F as A}from"./PencilIcon-BPsvquhu.js";import{F as V}from"./TrashIcon-CZtC0Jre.js";import{F as z}from"./PlusIcon-BO2OzsFJ.js";import"./navigationUtils-BGUfoenU.js";import"./index.esm-D98hGjC9.js";import"./renderComponents-BvhkB-wm.js";import"./validationMessage-CeHOytfP.js";import"./CheckCircleIcon-BhKjgcAc.js";import"./modalForm-ny2WGE4k.js";import"./dialog-CaLl-wC5.js";import"./keyboard-_fXsLqhQ.js";import"./description-DdmBhPpR.js";import"./use-is-mounted-D1Iwo7_h.js";import"./XMarkIcon-BeYl--qL.js";import"./XCircleIcon-DO18aUnj.js";import"./CheckCircleIcon-Cmy_0k1V.js";function U({title:r,titleId:o,...c},n){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":o},c),r?g.createElement("title",{id:o},r):null,g.createElement("path",{d:"M5.566 4.657A4.505 4.505 0 0 1 6.75 4.5h10.5c.41 0 .806.055 1.183.157A3 3 0 0 0 15.75 3h-7.5a3 3 0 0 0-2.684 1.657ZM2.25 12a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3v-6ZM5.25 7.5c-.41 0-.806.055-1.184.157A3 3 0 0 1 6.75 6h10.5a3 3 0 0 1 2.683 1.657A4.505 4.505 0 0 0 18.75 7.5H5.25Z"}))}const G=g.forwardRef(U);function J({editingItem:r,categories:o,scoringMethods:c,onSubmit:n,onCancel:l,open:u}){const i=g.useMemo(()=>r?{CompetitionId:r.CompetitionId,Title:r.Title||"",Category:r.Category||"",ScoreLabel:r.ScoreLabel||"",Order:r.Order||0,Status:r.Status||2}:{Status:2,Order:0},[r]),a=[{name:"Title",label:"Competition Title",type:"text",placeholder:"e.g., Song, Dance, Speech, Storytelling",validate:{required:!0,minLength:2,maxLength:100}},{name:"Category",label:"Competition Type",type:"select",placeholder:"Select competition category",options:o.map(t=>({text:t.CategoryName,value:t.ProgramCategoryId})),validate:{required:!0}},{name:"ScoreLabel",label:"Scoring Method",type:"select",placeholder:"Select scoring method",options:c.map(t=>({text:t.Label,value:t.LabelId})),validate:{required:!0}},{name:"Order",label:"Display Order",type:"number",placeholder:"Enter display order (0-999)",validate:{required:!0,min:0,max:999}}];return e.jsx(M,{title:r?"Edit Competition Item":"Add New Competition Item",description:r?"Update competition item details including title, type, and scoring method":"Create a new competition item by specifying title, category, and scoring method",row:i,fields:a,onSave:n,onCancel:l})}const q=r=>({1:{borderColor:"border-l-blue-500",bgColor:"bg-blue-50/30",badgeBg:"bg-blue-50",badgeBorder:"border-blue-200",badgeText:"text-blue-700",iconColor:"text-blue-600",icon:"ðŸ“"},2:{borderColor:"border-l-green-500",bgColor:"bg-green-50/30",badgeBg:"bg-green-50",badgeBorder:"border-green-200",badgeText:"text-green-700",iconColor:"text-green-600",icon:"ðŸ”¢"},3:{borderColor:"border-l-amber-500",bgColor:"bg-amber-50/30",badgeBg:"bg-amber-50",badgeBorder:"border-amber-200",badgeText:"text-amber-700",iconColor:"text-amber-600",icon:"â­"},4:{borderColor:"border-l-purple-500",bgColor:"bg-purple-50/30",badgeBg:"bg-purple-50",badgeBorder:"border-purple-200",badgeText:"text-purple-700",iconColor:"text-purple-600",icon:"ðŸ“Š"}})[r]||{borderColor:"border-l-border",bgColor:"bg-surface",badgeBg:"bg-surface",badgeBorder:"border-border",badgeText:"text-onSurfaceVariant",iconColor:"text-onSurfaceVariant",icon:"â“"},H=({item:r,onEdit:o,onDelete:c,onDragStart:n,onDragEnd:l,onDragOver:u,onDrop:i,isDragging:a})=>{const t=q(r.ScoreLabel);return e.jsx("div",{draggable:!0,onDragStart:s=>n(s,r),onDragEnd:l,onDragOver:u,onDrop:s=>i(s,r),className:`group relative bg-surfaceCard border border-border ${t.borderColor} border-l-4 rounded-lg hover:shadow-md hover:border-primary transition-all duration-200 mb-2 ${a?"opacity-50":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 p-3",children:[e.jsx("div",{className:"flex-shrink-0 cursor-grab active:cursor-grabbing text-onSurfaceVariant hover:text-onSurface",children:e.jsx(R,{className:"h-5 w-5"})}),e.jsx("div",{className:`flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full ${t.badgeBg} border-2 ${t.badgeBorder} shadow-sm`,children:e.jsx("span",{className:`text-sm font-bold ${t.badgeText}`,children:r.Order||0})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx(F,{className:"h-5 w-5 text-cyan-600 flex-shrink-0"}),e.jsx("h3",{className:"text-sm font-semibold text-onSurface group-hover:text-primary transition-colors duration-200 truncate",children:r.Title})]}),e.jsxs("div",{className:`flex items-center gap-2 ${t.badgeBg} border ${t.badgeBorder} rounded-lg px-3 py-1.5 flex-shrink-0`,children:[e.jsx("span",{className:"text-xl",children:t.icon}),e.jsx("span",{className:`text-xs font-semibold ${t.badgeText} whitespace-nowrap`,children:r.ScoreLabelLabel||"N/A"})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>o(r),title:"Edit",className:"inline-flex items-center justify-center rounded-full p-2 text-white bg-emerald-500 hover:bg-emerald-600 shadow-sm hover:shadow transition-all duration-200",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c(r.CompetitionId),title:"Delete",className:"inline-flex items-center justify-center rounded-full p-2 text-white bg-red-500 hover:bg-red-600 shadow-sm hover:shadow transition-all duration-200",children:e.jsx(V,{className:"h-4 w-4"})})]})]})})};function P({categoryName:r,items:o,onEdit:c,onDelete:n,onReorder:l,colorIndex:u}){const i=[{iconColor:"text-cyan-600",badgeBg:"bg-cyan-500"},{iconColor:"text-emerald-600",badgeBg:"bg-emerald-500"},{iconColor:"text-indigo-600",badgeBg:"bg-indigo-500"},{iconColor:"text-purple-600",badgeBg:"bg-purple-500"},{iconColor:"text-pink-600",badgeBg:"bg-pink-500"},{iconColor:"text-orange-600",badgeBg:"bg-orange-500"}],a=i[u%i.length],t=g.useMemo(()=>o||[],[o]),[s,d]=g.useState(null),v=(m,h)=>{d(h),m.dataTransfer.effectAllowed="move"},j=()=>{d(null)},S=m=>{m.preventDefault(),m.dataTransfer.dropEffect="move"},N=(m,h)=>{if(m.preventDefault(),!s||s.CompetitionId===h.CompetitionId){d(null);return}l(s,h),d(null)};return e.jsxs("div",{className:"mb-6 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(G,{className:`h-5 w-5 ${a.iconColor}`}),e.jsx("h2",{className:"text-base font-semibold text-onSurface",children:r||"Uncategorized"}),e.jsx("div",{className:`${a.badgeBg} rounded-full px-2.5 py-0.5`,children:e.jsx("span",{className:"text-xs font-bold text-white",children:o.length})})]}),t.length===0?e.jsx("div",{className:"bg-surfaceCard rounded-lg p-6 text-center border-2 border-dashed border-border",children:e.jsx("p",{className:"text-sm text-onSurfaceVariant",children:"No items in this category"})}):e.jsx("div",{className:"space-y-0",children:t.map(m=>e.jsx(H,{item:m,onEdit:c,onDelete:n,onDragStart:v,onDragEnd:j,onDragOver:S,onDrop:N,isDragging:s?.CompetitionId===m.CompetitionId},`item-${m.CompetitionId}`))})]})}function Z({items:r,onEdit:o,onDelete:c,onReorder:n}){const{groupedItems:l,categories:u}=g.useMemo(()=>{if(!r||r.length===0)return{groupedItems:{},categories:[]};const i=[...r].sort((s,d)=>(s.Order||0)-(d.Order||0)),a={},t=[];return i.forEach(s=>{const d=s.CategoryCategoryName||"Uncategorized";a[d]||(a[d]=[],t.push(d)),a[d].push(s)}),{groupedItems:a,categories:t}},[r]);return!r||r.length===0?e.jsxs("div",{className:"text-center py-16 bg-gradient-to-br from-surface to-surfaceCard rounded-2xl border-2 border-dashed border-border",children:[e.jsx("div",{className:"bg-contentBgOuter rounded-full p-4 w-20 h-20 mx-auto mb-4 shadow-lg",children:e.jsx(F,{className:"h-12 w-12 text-onSurfaceVariant"})}),e.jsx("p",{className:"text-onSurface mb-2 font-semibold text-lg",children:"No competition items found"}),e.jsx("p",{className:"text-sm text-onSurfaceVariant",children:'Click "Add New Competition" button to create your first item'})]}):e.jsx("div",{className:"space-y-6 flex flex-row flex-wrap gap-6",children:u.map((i,a)=>e.jsx(P,{categoryName:i,items:l[i],onEdit:o,onDelete:c,onReorder:n,colorIndex:a},i))})}function he(){const[r,o]=g.useState(!1),[c,n]=g.useState(null),{rows:l,update:u,delete:i,setFilter:a,filters:t}=I("/CompetitionItemsJson/Get",{noGet:!1,deleteUrl:"/CompetitionItemsJson/Remove",updateUrl:"/CompetitionItemsJson/Save"}),{rows:s}=I("/CompetitionCategoriesJson/Get",{select:"Categories"}),{rows:d}=I("/ScoreLabelJson/Get",{select:"ScoreLabels"}),v=()=>{n(null),o(!0)},j=b=>{n(b),o(!0)},S=async b=>{try{await u(b)&&(f.success(c?"Competition updated successfully":"Competition added successfully"),o(!1),n(null),a({}))}catch(x){console.error("Error saving competition:",x),f.error("Failed to save competition")}},N=()=>{o(!1),n(null)},m=async b=>{if(window.confirm("Are you sure you want to delete this competition item?"))try{await i({CompetitionId:b})&&f.success("Competition deleted successfully")}catch(x){console.error("Error deleting competition:",x),f.error("Failed to delete competition")}},h=async(b,x)=>{if(l)try{const C=[...l].sort((p,y)=>(p.Order||0)-(y.Order||0)),B=C.findIndex(p=>p.CompetitionId===b.CompetitionId),O=C.findIndex(p=>p.CompetitionId===x.CompetitionId);if(B===-1||O===-1)return;const w=[...C],[E]=w.splice(B,1);w.splice(O,0,E);for(let p=0;p<w.length;p++){const y=w[p],D=p+1;y.Order!==D&&u({...y,Order:D})}a(t),f.success("Competition items reordered successfully")}catch(C){console.error("Error reordering competitions:",C),f.error("Failed to reorder competitions")}},k=g.useMemo(()=>l?[...l].sort((b,x)=>(b.Order||0)-(x.Order||0)):[],[l]);return e.jsx($,{title:"Competition Items",showTableView:!1,oldRoute:"/SetUp/CompetitionItems",children:e.jsx(L,{children:e.jsxs("div",{className:"flex flex-col grow",children:[e.jsx(T,{heading:"Competition Items",subHeading:"Manage and organize your competitions",rightChildren:e.jsxs("button",{onClick:v,className:"inline-flex items-center gap-x-2 rounded-lg bg-gradient-to-r from-primary to-darkprimary px-5 py-2.5 text-sm font-semibold text-white shadow-md hover:shadow-lg hover:scale-105 transition-all duration-200",children:[e.jsx(z,{className:"h-5 w-5"}),"Add New Competition"]})}),e.jsx("div",{className:"bg-surface border border-primary/20 rounded-xl p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-lg p-2 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-onSurface mb-1",children:"Quick Guide"}),e.jsx("p",{className:"text-sm text-onSurfaceVariant leading-relaxed",children:"Configure competition items by specifying titles, categories, scoring methods, and display order. Drag and drop items to reorder them - all order numbers will be automatically updated. Each competition can be edited or deleted as needed."})]})]})}),e.jsx(Z,{items:k,onEdit:j,onDelete:m,onReorder:h}),r&&e.jsx(J,{editingItem:c,categories:s||[],scoringMethods:d||[],onSubmit:S,onCancel:N,open:r})]})})})}export{he as default};
