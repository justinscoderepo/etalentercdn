import{r as s,j as i,L as Q,d as a}from"./main-BTxYPv0w.js";import{a as W}from"./index-t--hEgTQ.js";import{T as I}from"./manageEvent-D0TeK5RG.js";import{p as V,a as X}from"./httpService-COMwHiVS.js";import{c as Y}from"./utilities-CN4lTu6a.js";import"./box-WSpyXs8E.js";import"./formEditor-cfHpgvuT.js";import"./index.esm-BB5W7hpN.js";import"./renderComponents-BtQm92t5.js";import"./validationMessage-DIzKhWuT.js";import"./CheckCircleIcon-CvjzM6gM.js";import"./modalForm-C0iiDvso.js";import"./dialog-BqguU9KB.js";import"./keyboard-wSkleyN5.js";import"./XMarkIcon-Df2NgE_t.js";import"./XCircleIcon-DKChtyG8.js";import"./CheckCircleIcon-W-2YmjvZ.js";import"./useBackend-CblGpngf.js";import"./EyeIcon-KWzMDAlA.js";import"./ChatBubbleBottomCenterTextIcon-D21sjO3b.js";import"./ExclamationTriangleIcon-B_466Brh.js";const Re=({fieldName:w,label:R,placeholder:k,errors:P,register:T,formData:O,optional:D,maxLength:j,onChange:p,type:C,pattern:L,minLength:F,autocomplete:N,step:Z,disabled:ee,max:te,labelFont:ae,noLabel:se})=>{const[E,r]=s.useState(!1),[o,A]=s.useState(""),[u,B]=s.useState(!1),[d,v]=s.useState(!1),[re,x]=s.useState(!1),[g,n]=s.useState(!1),[le,G]=s.useState(!1),[ie,J]=s.useState(""),[m,c]=s.useState(!1),[b,f]=s.useState(!1),[oe,y]=s.useState(""),U="/PublicJson/GetUserCheck",$="/PublicJson/UsersActivation",q=X+"/PublicJson/GetOTPCheck",S=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),h=e=>e.length===6&&/^\d{6}$/.test(e);s.useEffect(()=>{const e=setTimeout(()=>{J(o)},500);return()=>{clearTimeout(e)}},[o]);let _=()=>{const e={Email:o};return r(!0),V(U,e).then(t=>(r(!1),t.data===!0?(c(!0),a.error("This email ID is already registered. Please enter a different email ID."),!1):(c(!1),!0))).catch(t=>{r(!1),console.error("Error checking user:",t),c(!1),a.error("Error checking user, please try again.")})};const z=e=>{const t=e.target.value;t!==o&&(n(!1),c(!1),A(t),x(!1),B(S(t)),v(!1),f(!1)),console.log("newEmail",t),p("email",e.target.value)},H=async()=>{let e=await _();if(e)if(S(o)&&e){n(!0),a.success("OTP button will activate in 30 seconds."),setTimeout(()=>{n(!1)},3e4);const t={Email:o};r(!0),V($,t).then(l=>{l.data.Results!=="Send mail success"?(c(!0),a.error(l.data.Results),n(!1)):(a.success("OTP sent successfully. Please check your email inbox. If you don't see the email, please check your spam folder."),console.log("OTP sent successfully:",l.data),v(!0),x(!0)),r(!1)}).catch(l=>{r(!1),console.error("Error sending OTP:",l),a.error("Failed to send OTP, please try again."),n(!1)})}else a.error("Please enter a valid email address.")},K=e=>{e&&(h(e)?(r(!0),W.post(q,{Email:o,OTP:e},{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{r(!1),t.data===!0?(f(!0),p("otp",e),a.success("OTP is valid.")):(p("otp",""),a.error("OTP is not valid."),y(""),f(!1))}).catch(t=>{r(!1),console.error("Error validating OTP:",t),a.error("Invalid OTP. Please try again."),f(!1)})):a.error("Please enter a valid 6-digit OTP."))},M=e=>{if(!h(e.target.value))return;const l=e.target.value;y(l),G(h(l)),K(l)};return console.log("isEmailValid",u),console.log("isEmailRegistered",m),console.log("isOTPSent",d),console.log("isButtonDisabled",g),i.jsxs(i.Fragment,{children:[E&&i.jsx(Q,{isLoading:E}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx(I,{fieldName:w,label:R,placeholder:k,errors:P,register:T,formData:O,optional:D,maxLength:j,onChange:z,type:C,validate:e=>d?m?(a.error("This email ID is already registered. Please enter a different email ID or login with this email ID."),!1):u?!0:(a.error("Please enter a valid email address."),!1):(a.error("Please click on Get OTP via Email button to get OTP."),!1),pattern:L,minLength:F,autocomplete:N,readOnly:!1}),!b&&i.jsx("button",{disabled:!u||m||g,onClick:H,type:"button",className:Y(u&&!m&&!g?"w-full my-2 py-2 px-4 bg-green-600 text-white rounded-md shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500":"w-full my-2 py-2 px-4 bg-gray-400 text-white rounded-md shadow-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500"),children:d?"Resend OTP via Email":"Get OTP via Email"}),d&&i.jsx("div",{className:"pt-4",children:i.jsx(I,{fieldName:"otp",label:"Enter the OTP",placeholder:"Enter OTP sent to your email",errors:P,register:T,formData:O,optional:!1,maxLength:6,validate:()=>b?!0:(a.error("Please enter a valid OTP."),!1),minLength:6,onChange:M,type:"text",pattern:/^\d{6}$/,autocomplete:"off"})})]})]})};export{Re as default};
